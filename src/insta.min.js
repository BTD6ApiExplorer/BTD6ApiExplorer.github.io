let e="",t={},n={},a={},s={},i=null,o=null,l=null,d=1,r=null,c={},m=!1,p={},u=null,h=null,y=null,k={},g=null,b=null,L=1,w=null,v="newest",T=!1,f=!1,C={},E=!1,I=!0;async function M(e,t){let n=null;try{T?(n=await fetch(e,{cache:"reload"}),T=!1,E=!1):(n=await fetch(e),E=!1)}catch(e){return navigator.onLine?(E=!0,Tt("You have hit the rate limit.<br>If you are browsing the leaderboards or content browsers, please slow down!<br><br>The rate limit will clear after a short time. You can also help prevent rate limiting by toggling the setting below which stops player profiles from loading automatically.","ratelimit"),Re(),fe=!1,`You have hit the rate limit. [${e}]`):(Tt("You are currently offline. Please check your internet connection.","api"),`You are currently offline. [${e}]`)}try{let e=await n.json();return 1==e.success?t(e):"Rate limit"==e.reason?(f=!0,Tt("You have hit the rate limit. Please try again later.","api")):(document.getElementById("loading").style.transform="scale(0)",fe=!1,Tt(e.error,"api")),e}catch(e){return Tt(`Something went wrong with the request. Response Code: ${n.status} [${e}]`,"api"),`Something went wrong with the request. Response Code: ${n.status} [${e}]`}}async function S(e){T=!0;let a=!0;if(await M(`https://data.ninjakiwi.com/btd6/save/${e}`,(s=>{t=s.body,n=s.model,Te[0]=1,a=!1,A(e)})),a&&!E){let t=document.getElementsByClassName("error-modal-overlay");for(element of t)element.parentNode.removeChild(element);delete c[e],F(),Ve(),Tt("Your Open Access Key has expired. Please make a new one and try again.","expire",!0)}}async function A(e){T=!0,M(`https://data.ninjakiwi.com/btd6/users/${e}`,(t=>{a=t.body,s=t.model,c[e]={displayName:a.displayName,avatar:be(a),banner:Le(a)},F(),Te[1]=1,$e()}))}async function B(){null==i?M("https://data.ninjakiwi.com/btd6/races",(e=>{i=e.body,generateRaces()})):generateRaces()}async function H(e){return i&&i[e]&&"string"==typeof i[e].metadata?M(i[e].metadata,(t=>(i[e].metadata=t.body,i[e]))):i[e]}async function O(){return l?(o=null,M(`${l}?page=${d}`,(e=>(o=e.body,r=o.length,document.getElementById("leaderboard-footer-page-number").innerHTML=`Page ${d} (#${d*r-(r-1)} - ${d*r})`,o)))):Tt("Leaderboard Fetch Error: No leaderboard data found")}async function x(){null==u?M("https://data.ninjakiwi.com/btd6/bosses",(e=>{u=e.body,generateBosses(showElite)})):generateBosses(showElite)}async function P(e,t){return u&&u[e]&&"string"==typeof u[e][t?"metadataElite":"metadataStandard"]?M(u[e][t?"metadataElite":"metadataStandard"],(n=>(u[e][t?"metadataElite":"metadataStandard"]=n.body,u[e]))):u[e]}async function $(){null==h?M("https://data.ninjakiwi.com/btd6/ct",(e=>{h=e.body,generateCTs()})):generateCTs()}async function D(e){let t=null;return await M(e,(e=>(t=e.body,t))),t}async function N(){if(null!=y)return y;await M("https://data.ninjakiwi.com/btd6/challenges/filter/daily",(e=>(y=e.body,y)))}async function j(e){return null==k[e]&&await M(`https://data.ninjakiwi.com/btd6/challenges/challenge/${e}`,(t=>(k[e]=t.body,k[e]))),k[e]}async function U(){return b?(g=null,M(`${b}${v}?page=${L}`,(e=>(g=e.body,w=g.length,document.getElementById("browser-footer-page-number").innerHTML=`Page ${L} of 4`,o)))):Tt("Content Browser Fetch Error: No data found")}async function G(e){let t=e.split("/").pop();return null==p[t]&&await M(e,(e=>{p[t]=e.body})),p[t]}async function R(e){return null==C[e]&&await M(`https://data.ninjakiwi.com/btd6/maps/map/${e}`,(t=>(C[e]=t.body,C[e]))),C[e]}function K(){null!=localStorage.getItem("BTD6OAKStorage")&&(c=JSON.parse(localStorage.getItem("BTD6OAKStorage")))}function F(){localStorage.setItem("BTD6OAKStorage",JSON.stringify(c))}function W(e){e.substring(0,3),parseInt(e.substring(3,7));let t=e.substring(7);return[parseInt(t.substring(0,4)),parseInt(t.substring(4,6)),parseInt(t.substring(6,8))]}function q(e,t){let n=new Date(2024,4,25),a=(t?2101:2114)-parseInt(e);return n.setDate(n.getDate()-a),(t?"adv":"rot")+e+n.toISOString().substring(0,10).replace(/-/g,"")}function z(e,t){let n=new Date(e),a=new Date(2024,4,25).getTime()-n.getTime();return(t?"adv":"rot")+((t?2101:2114)-Math.floor(a/864e5))+e.replace(/-/g,"")}const Y={Clicker:"Bloons Master","Superior Clicker":"Superior Bloons Master","Ultimate Clicker":"Ultimate Bloons Master","Knowledgable Primate":"Knowledgeable Primate","Triple Threat":"Triple threat","Small Bloons":"Alchermistman and Bloonacleboy","Master of Life":"Master of life","What did it cost":"What did it cost? - Everything","2 Mega Pops":"2 MegaPops","Looking fab":"Lookin fab",GoldenTicket:"Golden Ticket","Axis of Havok":"Axis of Havoc","Co-op Popper!":"Co-op Popper",CouponCrazy:"Coupon Crazy",LimitedRun:"Limited Run",ALaCode:"A La Code",InstantGratification:"Instant Gratification","Achievement Of Achievements":"Achievement of Achievements","What is this new Bloonery":"What is this new Bloonery?","Who's the Boss":"Who's the Boss?","I'llBeBack":"I'll Be Back",SoSpiiiceyNinjaKiwi:"So Spiiicey Ninja Kiwi",DavidsVsGoliath:"Davids vs Goliath",ToolsToDarwin:"Tools to Darwin",BigSpender:"Big Spender",NotLackingCriticalInformation:"Not Lacking Critical Information",StubbornStrategy:"Stubborn Strategy","Hook Line And Sinker":"Hook, Line, and Sinker",CrashOfTheTitans:"Crash of the Titans","So Shiny":"So Shiny!","Ultimate Team Up":"Ultimate Team-up",StudentLoans:"Student Loans",StickySituation:"Sticky Situation",NoHarvest:"No Harvest",ReadyPlayerOne:"Ready Player One?",TheDailyReid:"The Daily Reid",InstaCentury:"Insta Century"},J=Object.entries(Y).reduce(((e,[t,n])=>(e[n]=t,e)),{}),V={ObynOceanGuardian:"OceanObyn",MoltenObyn:"MountainObyn",JoanOfArcAdora:"JoanOfArc",CyberQuincy:"QuincyCyber",ETnEtienne:"ETn",SentaiCaptainChurchill:"SentaiChurchill",SleighCaptainChurchill:"SleighChurchill"},Q={Spikeopult:"Spike-o-pult",BuccaneerLongRange:"LongRange",BuccaneerGrapeShot:"GrapeShot",BuccaneerCrowsNest:"CrowsNest",BuccaneerHotShot:"HotShot",BuccaneerCarrierFlagship:"CarrierFlagship",BuccaneerCannonShip:"CannonShip",BuccaneerMerchantman:"Merchantman",BuccaneerFavoredTrades:"FavoredTrades",BuccaneerAircraftCarrier:"AircraftCarrier",BuccaneerDestroyer:"Destroyer",BuccaneerTradeEmpire:"TradeEmpire",BuccaneerPirateLord:"PirateLord",BuccaneerMonkeyPirates:"MonkeyPirates",HeattippedDarts:"HeatTippedDart",BioncBoomerang:"BionicBoomerang",LargeCalibre:"LongCalibre",LaserBlasts:"LaserBlast",GuidedMagic:"GuildedMagic",MortarRapidReload:"RapidReload",SupplyDrop:"CashDrop",PlasmaBlasts:"PlasmaBlast",XXXLTrap:"XXXL",OversizeNails:"OversizedNails",CenteredPath:"FlightOrders",Shockwave:"ShellShock",Monkeyopolis:"Metropolis",Spectre:"Specter",TrueSunGod:"TrueSonGod",HydraRocketPods:"HydraRockets",DartMonkeyParagon:"ApexPlasmaMaster",BoomerangMonkeyParagon:"GlaiveDominus",NinjaMonkeyParagon:"AscendedShadow",EngineerMonkeyParagon:"MasterBuilder",WizardMonkeyParagon:"MagusPerfectus",MonkeyAceParagon:"GoliathDoomship",MonkeyBuccaneerParagon:"NavarchOfTheSeas",MonkeySubParagon:"NauticSiegeCore",SmartSpikes:"DirectedSpikes"};let X={"Directed Spikes":"Smart Spikes","Directed Spikes Description":"Smart Spikes Description",CircusGwendolinSkinName:"HarlegwenGwendolinSkinName",CircusGwendolinSkinDescription:"HarlegwenGwendolinSkinDescription",OctoJonesSkinName:"OctoJonesStrikerJonesSkinName",OctoJonesSkinDescription:"OctoJonesStrikerJonesSkinDescription",MoltenObynSkinName:"ObynMountainGuardianSkinName",MoltenObynSkinDescription:"ObynMountainGuardianSkinDescription",SushiBentoSkinName:"SushiBentoBenjaminSkinName",SushiBentoSkinDescription:"SushiBentoBenjaminSkinDescription",KaijuPatSkinName:"KaijuPatFustySkinName",KaijuPatSkinDescription:"KaijuPatFustySkinDescription",GalaxiliSkinName:"GalaxiliEziliSkinName",GalaxiliSkinDescription:"GalaxiliEziliSkinDescription",VoidoraSkinName:"VoidoraAdoraSkinName",VoidoraSkinDescription:"VoidoraAdoraSkinDescription",VikingSaudaSkinName:"VikingSaudaSaudaSkinName",VikingSaudaSkinDescription:"VikingSaudaSaudaSkinDescription",JiangshiSaudaSkinName:"JiangshiSaudaSaudaSkinName",JiangshiSaudaSkinDescription:"JiangshiSaudaSaudaSkinDescription",DreadPirateBrickellSkinName:"DreadPirateBrickellAdmiralBrickellSkinName",DreadPirateBrickellSkinDescription:"DreadPirateBrickellAdmiralBrickellSkinDescription",LifeguardBrickellSkinName:"LifeguardBrickellAdmiralBrickellSkinName",LifeguardBrickellSkinDescription:"LifeguardBrickellAdmiralBrickellSkinDescription",PsimbalsSkinName:"PsimbalsPsiSkinName",PsimbalsSkinDescription:"PsimbalsPsiSkinDescription",GeraldoGentlemanGadgeteerSkinName:"GentlemonkeyGadgeteerGeraldoSkinName",GeraldoGentlemanGadgeteerSkinDescription:"GentlemonkeyGadgeteerGeraldoSkinDescription","Mode Easy":"Easy","Mode Medium":"Medium","Mode Hard":"Hard","Mode Impoppable":"Impoppable","Mode Sandbox":"Sandbox"},Z={Easy:"Bronze",PrimaryOnly:"Bronze01",Deflation:"Bronze02",Medium:"Silver",MilitaryOnly:"Silver01",Apopalypse:"Silver03",Reverse:"Silver02",Hard:"Gold",MagicOnly:"Gold01",DoubleMoabHealth:"Gold03",HalfCash:"Gold04",AlternateBloonsRounds:"Gold02",Impoppable:"Impoppable",Clicks:"ImpoppableRuby","CHIMPS-BLACK":"ImpoppableHematite"},_={"Scientist Gwendolin":"ScientistGwendolin","Biker Bones":"BikerBones","Sentai Captain Churchill":"SentaiCaptainChurchill","Cyber Quincy":"Cyber Quincy","Octo Jones":"OctoJones","Sleigh Captain Churchill":"SleighCaptainChurchill","Wolfpack Quincy":"WolfpackQuincy",ScientistGwendolin:"Scientist Gwendolin",BikerBones:"Biker Bones",SentaiCaptainChurchill:"Sentai Captain Churchill",CyberQuincy:"Cyber Quincy",OctoJones:"Octo Jones",SleighCaptainChurchill:"Sleigh Captain Churchill",WolfpackQuincy:"Wolfpack Quincy"},ee=["ZMYVERW","ZMYUWTV","ZMYUDTK","ZMYVPGA","ZMYVPFH","ZMYWHPC"];function te(e,t){return"WizardMonkey"==e?`Assets/TowerIcon/${t}-Wizard.webp`:`Assets/TowerIcon/${t}-${e}.webp`}function ne(e,t){return"WizardMonkey"==e?`Assets/UI/InstaContainer/${t}-Wizard.webp`:`Assets/UI/InstaContainer/${t}-${e}.webp`}function ae(e,t){let n=Math.max(t[0],t[1],t[2]);switch(Math.max(t[0],t[1],t[2])){case parseInt(t[0]):n=`${n}00`;break;case parseInt(t[1]):n=`0${n}0`;break;case parseInt(t[2]):n=`00${n}`}return"WizardMonkey"==e?`Assets/InstaMonkeyIcon/${n}-WizardInsta.webp`:`Assets/InstaMonkeyIcon/${n}-${e}Insta.webp`}function se(e){return e=e.replace(/[^a-zA-Z0-9]/g,""),Q[e]?`Assets/UpgradeIcon/${Q[e]}UpgradeIcon.webp`:`Assets/UpgradeIcon/${e}UpgradeIcon.webp`}function ie(e){return"SubAdmiral"==e?"Assets/KnowledgeIcon/NavalUpgradesIcon.webp":`Assets/KnowledgeIcon/${e}Icon.webp`}function oe(e,t){return 1==t?`Assets/Portrait/${e}Portrait.webp`:`Assets/Portrait/${e}PortraitLvl${t}.webp`}function le(e){return`Assets/HeroIconSquare/HeroIcon${e=V[e]||e}.webp`}function de(e){return`Assets/HeroIconCircle/HeroIcon${e=V[e]||e}.webp`}function re(e,t){return e=V[e]||e,1==t?`Assets/Portrait/${e}Portrait.webp`:`Assets/Portrait/${e}PortraitLvl${t}.webp`}function ce(e){return"#ouch"==e?"Assets/MapIcon/MapSelectouchButton.webp":`Assets/MapIcon/MapSelect${e}Button.webp`}function me(e){return`Assets/PowerIcon/${e}Icon.webp`}function pe(e,t){return t?"Assets/AchievementIcon/HiddenIcon.webp":`Assets/AchievementIcon/${e}Icon.webp`}function ue(e){return Y[e]||e}function he(e){return`Assets/MedalIcon/${e}.webp`}function ye(e){return`Assets/ModeIcon/${e}Btn.webp`}function ke(e){switch(e.type){case"MonkeyMoney":return"Assets/UI/BloonjaminsIcon.webp";case"Power":return me(e.power);case"InstaMonkey":return ae(e.tower,e.tiers);case"KnowledgePoints":return"Assets/UI/KnowledgeIcon.webp";case"RandomInstaMonkey":return`Assets/UI/InstaRandomTier${0==e.tier?1:e.tier}.webp`;case"Trophy":return"Assets/UI/TrophyIcon.webp";default:return`Assets/UI/${e.value}Icon.webp`}}function ge(e){return`Assets/ProfileAvatar/${e}.webp`}function be(e){if(0==e.avatar)return"Assets/ProfileAvatar/ProfileAvatar01.webp";let t=parseInt(e.avatar.replace(/\D/g,""));return""==e.avatar||isNaN(t)?"Assets/ProfileAvatar/ProfileAvatar01.webp":t<=Ee.profileAvatars?`Assets/ProfileAvatar/${e.avatar}.webp`:e.avatarURL}function Le(e){if(0==e.banner)return"Assets/ProfileBanner/TeamsBannerDeafult.webp";let t=parseInt(e.banner.replace(/\D/g,""));return""==e.banner||isNaN(t)?"Assets/ProfileBanner/TeamsBannerDeafult.webp":t<=Ee.profileBanners?`Assets/ProfileBanner/${e.banner}.webp`:e.bannerURL}function we(e){return ee.includes(e)?`Assets/CustomMapIcon/${e}.webp`:`https://data.ninjakiwi.com/btd6/maps/map/${e}/preview`}function ve(e){return X[e]?Ce[X[e]]:Ce[e]}let Te=[0,0,0,0,0],fe=!1,Ce={},Ee={},Ie="game",Me=!1,Se={TowerTotal:{},TowerTierTotals:{},TowerMissingByTier:{},TowerBorders:{},TowerObtained:{}},Ae="None",Be="All",He=!0,Oe="Highest Total Chance",xe={wood:"Wooden",bronze:"Bronze",silver:"Silver",gold:"Gold",diamond:"Diamond"},Pe=!1;function $e(){Promise.all([fetch("./data/English.json").then((e=>e.json()))]).then((([e])=>{Ce=e,Te[2]=1,Te[3]=1,De()})).catch((e=>{console.error("Error:",e),Tt(e,"js")})),Ge()}function De(){Te.every((e=>1===e))&&(document.getElementById("front-page").style.display="none",document.body.classList.add("transition-bg"),je(),Qe())}function Ne(){$e(!0)}function je(){let e={},n={},a={},s={},i={};for(let[o,l]of Object.entries(t.instaTowers)){i[o]=[],e[o]=0;let t={1:0,2:0,3:0,4:0,5:0};n[o]=n[o]||t;let d={1:[],2:[],3:[],4:[],5:[]};a[o]=a[o]||d;for(let[t,a]of Object.entries(l))e[o]+=a,Ee.instaTiers[5].includes(t)&&(n[o][5]+=1),Ee.instaTiers[4].includes(t)&&(n[o][4]+=1),Ee.instaTiers[3].includes(t)&&(n[o][3]+=1),Ee.instaTiers[2].includes(t)&&(n[o][2]+=1),Ee.instaTiers[1].includes(t)&&(n[o][1]+=1);if(Ee.collectionOrder.forEach((e=>{null==l[e]&&(Ee.instaTiers[5].includes(e)&&a[o][5].push(e),Ee.instaTiers[4].includes(e)&&a[o][4].push(e),Ee.instaTiers[3].includes(e)&&a[o][3].push(e),Ee.instaTiers[2].includes(e)&&a[o][2].push(e),Ee.instaTiers[1].includes(e)&&a[o][1].push(e))})),n[o][4]==Ee.instaTiers[4].length&&n[o][3]==Ee.instaTiers[3].length&&n[o][2]==Ee.instaTiers[2].length&&n[o][1]==Ee.instaTiers[1].length){if(n[o][5]==Ee.instaTiers[5].length){s[o]="Black";continue}s[o]="Gold"}else s[o]=""}Se.TowerTotal=e,Se.TowerTierTotals=n,Se.TowerMissingByTier=a,Se.TowerBorders=s,Se.TowerObtained=i}function Ue(e){Se.TowerTierTotals[e][4]==Ee.instaTiers[4].length&&Se.TowerTierTotals[e][3]==Ee.instaTiers[3].length&&Se.TowerTierTotals[e][2]==Ee.instaTiers[2].length&&Se.TowerTierTotals[e][1]==Ee.instaTiers[1].length?Se.TowerTierTotals[e][5]==Ee.instaTiers[5].length?Se.TowerBorders[e]="Black":Se.TowerBorders[e]="Gold":Se.TowerBorders[e]=""}function Ge(){let e=0;function t(){e--,0===e&&(document.getElementById("loading").style.transform="scale(0)")}new MutationObserver((n=>{n.forEach((n=>{"childList"===n.type&&n.addedNodes.forEach((n=>{"IMG"===n.nodeName&&(e++,n.addEventListener("load",t))}))}))})).observe(document.body,{childList:!0,subtree:!0}),document.getElementById("loading").style.removeProperty("transform")}function Re(){document.getElementById("loading").style.transform="scale(0)"}function Ke(e,t){let n=document.createElement("div");n.style.width=`${e}px`,n.style.height=`${e}px`,n.classList.add("avatar");let a=document.createElement("img");a.classList.add("avatar-frame","noSelect"),a.style.width=`${e}px`,a.src="../Assets/UI/InstaTowersContainer.webp",n.appendChild(a);let s=document.createElement("img");return s.classList.add("avatar-img","noSelect"),s.style.width=`${e}px`,s.src=t,n.appendChild(s),n}fetch("./data/Constants.json").then((e=>e.json())).then((e=>{Ee=e,Te[4]=1})).catch((e=>{console.error("Error:",e),Tt(e,"js")}));const Fe=document.createElement("div");document.body.appendChild(Fe),document.body.classList.add("hex-bg");const We=document.createElement("div");We.classList.add("header"),Fe.appendChild(We);const qe=document.createElement("div");qe.classList.add("header-div"),We.appendChild(qe);const ze=document.createElement("h1");ze.classList.add("title"),ze.innerHTML="Bloons TD 6 Insta Tracker",qe.appendChild(ze);const Ye=document.createElement("div");Ye.classList.add("content"),Fe.appendChild(Ye);let Je=document.createElement("div");function Ve(){null!=document.getElementById("front-page")&&document.getElementById("front-page").remove();const t=document.createElement("div");t.id="front-page",t.classList.add("front-page"),Ye.appendChild(t);let n=document.createElement("p");n.classList.add("front-page-text"),n.innerHTML="Access your profile using an OAK token to track your instas!",t.appendChild(n);let a=document.createElement("div");a.classList.add("previous-oak"),t.appendChild(a),Object.entries(c).forEach((([t,n])=>{let s=document.createElement("div");s.classList.add("previous-oak-entry"),s.style.backgroundImage=`linear-gradient(to right, transparent 80%, var(--profile-primary) 100%),url(${n.banner})`,a.appendChild(s),s.appendChild(Ke(100,n.avatar));let i=document.createElement("p");i.classList.add("profile-name","black-outline"),i.innerHTML=n.displayName,s.appendChild(i);let o=document.createElement("img");o.classList.add("use-button"),o.src="./Assets/UI/ContinueBtn.webp",o.addEventListener("click",(()=>{fe||(fe=!0,document.getElementById("loading").style.removeProperty("transform"),Pe=!0,e=t,S(t))})),s.appendChild(o);let l=document.createElement("img");l.classList.add("delete-button"),l.src="./Assets/UI/CloseBtn.webp",l.addEventListener("click",(()=>{delete c[t],F(),a.removeChild(s)})),s.appendChild(l)}));let s=document.createElement("div");s.classList.add("site-access-div"),t.appendChild(s);let i=document.createElement("div");i.classList.add("oak-entry-div"),t.appendChild(i);let o=document.createElement("input");o.classList.add("key-entry"),o.placeholder="Enter your OAK here",i.appendChild(o);let l=document.createElement("div");l.classList.add("start-button","black-outline"),l.innerHTML="Start",l.addEventListener("click",(()=>{let t=o.value;t.length<5||t.length>30||!t.startsWith("oak_")?Tt('Please enter a valid OAK! This will start with "oak_".'):fe||(document.getElementById("loading").style.removeProperty("transform"),fe=!0,Pe=!0,e=o.value,S(e))})),i.appendChild(l);let d=document.createElement("div");d.classList.add("get-oak-div"),t.appendChild(d);let r=document.createElement("p");r.classList.add("where-text"),r.innerHTML="Don't have an OAK token? Read here:",d.appendChild(r);let m=document.createElement("p");m.classList.add("where-button","black-outline"),m.innerHTML="View OAK Guide",d.appendChild(m);let p=document.createElement("div");p.id="oak-instructions-div",p.classList.add("oak-instructions-div"),p.style.display="none",t.appendChild(p);let u=document.createElement("p");u.classList.add("disclaimer-text"),u.style.textAlign="center",u.style.lineHeight="20px",u.innerHTML='This is a standalone form of the Insta Monkey section from a larger project. <br>You can view it here: <a href="https://BTD6APIExplorer.github.io">Bloons TD 6 API Explorer</a>',t.appendChild(u);let h=document.createElement("p");h.classList.add("site-info-header","black-outline"),h.innerHTML="Site Information",document.createElement("div").classList.add("info-buttons");let y=document.createElement("p");y.classList.add("where-button","black-outline"),y.innerHTML="Watch Trailer";let k=document.createElement("p");k.classList.add("where-button","black-outline"),k.innerHTML="FAQ";let g=document.createElement("p");g.classList.add("where-button","black-outline"),g.innerHTML="Known Issues";let b=document.createElement("p");b.classList.add("where-button","black-outline"),b.innerHTML="Changelog";let L=document.createElement("p");L.classList.add("where-button","black-outline"),L.innerHTML="Privacy Policy";let w=document.createElement("p");w.classList.add("where-button","black-outline"),w.innerHTML="Send Feedback";let v=document.createElement("div");v.id="faq-div",v.classList.add("faq-div"),v.style.display="none",t.appendChild(v);let T=document.createElement("div");T.id="privacy-div",T.classList.add("privacy-div"),T.style.display="none",t.appendChild(T);let f=document.createElement("div");f.id="known-issues-div",f.classList.add("known-issues-div"),f.style.display="none",t.appendChild(f);let C=document.createElement("div");C.id="changelog-div",C.classList.add("changelog-div"),C.style.display="none",t.appendChild(C);let E=document.createElement("div");E.id="trailer-div",E.classList.add("trailer-div"),E.style.display="none",t.appendChild(E);let I=document.createElement("div");I.id="feedback-div",I.classList.add("feedback-div"),I.style.display="none",t.appendChild(I);let M=document.createElement("div");M.id="version-div",M.classList.add("version-div"),t.appendChild(M),m.id="oak-instructions-button",m.addEventListener("click",(()=>{X("oak-instructions")})),k.id="faq-button",k.addEventListener("click",(()=>{X("faq")})),L.id="privacy-button",L.addEventListener("click",(()=>{X("privacy")})),g.id="known-issues-button",g.addEventListener("click",(()=>{X("known-issues")})),b.id="changelog-button",b.addEventListener("click",(()=>{X("changelog")})),y.id="trailer-button",w.id="feedback-button",w.addEventListener("click",(()=>{X("feedback")}));let A=document.createElement("p");A.classList.add("oak-instructions-header","black-outline"),A.innerHTML="What is an Open Access Key?",p.appendChild(A);let B=document.createElement("p");B.classList.add("oak-instructions-text"),B.innerHTML="An Open Access Key (OAK) is a unique key that allows you to access your Bloons TD 6 data from Ninja Kiwi's Open Data API. The site will use this to fetch your information from the API. <br><br>NOTE: This site is unfortunately not available for BTD6+ on Apple Arcade and BTD6 Netflix as OAK tokens are unavailable.",p.appendChild(B);let H=document.createElement("p");H.classList.add("oak-instructions-header","black-outline"),H.innerHTML="How do I get one?",p.appendChild(H);let O=document.createElement("p");O.classList.add("oak-instructions-text"),O.innerHTML="Step 1: Login and Backup your progress with a Ninja Kiwi Account in BTD6. You can do this by going to settings from the main menu and clicking on the Account button.",p.appendChild(O);let x=document.createElement("img");x.classList.add("oak-instruction-img"),x.src="./Assets/UI/OAKTutorial1.webp",p.appendChild(x);let P=document.createElement("p");P.classList.add("oak-instructions-text"),P.innerHTML='Step 2: Select "Open Data API" at the bottom right of the account screen.',p.appendChild(P);let $=document.createElement("img");$.classList.add("oak-instruction-img"),$.src="./Assets/UI/OAKTutorial2.webp",p.appendChild($);let D=document.createElement("p");D.classList.add("oak-instructions-text"),D.innerHTML='Step 3: Generate a key and copy that in to the above text field. It should start with "oak_". Then click "Start" to begin!',p.appendChild(D);let N=document.createElement("img");N.classList.add("oak-instruction-img"),N.src="./Assets/UI/OAKTutorial3.webp",p.appendChild(N);let j=document.createElement("p");j.classList.add("oak-instructions-text"),j.innerHTML='You can read more about the Open Data API here: <a href="https://ninja.kiwi/opendatafaq" target="_blank", style="color:white";>Open Data API Article</a>',p.appendChild(j);let U=document.createElement("p");U.classList.add("oak-instructions-header","black-outline"),U.innerHTML="Frequently Asked Questions",v.appendChild(U);let G={"What can I do with this?":"Some primary uses are tracking your progress automatically, viewing events and leaderboards up to two months in the past, browsing user generated content, and as a bonus feature: viewing round information. You can also view more detailed stats and progress than you can see in the game such as your highest round for every mode on every map you've played. Those who are working on their Insta Monkey collection can use this as a tracker as the data pulled is always up to date!","How long does the API take to update after I do something in the game?":"15 minutes is the most I've seen. Be sure to press the save button in settings if you want to minimize the time it takes to update! It should not take more than 24 hours to update in any circumstance (browser caching, etc).","Why is this not available for BTD6+ and Netflix?":"This is because the data is stored differently for these versions such as using iCloud for BTD6+. This is not compatible with the Open Data API."};for(let[e,t]of Object.entries(G)){let n=document.createElement("div");n.classList.add("faq-entry-div"),v.appendChild(n);let a=document.createElement("div");a.classList.add("faq-question-div"),n.appendChild(a);let s=document.createElement("p");s.classList.add("faq-question"),s.innerHTML=e,a.appendChild(s);let i=document.createElement("img");i.classList.add("arrow-hide-btn"),i.src="./Assets/UI/ArrowHideBtn.webp",a.appendChild(i);let o=document.createElement("div");o.classList.add("faq-answer-div"),o.style.display="none",n.appendChild(o);let l=document.createElement("p");l.classList.add("faq-answer"),l.innerHTML=t,o.appendChild(l),a.addEventListener("click",(()=>{"none"===o.style.display?(o.style.display="block",i.style.transform="rotate(180deg)"):(o.style.display="none",i.style.transform="rotate(0deg)")}))}let R=document.createElement("p");R.classList.add("oak-instructions-header","black-outline"),R.innerHTML="Privacy Policy",T.appendChild(R);let K=document.createElement("p");K.classList.add("oak-instructions-text"),K.innerHTML='This app does not store any data being sent to or retrieved from Ninja Kiwi\'s Open Data API outside of your browser/device. The localStorage browser feature is used to prevent users from having to re-enter their OAK token every time they visit the site. If you would like to delete this stored data, you can do so by clicking the "X" on the profile you would like to delete on this homepage or clearing your browsing data.',T.appendChild(K);let W=document.createElement("p");W.classList.add("oak-instructions-header","black-outline"),W.innerHTML="Known Issues",f.appendChild(W);let q=document.createElement("p");q.classList.add("oak-instructions-text"),q.innerHTML="- Insta Monkeys that are collected but used do not show up<br>- Mermonkey does not show up in the Top Towers section of profiles",f.appendChild(q);let z=document.createElement("video");z.preload="none",z.classList.add("trailer-video"),z.src="./Assets/Trailer/Trailer.mp4",z.controls=!0,E.appendChild(z),y.addEventListener("click",(()=>{X("trailer"),z.play()}));let Y=document.createElement("p");Y.classList.add("oak-instructions-header","black-outline"),Y.innerHTML="Changelog",C.appendChild(Y);let J=document.createElement("p");J.classList.add("oak-instructions-text"),J.innerHTML="v1.2.0: Preview Mode and UI Improvements <br>- Added a way to use the site without an OAK token. Useful when you don't have it accessible or can't make one<br>- The site now prompts when your data has new content that the site doesn't have updated yet<br>- Challenge details now correctly shows the max amount of specific monkeys if limited<br>- Other UI fixes<br><br> v1.1.0: Insta Monkey Collection Features<br>- Added Insta Monkey Collection Event Helper. This displays the odds of getting a new Insta Monkey for each chest type and when selecting a featured tower.<br>- Also added a page documentating all of the continuous sources of Insta Monkeys<br>- UI fixes and improvements<br><br>v1.0.1: Bug Fixes<br>- Daily challenges now show the correct associated date<br>- Rework roundset processing to fix numerous bugs<br>- Add extra one-off roundsets to the list for completion sake<br>- Other minor UI fixes<br><br>v1.0.0: Initial Release<br>- The Odyssey tab is still being worked on and will be added in the near future.<br>- An Insta Monkeys Rotation helper will also be added soon.",C.appendChild(J);let V=document.createElement("p");V.classList.add("oak-instructions-header","black-outline"),V.innerHTML="Send Feedback",I.appendChild(V);let Q=document.createElement("p");function X(e){["oak-instructions"].forEach((t=>{let n=document.getElementById(t+"-div"),a=document.getElementById(t+"-button");t===e&&"none"==n.style.display?(a.classList.add("square-btn-yellow"),n.style.display="block",activeTab=e):(a.classList.remove("square-btn-yellow"),n.style.display="none")}))}Q.classList.add("oak-instructions-text"),Q.innerHTML='If you have any feedback, things to add or change on the site, or most importantly bug reports, please fill out this anonymous form: <a href="https://forms.gle/Tg1PuRNj2ftojMde6" target="_blank" style="color: white;">Feedback Form</a>',I.appendChild(Q)}function Qe(){let e=document.getElementById("progress-content");e.innerHTML="";let t=document.createElement("div");t.classList.add("insta-monkeys-header-bar"),e.appendChild(t);let n=document.createElement("div");n.classList.add("maps-progress-views"),t.appendChild(n);let a=document.createElement("p");a.classList.add("maps-progress-coop-toggle-text","black-outline"),a.classList.add("black-outline"),a.innerHTML="View Inventory:",n.appendChild(a);let s=document.createElement("div");s.id="insta-monkeys-game-view",s.classList.add("maps-progress-view","black-outline"),s.innerHTML="Game",s.addEventListener("click",(()=>{Ie="game",Xe(t,Ie)})),n.appendChild(s);let i=document.createElement("div");i.id="insta-monkeys-list-view",i.classList.add("maps-progress-view","black-outline"),i.innerHTML="List",i.addEventListener("click",(()=>{Ie="list",Xe(t,Ie)})),n.appendChild(i);let o=document.createElement("div");o.classList.add("maps-progress-views"),t.appendChild(o);let l=document.createElement("div");l.id="insta-monkeys-obtain-view",l.classList.add("maps-progress-view","black-outline"),l.innerHTML="Get More",l.addEventListener("click",(()=>{Ie="obtain",Xe(t,Ie)})),o.appendChild(l);let d=document.createElement("div");d.id="insta-monkeys-collection-view",d.classList.add("maps-progress-view","black-outline"),d.innerHTML="Collection Event",d.addEventListener("click",(()=>{Ie="collection",Xe(t,Ie)})),o.appendChild(d);let r=document.createElement("div");r.id="insta-monkeys-progress-container",r.classList.add("insta-monkeys-progress-container"),e.appendChild(r);let c=document.createElement("div");c.id="insta-monkey-progress-container",c.classList.add("insta-monkey-progress-container"),c.style.display="none",e.appendChild(c),Xe(t,Ie)}function Xe(e,t){document.getElementById("insta-monkeys-progress-container").style.removeProperty("display"),document.getElementById("insta-monkey-progress-container").style.display="none";switch(["game","list","obtain","collection"].forEach((e=>{document.getElementById(`insta-monkeys-${e}-view`).classList.remove("stats-tab-yellow")})),document.getElementById(`insta-monkeys-${t}-view`).classList.add("stats-tab-yellow"),t){case"game":e.classList.remove("border-top-only"),Ze();break;case"list":e.classList.remove("border-top-only"),it();break;case"obtain":e.classList.add("border-top-only"),ot();break;case"collection":e.classList.add("border-top-only"),rt()}}function Ze(){let e=document.getElementById("insta-monkeys-progress-container");e.innerHTML="";let n=document.createElement("div");n.classList.add("insta-monkey-game-container"),e.appendChild(n);let a=document.createElement("div");a.classList.add("towers-container"),n.appendChild(a);let s=[],i=[];Object.keys(Ee.towersInOrder).forEach((e=>{Object.keys(t.unlockedTowers).includes(e)&&(void 0!==Se.TowerTotal[e]?s.push(e):i.push(e))})),s.concat(i).forEach((e=>{let t=document.createElement("div");t.classList.add("tower-container"),t.style.backgroundImage=`url(./Assets/UI/InstaTowersContainer${Se.TowerBorders[e]||""}.webp)`,t.addEventListener("click",(()=>{_e(e)})),a.appendChild(t);let n=document.createElement("img");n.classList.add("tower-img"),n.src=ne(e,"000"),t.appendChild(n);let s=document.createElement("p");if(s.classList.add("tower-name","black-outline"),s.innerHTML=ve(e),t.appendChild(s),null!=Se.TowerTotal[e]){let n=document.createElement("p");n.classList.add("insta-progress"),t.appendChild(n);let a=document.createElement("p");a.classList.add("power-progress-text","black-outline"),a.innerHTML=Se.TowerTotal[e]||0,n.appendChild(a)}else t.classList.add("insta-tower-container-none")}))}function _e(e){document.getElementById("insta-monkeys-progress-container").style.display="none",document.getElementById("insta-monkey-progress-container").style.display="flex",et(e)}function et(e){let t=document.getElementById("insta-monkey-progress-container");t.innerHTML="";let n=document.createElement("div");t.appendChild(n);let a=document.createElement("div");a.classList.add("insta-monkey-top-bar"),n.appendChild(a);let s=document.createElement("div");s.classList.add("insta-arrow"),s.addEventListener("click",(()=>{at(e)})),a.appendChild(s);let i=document.createElement("img");i.classList.add("map-arrow-img"),i.src="./Assets/UI/PrevArrow.webp",s.appendChild(i);let o=document.createElement("div");switch(o.classList.add("insta-monkey-header-div"),Se.TowerBorders[e]){case"Gold":o.classList.add("insta-topbar-gold");break;case"Black":o.classList.add("insta-topbar-black")}a.appendChild(o);let l=document.createElement("div");l.classList.add("insta-arrow"),l.addEventListener("click",(()=>{st(e)})),a.appendChild(l);let d=document.createElement("img");d.classList.add("map-arrow-img"),d.src="./Assets/UI/NextArrow.webp",l.appendChild(d);let r=document.createElement("div");r.classList.add("maps-progress-coop-toggle"),o.appendChild(r);let c=document.createElement("p");c.classList.add("maps-progress-coop-toggle-text","black-outline"),c.innerHTML="Missing: ",r.appendChild(c);let m=document.createElement("input");m.classList.add("insta-progress-missing-toggle-input","MkOffRed"),m.type="checkbox",m.addEventListener("change",(()=>{nt(m.checked)})),m.checked=Me,r.appendChild(m);let p=document.createElement("p");p.classList.add("insta-monkey-name","black-outline"),p.innerHTML=ve(e),o.appendChild(p);let u=document.createElement("div");u.classList.add("insta-monkey-progress"),o.appendChild(u);let h=document.createElement("p");h.classList.add("insta-monkey-progress-text","black-outline"),h.innerHTML=`${Se.TowerTierTotals[e]?Object.values(Se.TowerTierTotals[e]).reduce(((e,t)=>e+t),0):0}/64`,u.appendChild(h);let y=document.createElement("div");y.id=`${e}-main-container`,y.classList.add("insta-monkey-main-container"),n.appendChild(y),tt(e),nt(m.checked)}function tt(e){let n=document.getElementById(`${e}-main-container`);n.innerHTML="";let a=document.createElement("div");a.classList.add("insta-monkey-icons-container"),n.appendChild(a),Ee.collectionOrder.forEach((n=>{let s=document.createElement("div");if(s.classList.add("insta-monkey-tier-container"),t.instaTowers.hasOwnProperty(e)&&t.instaTowers[e][n]||(s.style.display="none",s.classList.add("insta-monkey-unobtained")),a.appendChild(s),t.instaTowers.hasOwnProperty(e)&&t.instaTowers[e][n]>1){let a=document.createElement("p");a.classList.add("insta-progress","insta-tier-scale"),s.appendChild(a);let i=document.createElement("p");i.classList.add("power-progress-text","black-outline"),i.innerHTML=t.instaTowers[e][n],a.appendChild(i)}let i=document.createElement("img");i.classList.add("insta-monkey-tier-img"),i.src=t.instaTowers.hasOwnProperty(e)&&null!=t.instaTowers[e][n]?ae(e,n):"./Assets/UI/InstaUncollected.webp",s.appendChild(i),t.instaTowers.hasOwnProperty(e)&&0==t.instaTowers[e][n]&&i.classList.add("upgrade-after-locked");let o=document.createElement("p");o.classList.add("insta-monkey-tier-text","black-outline"),o.innerHTML=`${n[0]}-${n[1]}-${n[2]}`,s.appendChild(o)}))}function nt(e){Me=e;for(let e of document.getElementsByClassName("insta-monkey-unobtained"))e.style.display=Me?"block":"none"}function at(e){let t=Object.keys(Ee.towersInOrder),n=t.indexOf(e);0==n?n=t.length-1:n--,_e(t[n])}function st(e){let t=Object.keys(Ee.towersInOrder),n=t.indexOf(e);n==t.length-1?n=0:n++,_e(t[n])}function it(){let e=document.getElementById("insta-monkeys-progress-container");e.innerHTML="";let t=document.createElement("div");t.classList.add("insta-monkeys-list-container"),e.appendChild(t);let n=document.createElement("div");n.classList.add("insta-monkeys-list"),t.appendChild(n),Object.keys(Ee.towersInOrder).forEach((e=>{if(null==Se.TowerTierTotals[e])return;let t=document.createElement("div");switch(t.classList.add("insta-monkey-div"),n.appendChild(t),Se.TowerBorders[e]){case"Gold":t.classList.add("insta-list-gold");break;case"Black":t.classList.add("insta-list-black")}let a=document.createElement("div");a.classList.add("tower-container"),a.style.backgroundImage=`url(./Assets/UI/InstaTowersContainer${Se.TowerBorders[e]||""}.webp)`,a.addEventListener("click",(()=>{_e(e)})),t.appendChild(a);let s=document.createElement("img");s.classList.add("tower-img"),s.src=ne(e,"000"),a.appendChild(s);let i=document.createElement("p");i.classList.add("tower-name","black-outline"),i.innerHTML=ve(e),a.appendChild(i);let o=document.createElement("div");o.classList.add("insta-monkey-top-bottom"),t.appendChild(o);let l=document.createElement("div");l.classList.add("insta-monkey-progress-list"),o.appendChild(l);let d=document.createElement("div");d.classList.add("insta-monkey-total"),l.appendChild(d);let r=document.createElement("p");r.classList.add("insta-monkey-progress-label-text","black-outline"),r.innerHTML="Usable Instas:",d.appendChild(r);let c=document.createElement("p");c.classList.add("insta-monkey-total-text","black-outline"),c.innerHTML=Se.TowerTotal[e],d.appendChild(c);let m=document.createElement("div");m.classList.add("insta-monkey-tier-progress"),l.appendChild(m);let p=document.createElement("p");p.classList.add("insta-monkey-progress-label-text","black-outline"),p.innerHTML="Unique Instas:",m.appendChild(p);let u=document.createElement("p");u.classList.add("insta-monkey-progress-text","black-outline"),u.innerHTML=`${Object.values(Se.TowerTierTotals[e]).reduce(((e,t)=>e+t),0)}/64`,m.appendChild(u);let h=document.createElement("div");h.classList.add("insta-monkey-tiers-container"),o.appendChild(h);let y=document.createElement("p");y.classList.add("insta-monkey-tiers-label","black-outline"),y.innerHTML="Unique By Tier:",h.appendChild(y);for(let[t,n]of Object.entries(Se.TowerTierTotals[e])){let e=document.createElement("div");e.classList.add("insta-monkey-tier-div"),h.appendChild(e);let a=document.createElement("p");a.classList.add("insta-monkey-tier-text-list",`insta-tier-text-${t}`,"5"==t?"t5-insta-outline":"black-outline"),e.style.backgroundImage=`url(./Assets/UI/InstaTier${t}Container.webp)`,a.innerHTML=`${n}/${Ee.instaTiers[t].length}`,e.appendChild(a)}}))}function ot(){let e=document.getElementById("insta-monkeys-progress-container");e.innerHTML="";let t=document.createElement("div");t.classList.add("insta-monkeys-obtain-guide"),e.appendChild(t);let n=document.createElement("p");n.classList.add("insta-monkeys-guide-title-text","black-outline"),n.innerHTML="Where To Get More Insta Monkeys",t.appendChild(n);let a={Collection:{name:"Collection Events",desc:"Collection events are the main way to get Insta Monkeys. They usually happen around holidays. During the event, collect as much of the event currency as possible to open crates that contain random Insta Monkeys. You can use the Collection Event tab to help you view the odds of getting a new Insta Monkey from each of the chest types."},Daily:{name:"Daily Challenges",desc:"Daily Challenges often have random Insta Monkeys ranging from T1 to T3 as a reward. Coop Daily Challenges also give a random T1-T3 Insta Monkey. During a Collection event, these will give event currency for opening Insta Monkey chests."},Boss:{name:"Boss Events",desc:"Boss events happen every week. Defeating the Tier 4 and Tier 5 bosses in these events give random Insta Monkeys. The Normal Boss rewards include a T2 and T3 Insta Monkey, and the Elite Boss rewards include a T3 and T4 Insta Monkey."},Odyssey:{name:"Odyssey Events",desc:"Odyssey events give Insta Monkeys for completing the event and opening the chest. Medium difficulty usually gives a predetermined T3 Insta, and Hard gives a predetermined T4 Insta. During Collection events, Odysseys will give collection event currency instead for Insta Monkey chests."},Ranked:{name:"Ranked Events",desc:"Ranked events give random Insta Monkeys depending on your leaderboard placement. You can view Races, Bosses, and Contested Territory leaderboard rewards at the bottom right of the leaderboard. There is also a Mini Leaderboard for each event which gives extra rewards including Insta Monkeys."},R100:{name:"100 Rounds Rewards",desc:"Every 100 rounds you complete in a game, you get a random Insta Monkey. The tier of the Insta Monkey is dependent on the difficulty of the map. Beginner gives T0-T2, Intermediate gives T1-T3, Advanced gives T2-T4, Expert gives T3-T4. Round 200 and beyond also guarantees T3-T4 regardless of difficulty."},Chest:{name:"Daily Chest",desc:"The daily chest gives a random Insta Monkey on some days. The tiers range from T1-T4."},Shop:{name:"Shop",desc:"Need more Instas? The shop has some Insta packs you can purchase."}},s=document.createElement("div");s.classList.add("insta-monkey-guide-container"),t.appendChild(s),Object.keys(a).forEach((e=>{let t=document.createElement("div");t.classList.add("insta-monkey-guide-method"),s.appendChild(t);let n=document.createElement("div");n.classList.add("insta-monkey-guide-text-div"),t.appendChild(n);let i=document.createElement("p");i.classList.add("insta-monkey-guide-method-text","black-outline"),i.innerHTML=a[e].name,n.appendChild(i);let o=document.createElement("p");o.classList.add("insta-monkey-guide-method-desc"),o.innerHTML=a[e].desc,n.appendChild(o);let l=document.createElement("img");l.classList.add("insta-monkey-guide-method-img"),l.src=`./Assets/UI/Obtain${e}.webp`,t.appendChild(l)}))}function lt(){let e=document.createElement("div");e.classList.add("error-modal-overlay"),document.body.appendChild(e);let t=document.createElement("div");t.classList.add("collection-modal"),e.appendChild(t);let n=document.createElement("div");n.classList.add("collection-modal-header"),t.appendChild(n);let a=document.createElement("div");a.classList.add("collection-header-modal-left"),n.appendChild(a);let s=document.createElement("p");s.classList.add("collection-modal-header-text","black-outline"),s.innerHTML="Standard Chest Base Odds",n.appendChild(s);let i=document.createElement("img");i.classList.add("collection-modal-close"),i.src="./Assets/UI/CloseBtn.webp",i.addEventListener("click",(()=>{e.remove()})),n.appendChild(i);let o=document.createElement("p");o.classList.add("collection-desc-text"),o.innerHTML="These are the standard odds. Certain events may change these, but they will be updated to be accurate when I update the site. Accurate as of 8/30/2024",t.appendChild(o);let l=document.createElement("div");l.classList.add("modal-help-divs"),t.appendChild(l),Object.entries(Ee.collection.crateRewards.instaMonkey).forEach((([e,t])=>{let n=document.createElement("div");n.classList.add("chest-container"),l.appendChild(n);let a=document.createElement("img");a.classList.add("collection-event-chest-selector"),a.src=`./Assets/UI/EventMysteryBox${xe[e]}Icon.webp`,n.appendChild(a);let s=document.createElement("div");s.classList.add("chest-tier-div"),n.appendChild(s),Object.entries(t.tierChance).forEach((([e,t])=>{let n=document.createElement("div");n.classList.add("tier-container"),s.appendChild(n);let a=document.createElement("img");a.classList.add("insta-monkey-tier-img"),a.src=`./Assets/UI/InstaRandomTier${e}.webp`,n.appendChild(a);let i=document.createElement("p");i.classList.add("tier-text","black-outline"),i.innerHTML=`${(100*t).toFixed(2)}%`,n.appendChild(i)}));let i=document.createElement("div");i.classList.add("chest-quantity-div"),n.appendChild(i),Object.entries(t.quantityChance).forEach((([e,t])=>{let n=document.createElement("div");n.classList.add("quantity-container"),i.appendChild(n);let a=document.createElement("div");a.classList.add("insta-icon-div"),n.appendChild(a);let s=document.createElement("img");s.classList.add("insta-quantity-icon"),s.src="./Assets/UI/InstaIcon.webp",a.appendChild(s);let o=document.createElement("p");o.classList.add("bloon-group-number","black-outline"),o.innerHTML=`X${e}`,a.appendChild(o);let l=document.createElement("p");l.classList.add("quantity-text","black-outline"),l.innerHTML=100*t+"%",n.appendChild(l)}))}))}function dt(){let e=document.createElement("div");e.classList.add("error-modal-overlay"),document.body.appendChild(e);let t=document.createElement("div");t.classList.add("collection-modal"),e.appendChild(t);let n=document.createElement("div");n.classList.add("collection-modal-header"),t.appendChild(n);let a=document.createElement("div");a.classList.add("collection-header-modal-left"),n.appendChild(a);let s=document.createElement("p");s.classList.add("collection-modal-header-text","black-outline"),s.innerHTML="How to Use This Helper",n.appendChild(s);let i=document.createElement("img");i.classList.add("collection-modal-close"),i.src="./Assets/UI/CloseBtn.webp",i.addEventListener("click",(()=>{e.remove()})),n.appendChild(i);let o=document.createElement("div");o.classList.add("modal-help-divs"),t.appendChild(o);Object.entries({"What is a Collection Event?":"These are events that occur approximately every other month (usually around holidays) that allow you to earn some form of currency that count towards unlocking Insta Monkey chests. This is the best way for collectors to work on their Insta Monkey collection.","What is a Featured Insta?":"Every 8 hours, a rotating select rotation of 4 Featured Insta Monkeys are available to select in collection events. Selecting a Featured Insta Monkey in-game will guarantee that Insta Monkeys recieved from the chest are of that tower type.","What does this helper do?":"When opening chests, how do you know which Featured Insta Monkey is best to pick to have the highest chance of getting a new Insta Monkey for your collection? This helps you choose what to pick, read below to learn how.","Start by Selecting a Chest":"Choose your current Collection Event chest type to set the type of chest to calculate the odds for.","Choose a Featured Insta Monkey (Optional)":"If you choose a featured Insta Monkey below the chests, you will see the odds by tier and total chance for that Insta Monkey. Select the same one again to go back to All Towers.","Entering Obtained Insta Monkeys":"At the bottom of selecting a featured Insta, you can see the missing Instas. Click on an Insta that you were missing to mark it as obtained manually until the API updates (takes at most 15 minutes).","All Towers":"All Towers displays the chances of getting a new Insta Monkey relative to your entire collection in the selected chest as well as a combined list of all the chances you will see when selecting each Featured Insta.","Featured Insta Odds List":"This is a great way to see which Featured Insta Monkey will be more likely to get a new Insta Monkey for your current chest type, including if it's better to let it go completely random with none selected!","How are the chances calculated?":"The chances are calculated by first taking how likely a specific Insta is out of random Insta Tier roll, and then multiplying it by the chest's likelihood of getting that random tier as a roll. This chance is for each individual roll of an Insta, and does not account for the varying quantities of Instas in chests. For example, using this sample Monkey Sub information, we can calculate how likely getting a missing Tier 2 is from a Silver Chest by first taking the chance of rolling that Insta Monkey when rolling a Tier 2 Insta from the chest, and then multiplying it by the chance of getting a Tier 2 Insta from the chest. In reality, this is 1/12 * 40% which is equivalent to 3.33%."}).forEach((([e,t],n)=>{let a=document.createElement("div");a.classList.add("modal-help-div"),o.appendChild(a);let s=document.createElement("p");s.classList.add("collection-header-title-text","black-outline"),s.innerHTML=e,a.appendChild(s);let i=document.createElement("p");i.classList.add("collection-desc-text"),i.innerHTML=t,a.appendChild(i);let l=document.createElement("img");l.classList.add("collection-help-img"),l.src=`./Assets/UI/CollectionHelp${n+1}.webp`,a.appendChild(l)}))}function rt(){let e=document.getElementById("insta-monkeys-progress-container");e.innerHTML="",Ae="None";let n=document.createElement("div");n.classList.add("insta-monkey-collection-container"),e.appendChild(n);let a=document.createElement("p");a.classList.add("collection-header-title-text","black-outline"),a.innerHTML="New Insta Monkey Chances",n.appendChild(a);let s=document.createElement("div");s.classList.add("insta-monkey-collection-top-btns"),n.appendChild(s);let i=document.createElement("p");i.classList.add("where-button","black-outline"),i.innerHTML="How to Use This",i.addEventListener("click",(()=>{dt()})),s.appendChild(i);let o=document.createElement("p");o.classList.add("where-button","black-outline"),o.style.width="230px",o.innerHTML="View Chest Odds",o.addEventListener("click",(()=>{lt()})),s.appendChild(o);let l=document.createElement("p");l.classList.add("collection-desc-text"),l.innerHTML="Select a chest to see the chances of obtaining a new Insta Monkey based on your current collection. You can also view the Featured list or select a Featured Insta below to check the odds for selecting them in the event. The percentages represent the odds for each Insta Monkey received, so if a chest yields 2 Insta Monkeys, the odds are for 1 Insta Monkey roll.";let d=document.createElement("div");d.classList.add("collection-event-chest-selectors"),n.appendChild(d),Object.keys(xe).forEach((e=>{let t=document.createElement("img");t.id=`collection-event-chest-selector-${e}`,t.classList.add("collection-event-chest-selector"),t.src=`./Assets/UI/EventMysteryBox${xe[e]}Icon.webp`,t.addEventListener("click",(()=>{pt(e)})),d.appendChild(t)}));let r=document.createElement("div");r.classList.add("collection-event-tower-selectors"),n.appendChild(r),Object.keys(Ee.towersInOrder).forEach((e=>{if(!Object.keys(t.unlockedTowers).includes(e))return;let n=document.createElement("div");n.classList.add("collection-event-tower-selector"),n.addEventListener("click",(()=>{for(element of(Be=Be===e?"All":e,document.getElementsByClassName("collection-event-tower-selector")))element.classList.remove("collection-event-tower-selector-active");"All"!=Be&&n.classList.add("collection-event-tower-selector-active"),mt(Be)})),r.appendChild(n);let a=document.createElement("img");a.classList.add("collection-tower-icon"),a.src=ae(e,"000"),n.appendChild(a)}));let c=document.createElement("div");c.id="collection-event-tower-info",c.classList.add("collection-event-tower-info"),n.appendChild(c),mt(Be)}function ct(e){let n=[];if("All"==e)for(let e=1;e<6;e++){let a=0;Object.keys(Ee.towersInOrder).forEach((n=>{Object.keys(t.unlockedTowers).includes(n)&&(a+=Se.TowerMissingByTier[n][e].length||0)})),n.push(a>0?a/(Ee.instaTiers[e].length*Object.keys(t.unlockedTowers).length):0)}else for(let t=1;t<6;t++){let a=Se.TowerMissingByTier[e][t].length||0;n.push(a>0?a/Ee.instaTiers[t].length:0)}let a=Ee.collection.crateRewards.instaMonkey[Ae].tierChance;return n.forEach(((e,t)=>{let s=a[t+1]||0;n[t]=e*s})),n}function mt(e){"None"==Ae&&pt("wood");let t=ct(e),n=document.getElementById("collection-event-tower-info");n.innerHTML="";let s=document.createElement("div");s.classList.add("insta-monkey-div","insta-monkey-collection-div"),n.appendChild(s);let i=document.createElement("div");if(i.classList.add("insta-monkey-collection-main-div"),s.appendChild(i),"All"!=e)switch(Se.TowerBorders[e]){case"Gold":s.classList.add("insta-list-gold");break;case"Black":s.classList.add("insta-list-black")}let o=document.createElement("div");o.classList.add("insta-tower-and-missing-toggle"),"All"==e&&o.classList.add("insta-collection-all"),i.appendChild(o);let l=document.createElement("div");l.classList.add("tower-container-collection"),l.style.backgroundImage=`url(./Assets/UI/InstaTowersContainer${Se.TowerBorders[e]||""}.webp)`,"All"!=e&&l.addEventListener("click",(()=>{_e(e)})),o.appendChild(l);let d=document.createElement("img");d.classList.add("tower-img"),d.src="All"==e?"./Assets/UI/AllTowersIcon.webp":ne(e,"000"),l.appendChild(d);let r=document.createElement("p");r.classList.add("tower-name","black-outline"),r.innerHTML="All"==e?"All Towers":ve(e),l.appendChild(r);let c=document.createElement("div");c.classList.add("insta-missing-toggle-div");let m=document.createElement("p");m.classList.add("insta-collection-missing-label","black-outline"),m.innerHTML="Show Missing: ",c.appendChild(m);let p=document.createElement("input");p.classList.add("maps-progress-coop-toggle-input"),p.type="checkbox",p.checked=He,c.appendChild(p),"All"!=e&&o.appendChild(c);let u=document.createElement("div");u.classList.add("insta-monkey-top-bottom"),i.appendChild(u);let h=document.createElement("div");h.classList.add("insta-monkey-progress-list"),u.appendChild(h);let y=document.createElement("div");y.classList.add("insta-monkey-total"),h.appendChild(y);let k=document.createElement("p");k.classList.add("insta-monkey-progress-label-text","black-outline"),k.innerHTML="Usable Instas:",y.appendChild(k);let g=document.createElement("p");g.classList.add("insta-monkey-total-text","black-outline"),g.innerHTML="All"==e?Object.values(Se.TowerTotal).reduce(((e,t)=>e+t)):Se.TowerTotal[e],y.appendChild(g);let b=document.createElement("div");b.classList.add("insta-monkey-tier-progress"),h.appendChild(b);let L=document.createElement("p");L.classList.add("insta-monkey-progress-label-text","black-outline"),L.innerHTML="Unique Instas:",b.appendChild(L);let w=document.createElement("p");w.classList.add("insta-monkey-progress-text","black-outline"),w.innerHTML="All"==e?`${a.gameplay.instaMonkeyCollection}/${Ee.totalInstaMonkeys}`:`${Object.values(Se.TowerTierTotals[e]).reduce(((e,t)=>e+t),0)}/64`,b.appendChild(w);let v=document.createElement("div");v.classList.add("insta-monkey-new-chance"),h.appendChild(v);let T=document.createElement("p");T.classList.add("insta-monkey-progress-label-text","black-outline"),T.innerHTML="Total New Chance:",v.appendChild(T);let f=document.createElement("p");f.classList.add("insta-monkey-total-chance-text","black-outline"),v.appendChild(f);let C=document.createElement("div");C.classList.add("insta-monkey-tiers-container"),u.appendChild(C);let E=document.createElement("p");E.classList.add("insta-monkey-tiers-label","black-outline"),E.innerHTML="Unique By Tier:",C.appendChild(E);let I="All"==e?Object.entries([1,2,3,4,5].reduce(((e,t)=>({...e,[t]:Object.values(Se.TowerTierTotals).map((e=>e[t]||0)).reduce(((e,t)=>e+t),0)})),{})):Object.entries(Se.TowerTierTotals[e]);for(let[t,n]of I){let a=document.createElement("div");if(a.classList.add("insta-monkey-tier-div"),C.appendChild(a),"All"==e){let e=document.createElement("p");e.classList.add("insta-monkey-tier-text-list",`insta-tier-text-${t}`,"5"==t?"t5-insta-outline":"black-outline"),a.style.backgroundImage=`url(./Assets/UI/InstaTier${t}Container.webp)`,e.innerHTML=`${n}`,a.appendChild(e);let s=document.createElement("p");s.classList.add("insta-monkey-tier-fraction-bar",`insta-tier-text-${t}`,"5"==t?"t5-insta-outline":"black-outline"),a.appendChild(s);let i=document.createElement("p");i.classList.add("insta-monkey-tier-text-list",`insta-tier-text-${t}`,"5"==t?"t5-insta-outline":"black-outline"),i.innerHTML=""+Ee.instaTiers[t].length*Object.keys(Ee.towersInOrder).length,a.appendChild(i)}else{let e=document.createElement("p");e.classList.add("insta-monkey-tier-text-list",`insta-tier-text-${t}`,"5"==t?"t5-insta-outline":"black-outline"),a.style.backgroundImage=`url(./Assets/UI/InstaTier${t}Container.webp)`,e.innerHTML=`${n}/${Ee.instaTiers[t].length}`,a.appendChild(e)}}let M=document.createElement("div");M.classList.add("insta-monkey-chance-container"),u.appendChild(M);let S=document.createElement("p");S.classList.add("insta-monkey-tiers-label","black-outline"),S.innerHTML="New Chance:",M.appendChild(S);let A="black-outline";if("All"!=e)switch(Se.TowerBorders[e]){case"Gold":A="knowledge-outline";break;case"Black":A="leaderboard-outline"}let B=Ee.collection.crateRewards.instaMonkey[Ae].tierChance;for(let[e,n]of I){let n=document.createElement("div");n.classList.add("insta-monkey-chance-div"),M.appendChild(n);let a=document.createElement("p");if(a.classList.add("insta-monkey-chance-text-list",A),a.innerHTML=(100*t[e-1]).toFixed(2)+"%",n.appendChild(a),B.hasOwnProperty(e)&&0==t[e-1]){let e=document.createElement("img");e.classList.add("insta-monkey-completed-tick"),e.src="./Assets/UI/TickGreenIcon.webp",n.appendChild(e)}else 0==t[e-1]&&a.classList.add("insta-monkey-chance-zero")}f.innerHTML=`${(100*t.reduce(((e,t)=>e+t),0)).toFixed(2)}%`,0==t.reduce(((e,t)=>e+t),0)&&f.classList.add("insta-monkey-chance-zero");let H=document.createElement("div");H.style.display="none",H.classList.add("insta-monkeys-missing-container"),s.appendChild(H),"All"!=e?p.addEventListener("change",(()=>{H.style.display=p.checked?"flex":"none",H.innerHTML="",He=p.checked,ut(H,e,t)})):(H.style.display="flex",ht(H)),He&&"All"!=e&&(H.style.display="flex",ut(H,e,t))}function pt(e){Ae=e;for(let e of document.getElementsByClassName("collection-event-chest-selector"))e.classList.remove("chest-selected"),e.classList.add("chest-unselected");document.getElementById(`collection-event-chest-selector-${e}`).classList.add("chest-selected"),mt(Be)}function ut(e,n,a){function s(n,a,s){let i=document.createElement("div");i.classList.add("insta-monkey-tier-container","insta-monkey-unobtained"),e.appendChild(i);let o=document.createElement("img");o.classList.add("insta-monkey-tier-img"),o.src=ae(n,a),i.appendChild(o),o.classList.add("upgrade-after-locked");let l=document.createElement("p");if(l.classList.add("insta-monkey-tier-text","black-outline"),l.innerHTML=`${a[0]}-${a[1]}-${a[2]}`,i.appendChild(l),s){let e=document.createElement("img");e.classList.add("insta-monkey-tier-obtained"),e.src="./Assets/UI/TickGreenIcon.webp",i.appendChild(e),i.addEventListener("click",(()=>{Se.TowerObtained[n]=Se.TowerObtained[n].filter((e=>e!=a));let e=Object.keys(Ee.instaTiers).find((e=>Ee.instaTiers[e].includes(a)));Se.TowerMissingByTier[n][e].push(a),delete t.instaTowers[n][a],Se.TowerTierTotals[n][e]-=1,Ue(n),mt(n)}))}else i.addEventListener("click",(()=>{Se.TowerObtained[n].push(a);let e=Object.keys(Ee.instaTiers).find((e=>Ee.instaTiers[e].includes(a)));Se.TowerMissingByTier[n][e]=Se.TowerMissingByTier[n][e].filter((e=>e!=a)),t.instaTowers[n][a]=0,Se.TowerTierTotals[n][e]+=1,Ue(n),mt(n)}))}if("All"==n)Object.entries(Se.TowerMissingByTier).forEach((([e,t])=>{Object.entries(t).forEach((([t,n])=>{if(a[t-1]>0)for(let t of n)s(e,t)}))}));else{let t=Object.entries(Se.TowerMissingByTier[n]).map((([e,t])=>({tier:e,insta:t}))).filter((({tier:e,insta:t})=>a[e-1]>0)).map((({insta:e})=>e)).flat();t.forEach((e=>{s(n,e,!1)}));let i=Se.TowerObtained[n];if(i.forEach((e=>{s(n,e,!0)})),0==t.length&&0==i.length){let t=document.createElement("p");t.classList.add("no-data-found","none-collection","black-outline"),t.innerHTML="None Missing in this Chest Type!",e.appendChild(t)}}}function ht(e){e.innerHTML="";let t={};t.NoFeatured=ct("All"),Object.keys(Ee.towersInOrder).forEach((e=>{t[e]=ct(e)}));let n=Object.keys(Ee.towersInOrder);switch(Oe){case"Highest Total Chance":n=Object.keys(t).sort(((e,n)=>{let a=t[e].reduce(((e,t)=>e+t),0),s=t[n].reduce(((e,t)=>e+t),0);return s-a}));break;case"In-Game Tower Order":break;case"Alphabetical Towers":n=Object.keys(Ee.towersInOrder).sort()}let a=document.createElement("div");a.classList.add("insta-monkey-title-container"),e.appendChild(a);let s=document.createElement("p");s.classList.add("collection-header-list-text","black-outline"),s.innerHTML=`Featured Insta Odds (${Ae.toLocaleUpperCase()} ${"wood"==Ae?"Crate":"Chest"})`,a.appendChild(s);let i=document.createElement("div");i.classList.add("insta-monkey-sort-container"),a.appendChild(i);let o=document.createElement("p");o.classList.add("insta-monkey-sort-label","black-outline"),o.innerHTML="Sort By:",i.appendChild(o);let l=document.createElement("select");l.classList.add("map-progress-filter-difficulty-select"),l.addEventListener("change",(()=>{})),i.appendChild(l);["Highest Total Chance","In-Game Tower Order","Alphabetical Towers"].forEach((e=>{let t=document.createElement("option");t.value=e,t.innerHTML=e,l.appendChild(t)})),l.value=Oe,l.addEventListener("change",(()=>{Oe=l.value,ht(e)}));let d=document.createElement("div");d.classList.add("insta-monkey-header-container","insta-monkey-unobtained"),e.appendChild(d),Object.entries({"Tower Type":"white","Tier 1 Chance":"insta-tier-text-1","Tier 2 Chance":"insta-tier-text-2","Tier 3 Chance":"insta-tier-text-3","Tier 4 Chance":"insta-tier-text-4","Tier 5 Chance":"insta-tier-text-5","Total Chance":"white"}).forEach((([e,t])=>{let n=document.createElement("div");n.classList.add("insta-monkey-header-container","insta-monkey-unobtained"),d.appendChild(n);let a=document.createElement("p");a.classList.add("insta-monkey-small-name-text","black-outline",t),a.innerHTML=e,n.appendChild(a)}));let r=Ee.collection.crateRewards.instaMonkey[Ae].tierChance;n.forEach((n=>{let a=document.createElement("div");a.classList.add("insta-monkey-list-container","insta-monkey-unobtained"),e.appendChild(a);let s=document.createElement("img");s.classList.add("insta-monkey-list-img"),s.src="NoFeatured"==n?"./Assets/UI/InstaRandomTier1.webp":ae(n,"000"),a.appendChild(s);let i=document.createElement("p");i.classList.add("insta-monkey-small-name-text","black-outline"),i.innerHTML="NoFeatured"==n?"No Featured Selected":ve(n),a.appendChild(i);let o=document.createElement("div");o.classList.add("insta-monkey-list-chance-container"),a.appendChild(o),t[n].forEach(((e,t)=>{let n=document.createElement("div");n.classList.add("insta-monkey-chance-div"),o.appendChild(n);let a=document.createElement("p");if(a.classList.add("insta-monkey-chance-text-list","black-outline"),a.innerHTML=(100*e).toFixed(2)+"%",r.hasOwnProperty(t+1)&&0==e){let e=document.createElement("img");e.classList.add("insta-monkey-completed-tick"),e.src="./Assets/UI/TickGreenIcon.webp",n.appendChild(e)}else 0==e&&a.classList.add("insta-monkey-chance-zero");n.appendChild(a)}));let l=document.createElement("div");l.classList.add("insta-monkey-chance-div"),o.appendChild(l);let d=t[n].reduce(((e,t)=>e+t),0),c=document.createElement("p");c.classList.add("insta-monkey-chance-text-list","black-outline"),c.innerHTML=(100*d).toFixed(2)+"%",0==d&&c.classList.add("insta-monkey-chance-zero"),l.appendChild(c)}))}function yt(e){let t={},n=e.split("#"),a=0;for(let e of n){t[a]={};let n=e.split(":"),s=n[0];if(!["MonkeyMoney","Power","InstaMonkey","KnowledgePoints","RandomInstaMonkey","Trophy"].includes(s)){t[a].type="Other",t[a].value=s,a++;continue}let i=n[1].split(",");switch(s){case"MonkeyMoney":t[a].type="MonkeyMoney",t[a].amount=parseInt(i[0]);break;case"Power":t[a].type="Power",t[a].power=i[0],t[a].amount=parseInt(i[1]),null==i[1]&&(t[a].amount=1);break;case"InstaMonkey":t[a].type="InstaMonkey",t[a].tower=i[0],t[a].tiers=i[1];break;case"KnowledgePoints":t[a].type="KnowledgePoints",t[a].amount=parseInt(i[0]);break;case"RandomInstaMonkey":t[a].type="RandomInstaMonkey",t[a].tier=i[0],t[a].amount=parseInt(i[1]);break;case"Trophy":t[a].type="Trophy",t[a].trophy=i[0]}a++}return t}function kt(e){window.location.href=e}function gt(e){window.open(e,"_blank")}function bt(e){let t=document.getElementsByClassName("loading-icon")[0].cloneNode(!0);t.classList.add("loading-icon-leaderboard"),t.style.height="unset",e.appendChild(t)}function Lt(e){null!=e?document.body.style.backgroundColor=`rgb(${255*e[0]},${255*e[1]},${255*e[2]})`:document.body.style.removeProperty("background-color")}function wt(e,t,n,a,s){switch(e){case 1:return n*(a/s);case 2:return t*(s/a);case 3:return s*(t/n);case 4:return a*(n/t)}}function vt(){document.body.scrollTop=0,document.documentElement.scrollTop=0}function Tt(e,t,n){if(f&&!n)return;let a=document.createElement("div");a.classList.add("error-modal-overlay"),document.body.appendChild(a);let s=document.createElement("div");s.id="error-modal",s.classList.add("error-modal"),a.appendChild(s);let i=document.createElement("div");i.id="error-modal-header",i.classList.add("error-modal-header"),s.appendChild(i);let o=document.createElement("img");o.id="error-modal-header-img",o.classList.add("error-modal-header-img"),o.src="./Assets/UI/BadConnectionBtn.webp",i.appendChild(o);let l=document.createElement("p");l.classList.add("error-modal-header-text","black-outline"),l.innerHTML="Error",i.appendChild(l);let d=document.createElement("div");d.classList.add("error-modal-dummy"),i.appendChild(d);let r=document.createElement("div");r.id="error-modal-content",r.classList.add("error-modal-content"),r.innerHTML=""+e,s.appendChild(r);let c=document.createElement("div");if(c.classList.add("error-modal-content"),"Invalid user ID / Player Does not play this game"===e)c.innerHTML="Please try again or create a new Open Access Key.",s.appendChild(c);if("ratelimit"==t){let e=document.createElement("div");e.classList.add("error-toggle-div"),s.appendChild(e);let t=document.createElement("p");t.classList.add("maps-progress-coop-toggle-text","black-outline"),t.innerHTML="Manually Load Profiles: ",e.appendChild(t);let n=document.createElement("input");n.classList.add("maps-progress-coop-toggle-input"),n.type="checkbox",n.checked=I,n.addEventListener("change",(()=>{I=!!n.checked})),e.appendChild(n)}let m=document.createElement("div");m.classList.add("error-modal-ok-button-div"),s.appendChild(m);let p=document.createElement("div");p.classList.add("start-button","modal-ok-button","black-outline"),p.innerHTML="OK",p.addEventListener("click",(()=>{f=!1,document.body.removeChild(a)})),m.appendChild(p);let u=document.createElement("img");u.classList.add("error-modal-close"),u.src="./Assets/UI/CloseBtn.webp",u.addEventListener("click",(()=>{f=!1,document.body.removeChild(a)})),r.appendChild(u),f=!0}Je.id="progress-content",Je.classList.add("content-div"),Je.classList.add("progress"),Ye.appendChild(Je),K(),Ve();