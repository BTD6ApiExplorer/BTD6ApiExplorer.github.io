let e,t,a="",n={},l={},d={},s={},i=null,o=null,r=null,c=1,p=null,m={},u=!1,h={},g=null,L=null,b=null,y={},v=null,C=null,E=1,w=null,k="newest",f=!1,T=!1,M={},I=!1,B=!1,H=100,S=200,x=0,A=0,P=Date.now(),D=[],$=!1,O={},R={};function U(e){D.push(e),$||N()}function G(){const e=x/(H/2);return S+S*Math.pow(e,2)}async function N(){$||($=!0,function e(){if(0===D.length)return void($=!1);const t=Date.now();if(t-P>=18e4&&(x=0,P=t),x<H){const e=D.shift();x++,e()}const a=G();setTimeout(e,a)}())}async function j(e,t){let a=null;try{f?(a=await fetch(e,{cache:"reload"}),f=!1,I=!1):(a=await fetch(e),I=!1)}catch(e){return navigator.onLine?(I=!0,D=[],yl("You have hit the rate limit.<br>If you are browsing the leaderboards or content browsers, please slow down!<br><br>The rate limit will clear after a short time. You can also help prevent rate limiting by toggling the setting below which stops player profiles from loading automatically.","ratelimit"),Jt(),Ne=!1,`You have hit the rate limit. [${e}]`):(yl("You are currently offline. Please check your internet connection.","api"),`You are currently offline. [${e}]`)}try{let e=await a.json();return 1==e.success?t(e):"Rate limit"==e.reason?(T=!0,yl("You have hit the rate limit. Please try again later.","api")):(document.getElementById("loading").style.transform="scale(0)",Ne=!1,yl(e.error,"api")),e}catch(e){return yl(`Something went wrong with the request. Response Code: ${a.status} [${e}]`,"api"),`Something went wrong with the request. Response Code: ${a.status} [${e}]`}}async function F(e){f=!0;let t=!0;if(await j(`https://data.ninjakiwi.com/btd6/save/${e}`,(a=>{n=a.body,l=a.model,Ge[0]=1,t=!1,_(e)})),t&&!I){let t=document.getElementsByClassName("error-modal-overlay");for(element of t)element.parentNode.removeChild(element);delete m[e],de(),aa(),yl("Your Open Access Key has expired. Please make a new one and try again.","expire",!0)}}async function _(e){f=!0,j(`https://data.ninjakiwi.com/btd6/users/${e}`,(t=>{d=t.body,s=t.model,m[e]={displayName:d.displayName,avatar:De(d),banner:$e(d)},de(),Ge[1]=1,Ot()}))}async function q(){null==i?j("https://data.ninjakiwi.com/btd6/races",(e=>{i=e.body,un()})):un()}async function K(e){return i&&i[e]&&"string"==typeof i[e].metadata?j(i[e].metadata,(t=>(i[e].metadata=t.body,i[e]))):i[e]}async function z(){return r?(o=null,j(`${r}?page=${c}`,(e=>(o=e.body,p=o.length,document.getElementById("leaderboard-footer-page-number").innerHTML=`Page ${c} (#${c*p-(p-1)} - ${c*p})`,o)))):yl("Leaderboard Fetch Error: No leaderboard data found")}async function W(e){return null==e&&(e=r),D=[],null==O[r]&&(O[r]={entries:[]},V(e)),O[r]}async function V(e){null!=e&&(x++,await j(e,(t=>{O[r].entries=O[r].entries.concat(t.body),addLeaderboardEntries(t.body,isNaN(e.split("=")[1])?1:parseInt(e.split("=")[1]),t.body.length),O[r].next=t.next})))}async function Y(){null==g?j("https://data.ninjakiwi.com/btd6/bosses",(e=>{g=e.body,hn(Lt)})):hn(Lt)}async function J(e,t){return g&&g[e]&&"string"==typeof g[e][t?"metadataElite":"metadataStandard"]?j(g[e][t?"metadataElite":"metadataStandard"],(a=>(g[e][t?"metadataElite":"metadataStandard"]=a.body,g[e]))):g[e]}async function Z(){null==L?j("https://data.ninjakiwi.com/btd6/ct",(e=>{L=e.body,gn()})):gn()}async function X(e){let t=null;return await j(e,(e=>(t=e.body,t))),t}async function Q(){if(null!=b)return b;await j("https://data.ninjakiwi.com/btd6/challenges/filter/daily",(e=>(b=e.body,b)))}async function ee(e){return null==y[e]&&await j(`https://data.ninjakiwi.com/btd6/challenges/challenge/${e}`,(t=>(y[e]=t.body,y[e]))),y[e]}async function te(){return C?(v=null,j(`${C}${k}?page=${E}`,(e=>(v=e.body,w=v.length,document.getElementById("browser-footer-page-number").innerHTML=`Page ${E} of 4`,o)))):yl("Content Browser Fetch Error: No data found")}async function ae(e){let t=e.split("/").pop();return null==h[t]&&await j(e,(e=>{h[t]=e.body})),h[t]}async function ne(e){return null==M[e]&&await j(`https://data.ninjakiwi.com/btd6/maps/map/${e}`,(t=>(M[e]=t.body,M[e]))),M[e]}function le(){null!=localStorage.getItem("BTD6OAKStorage")&&(m=JSON.parse(localStorage.getItem("BTD6OAKStorage")))}function de(){localStorage.setItem("BTD6OAKStorage",JSON.stringify(m))}function se(e){e.substring(0,3),parseInt(e.substring(3,7));let t=e.substring(7);return[parseInt(t.substring(0,4)),parseInt(t.substring(4,6)),parseInt(t.substring(6,8))]}function ie(e,t){let a=new Date(2024,4,25),n=(t?2101:2114)-parseInt(e);return a.setDate(a.getDate()-n),(t?"adv":"rot")+e+a.toISOString().substring(0,10).replace(/-/g,"")}function oe(e,t){let a=new Date(e),n=new Date(2024,4,25).getTime()-a.getTime();return(t?"adv":"rot")+((t?2101:2114)-Math.floor(n/864e5))+e.replace(/-/g,"")}N();const re={Clicker:"Bloons Master","Superior Clicker":"Superior Bloons Master","Ultimate Clicker":"Ultimate Bloons Master","Knowledgable Primate":"Knowledgeable Primate","Triple Threat":"Triple threat","Small Bloons":"Alchermistman and Bloonacleboy","Master of Life":"Master of life","What did it cost":"What did it cost? - Everything","2 Mega Pops":"2 MegaPops","Looking fab":"Lookin fab",GoldenTicket:"Golden Ticket","Axis of Havok":"Axis of Havoc","Co-op Popper!":"Co-op Popper",CouponCrazy:"Coupon Crazy",LimitedRun:"Limited Run",ALaCode:"A La Code",InstantGratification:"Instant Gratification","Achievement Of Achievements":"Achievement of Achievements","What is this new Bloonery":"What is this new Bloonery?","Who's the Boss":"Who's the Boss?","I'llBeBack":"I'll Be Back",SoSpiiiceyNinjaKiwi:"So Spiiicey Ninja Kiwi",DavidsVsGoliath:"Davids vs Goliath",ToolsToDarwin:"Tools to Darwin",BigSpender:"Big Spender",NotLackingCriticalInformation:"Not Lacking Critical Information",StubbornStrategy:"Stubborn Strategy","Hook Line And Sinker":"Hook, Line, and Sinker",CrashOfTheTitans:"Crash of the Titans","So Shiny":"So Shiny!","Ultimate Team Up":"Ultimate Team-up",StudentLoans:"Student Loans",StickySituation:"Sticky Situation",NoHarvest:"No Harvest",ReadyPlayerOne:"Ready Player One?",TheDailyReid:"The Daily Reid",InstaCentury:"Insta Century"},ce=Object.entries(re).reduce(((e,[t,a])=>(e[a]=t,e)),{}),pe={ObynOceanGuardian:"OceanObyn",MoltenObyn:"MountainObyn",JoanOfArcAdora:"JoanOfArc",CyberQuincy:"QuincyCyber",ETnEtienne:"ETn",SentaiCaptainChurchill:"SentaiChurchill",SleighCaptainChurchill:"SleighChurchill"},me={Spikeopult:"Spike-o-pult",BuccaneerLongRange:"LongRange",BuccaneerGrapeShot:"GrapeShot",BuccaneerCrowsNest:"CrowsNest",BuccaneerHotShot:"HotShot",BuccaneerCarrierFlagship:"CarrierFlagship",BuccaneerCannonShip:"CannonShip",BuccaneerMerchantman:"Merchantman",BuccaneerFavoredTrades:"FavoredTrades",BuccaneerAircraftCarrier:"AircraftCarrier",BuccaneerDestroyer:"Destroyer",BuccaneerTradeEmpire:"TradeEmpire",BuccaneerPirateLord:"PirateLord",BuccaneerMonkeyPirates:"MonkeyPirates",HeattippedDarts:"HeatTippedDart",BioncBoomerang:"BionicBoomerang",LargeCalibre:"LongCalibre",LaserBlasts:"LaserBlast",GuidedMagic:"GuildedMagic",MortarRapidReload:"RapidReload",SupplyDrop:"CashDrop",PlasmaBlasts:"PlasmaBlast",XXXLTrap:"XXXL",OversizeNails:"OversizedNails",CenteredPath:"FlightOrders",Shockwave:"ShellShock",Monkeyopolis:"Metropolis",Spectre:"Specter",TrueSunGod:"TrueSonGod",HydraRocketPods:"HydraRockets",DartMonkeyParagon:"ApexPlasmaMaster",BoomerangMonkeyParagon:"GlaiveDominus",NinjaMonkeyParagon:"AscendedShadow",EngineerMonkeyParagon:"MasterBuilder",WizardMonkeyParagon:"MagusPerfectus",MonkeyAceParagon:"GoliathDoomship",MonkeyBuccaneerParagon:"NavarchOfTheSeas",MonkeySubParagon:"NauticSiegeCore",SmartSpikes:"DirectedSpikes",TackShooterParagon:"CycloneOfFireAndMetal"};let ue={"Directed Spikes":"Smart Spikes","Directed Spikes Description":"Smart Spikes Description",CircusGwendolinSkinName:"HarlegwenGwendolinSkinName",CircusGwendolinSkinDescription:"HarlegwenGwendolinSkinDescription",OctoJonesSkinName:"OctoJonesStrikerJonesSkinName",OctoJonesSkinDescription:"OctoJonesStrikerJonesSkinDescription",MoltenObynSkinName:"ObynMountainGuardianSkinName",MoltenObynSkinDescription:"ObynMountainGuardianSkinDescription",SushiBentoSkinName:"SushiBentoBenjaminSkinName",SushiBentoSkinDescription:"SushiBentoBenjaminSkinDescription",KaijuPatSkinName:"KaijuPatFustySkinName",KaijuPatSkinDescription:"KaijuPatFustySkinDescription",GalaxiliSkinName:"GalaxiliEziliSkinName",GalaxiliSkinDescription:"GalaxiliEziliSkinDescription",VoidoraSkinName:"VoidoraAdoraSkinName",VoidoraSkinDescription:"VoidoraAdoraSkinDescription",VikingSaudaSkinName:"VikingSaudaSaudaSkinName",VikingSaudaSkinDescription:"VikingSaudaSaudaSkinDescription",JiangshiSaudaSkinName:"JiangshiSaudaSaudaSkinName",JiangshiSaudaSkinDescription:"JiangshiSaudaSaudaSkinDescription",DreadPirateBrickellSkinName:"DreadPirateBrickellAdmiralBrickellSkinName",DreadPirateBrickellSkinDescription:"DreadPirateBrickellAdmiralBrickellSkinDescription",LifeguardBrickellSkinName:"LifeguardBrickellAdmiralBrickellSkinName",LifeguardBrickellSkinDescription:"LifeguardBrickellAdmiralBrickellSkinDescription",PsimbalsSkinName:"PsimbalsPsiSkinName",PsimbalsSkinDescription:"PsimbalsPsiSkinDescription",GeraldoGentlemanGadgeteerSkinName:"GentlemonkeyGadgeteerGeraldoSkinName",GeraldoGentlemanGadgeteerSkinDescription:"GentlemonkeyGadgeteerGeraldoSkinDescription","Mode Easy":"Easy","Mode Medium":"Medium","Mode Hard":"Hard","Mode Impoppable":"Impoppable","Mode Sandbox":"Sandbox"},he={Easy:"Bronze",PrimaryOnly:"Bronze01",Deflation:"Bronze02",Medium:"Silver",MilitaryOnly:"Silver01",Apopalypse:"Silver03",Reverse:"Silver02",Hard:"Gold",MagicOnly:"Gold01",DoubleMoabHealth:"Gold03",HalfCash:"Gold04",AlternateBloonsRounds:"Gold02",Impoppable:"Impoppable",Clicks:"ImpoppableRuby","CHIMPS-BLACK":"ImpoppableHematite"},ge={"Scientist Gwendolin":"ScientistGwendolin","Biker Bones":"BikerBones","Sentai Captain Churchill":"SentaiCaptainChurchill","Cyber Quincy":"Cyber Quincy","Octo Jones":"OctoJones","Sleigh Captain Churchill":"SleighCaptainChurchill","Wolfpack Quincy":"WolfpackQuincy",ScientistGwendolin:"Scientist Gwendolin",BikerBones:"Biker Bones",SentaiCaptainChurchill:"Sentai Captain Churchill",CyberQuincy:"Cyber Quincy",OctoJones:"Octo Jones",SleighCaptainChurchill:"Sleigh Captain Churchill",WolfpackQuincy:"Wolfpack Quincy"},Le=["ZMYVERW","ZMYUWTV","ZMYUDTK","ZMYVPGA","ZMYVPFH","ZMYWHPC"];function be(e,t){return"WizardMonkey"==e?`Assets/TowerIcon/${t}-Wizard.webp`:`Assets/TowerIcon/${t}-${e}.webp`}function ye(e,t){return"WizardMonkey"==e?`Assets/UI/InstaContainer/${t}-Wizard.webp`:`Assets/UI/InstaContainer/${t}-${e}.webp`}function ve(e,t){let a=Math.max(t[0],t[1],t[2]);switch(Math.max(t[0],t[1],t[2])){case parseInt(t[0]):a=`${a}00`;break;case parseInt(t[1]):a=`0${a}0`;break;case parseInt(t[2]):a=`00${a}`}return"WizardMonkey"==e?`Assets/InstaMonkeyIcon/${a}-WizardInsta.webp`:`Assets/InstaMonkeyIcon/${a}-${e}Insta.webp`}function Ce(e){return e=e.replace(/[^a-zA-Z0-9]/g,""),me[e]?`Assets/UpgradeIcon/${me[e]}UpgradeIcon.webp`:`Assets/UpgradeIcon/${e}UpgradeIcon.webp`}function Ee(e){return"SubAdmiral"==e?"Assets/KnowledgeIcon/NavalUpgradesIcon.webp":`Assets/KnowledgeIcon/${e}Icon.webp`}function we(e,t){return 1==t?`Assets/Portrait/${e}Portrait.webp`:`Assets/Portrait/${e}PortraitLvl${t}.webp`}function ke(e){return`Assets/HeroIconSquare/HeroIcon${e=pe[e]||e}.webp`}function fe(e){return`Assets/HeroIconCircle/HeroIcon${e=pe[e]||e}.webp`}function Te(e,t){return e=pe[e]||e,1==t?`Assets/Portrait/${e}Portrait.webp`:`Assets/Portrait/${e}PortraitLvl${t}.webp`}function Me(e){return"#ouch"==e?"Assets/MapIcon/MapSelectouchButton.webp":`Assets/MapIcon/MapSelect${e}Button.webp`}function Ie(e){return`Assets/PowerIcon/${e}Icon.webp`}function Be(e,t){return t?"Assets/AchievementIcon/HiddenIcon.webp":`Assets/AchievementIcon/${e}Icon.webp`}function He(e){return re[e]||e}function Se(e){return`Assets/MedalIcon/${e}.webp`}function xe(e){return`Assets/ModeIcon/${e}Btn.webp`}function Ae(e){switch(e.type){case"MonkeyMoney":return"Assets/UI/BloonjaminsIcon.webp";case"Power":return Ie(e.power);case"InstaMonkey":return ve(e.tower,e.tiers);case"KnowledgePoints":return"Assets/UI/KnowledgeIcon.webp";case"RandomInstaMonkey":return`Assets/UI/InstaRandomTier${0==e.tier?1:e.tier}.webp`;case"Trophy":return"Assets/UI/TrophyIcon.webp";default:return`Assets/UI/${e.value}Icon.webp`}}function Pe(e){return`Assets/ProfileAvatar/${e}.webp`}function De(e){if(0==e.avatar)return"Assets/ProfileAvatar/ProfileAvatar01.webp";let t=parseInt(e.avatar.replace(/\D/g,""));return""==e.avatar||isNaN(t)?"Assets/ProfileAvatar/ProfileAvatar01.webp":t<=ze.profileAvatars?`Assets/ProfileAvatar/${e.avatar}.webp`:e.avatarURL}function $e(e){if(0==e.banner)return"Assets/ProfileBanner/TeamsBannerDeafult.webp";let t=parseInt(e.banner.replace(/\D/g,""));return""==e.banner||isNaN(t)?"Assets/ProfileBanner/TeamsBannerDeafult.webp":t<=ze.profileBanners?`Assets/ProfileBanner/${e.banner}.webp`:e.bannerURL}function Oe(e){return Le.includes(e)?`Assets/CustomMapIcon/${e}.webp`:`https://data.ninjakiwi.com/btd6/maps/map/${e}/preview`}function Re(e){return ue[e]?je[ue[e]]:je[e]?je[e]:e}let Ue,Ge=[0,0,0,0,0],Ne=!1,je={},Fe={},_e={},qe={},Ke={},ze={},We={rank:1,xp:null,xpGoal:null},Ve=2e7,Ye={rank:1,xp:null,xpGoal:2e7},Je={},Ze={},Xe={},Qe={},et={Maps:{},Medals:{single:{},coop:{}},Borders:{single:{},coop:{}}},tt=!1,at="",nt=!1,lt=!1,dt="grid",st=!1,it="All",ot=0,rt="game",ct=!1,pt="game",mt="None",ut={TowerTotal:{},TowerTierTotals:{},TowerMissingByTier:{},TowerBorders:{},TowerObtained:{}},ht=null,gt={"Monkey Knowledge Disabled":"NoKnowledgeIcon","No Lives Lost":"NoLivesLostIcon","Selling Disabled":"SellingDisabledIcon","Powers Disabled":"PowersDisabledIcon","No Continues":"NoContinuesIcon","All Camo":"AllCamoIcon","All Regrow":"AllRegenIcon","Double Cash Disabled":"NoDoubleCashIcon","No Round 100 Reward":"NoInstaMonkeys","Custom Rounds":"CustomRoundIcon","Paragon Limit":"ParagonLimitIcon"},Lt=!1,bt="grid",yt="Simple",vt=null,Ct=0,Et=0,wt=!1,kt=null,ft=[],Tt=140,Mt=[],It="None",Bt="All",Ht=!0,St="Highest Total Chance",xt={wood:"Wooden",bronze:"Bronze",silver:"Silver",gold:"Gold",diamond:"Diamond"},At="All",Pt={Heroes:["All","HeroPlacementUpgrades","HeroPets"],Monkeys:["All","TowerPlacementUpgrades","TowerPets","Projectiles","Flags"],Bloons:["All","PopFX","AllBloonSkins","RegularSkins","MoabSkins"],Coop:["All","StandardEmotes","TextEmotes","SoundEmotes","FullScreenEmotes"],GameUI:["All","MusicTracks","Avatars","ProfileBanners","PowerSkins","Misc"]},Dt=!1,$t=!1;function Ot(){Promise.all([fetch("./data/English.json").then((e=>e.json())),fetch("./data/Achievements150.json").then((e=>e.json())),fetch("./data/trophyStoreItems.json").then((e=>e.json())),fetch("./data/teamsStoreItems.json").then((e=>e.json()))]).then((([e,t,a,n])=>{je=e,Fe=t,qe=a,Ke=n,Ge[2]=1,Ge[3]=1,Ll(),Rt()})).catch((e=>{console.error("Error:",e),yl(e,"js")})),Yt()}function Rt(){Ge.every((e=>1===e))?(document.getElementById("front-page").style.display="none",document.body.classList.add("transition-bg"),la(),Gt(),Nt(),jt(),Ft(),_t(),qt(),Wt(),zt(),Kt(),da("overview"),parseInt(n.latestGameVersion.split(".")[0])>ze.projectContentVersion&&yl(`The content of this site (v${ze.projectContentVersion}.0) is out of date with the current version (v${n.latestGameVersion.split(".")[0]}.0). New content might be missing, but everything else should remain functional.`,"api",!0)):!$t&&Ge.slice(2).every((e=>1===e))&&(document.getElementById("front-page").style.display="none",document.body.classList.add("transition-bg"),la(),da("overview"))}function Ut(){Ot(!0)}function Gt(){if(18e7===n.xp)return We.rank=155,We.xp=null,void(We.xpGoal=null);let e=parseInt(n.xp);for(let[t,a]of Object.entries(ze.Rank))if(t=parseInt(t),e<a.totalXpNeeded)return e-=parseInt(ze.Rank[t-1].totalXpNeeded),xpGoal=parseInt(a.totalXpNeeded)-parseInt(ze.Rank[t-1].totalXpNeeded),We.rank=t-1,We.xp=e,void(We.xpGoal=xpGoal)}function Nt(){let e=parseInt(n.veteranXp);for(;e>=Ve;)e-=Ve,Ye.rank+=1;Ye.xp=e}function jt(){for(let[e,t]of Object.entries(Fe))_e[t.name]=t}function Ft(){Je["Games Played"]=n.gamesPlayed,Je["Games Won"]=d.gameplay.gamesWon,Je["Highest Round (All Time)"]=d.gameplay.highestRound,Je["Highest Round (CHIMPS)"]=d.gameplay.highestRoundCHIMPS,Je["Highest Round (Deflation)"]=d.gameplay.highestRoundDeflation,Je["Monkeys Placed"]=d.gameplay.monkeysPlaced,Je["Total Pop Count"]=d.bloonsPopped.bloonsPopped,Je["Total Co-Op Pop Count"]=d.bloonsPopped.coopBloonsPopped,Je["Camo Bloons Popped"]=d.bloonsPopped.camosPopped,Je["Lead Bloons Popped"]=d.bloonsPopped.leadsPopped,Je["Purple Bloons Popped"]=d.bloonsPopped.purplesPopped,Je["Regrow Bloons Popped"]=d.bloonsPopped.regrowsPopped,Je["Ceramic Bloons Popped"]=d.bloonsPopped.ceramicsPopped,Je["MOABs Popped"]=d.bloonsPopped.moabsPopped,Je["BFBs Popped"]=d.bloonsPopped.bfbsPopped,Je["ZOMGs Popped"]=d.bloonsPopped.zomgsPopped,Je["DDTs Popped"]=d.bloonsPopped.ddtsPopped,Je["BADs Popped"]=d.bloonsPopped.badsPopped,Je["Bloons Leaked"]=d.bloonsPopped.bloonsLeaked,Je["Cash Generated"]=d.gameplay.cashEarned,Je["Cash Gifted"]=d.gameplay.coopCashGiven,Je["Abilities Used"]=d.gameplay.abilitiesUsed,Je["Powers Used"]=d.gameplay.powersUsed,Je["Insta Monkeys Used"]=d.gameplay.instaMonkeysUsed,Je["Daily Reward Chests Opened"]=d.gameplay.dailyRewards,Je["Challenges Completed"]=d.gameplay.challengesCompleted,Je.Achievements=d.gameplay.achievements,Je["Hidden Achievements"]=0,Je["Odysseys Completed"]=d.gameplay.totalOdysseysCompleted,Je["Lifetime Trophies"]=d.gameplay.totalTrophiesEarned,Je["Necro Bloons Reanimated"]=d.bloonsPopped.necroBloonsReanimated,Je["Transforming Tonics Used"]=d.bloonsPopped.transformingTonicsUsed,Je["Most Experienced Monkey"]=d.mostExperiencedMonkey,Je["Most Experienced Monkey XP"]=n.towerXP[d.mostExperiencedMonkey],Je["Most Experienced Monkey"]=Re(Je["Most Experienced Monkey"]),Je["Insta Monkey Collection"]=`${d.gameplay.instaMonkeyCollection}/${ze.totalInstaMonkeys}`,Je["Collection Chests Opened"]=d.gameplay.collectionChestsOpened,Je["Golden Bloons Popped"]=d.bloonsPopped.goldenBloonsPopped,Je["Monkey Teams Wins"]=d.gameplay.monkeyTeamsWins,Je["Bosses Popped"]=d.bloonsPopped.bossesPopped,Je["Damage Done To Bosses"]=d.gameplay.damageDoneToBosses,Je["Daily Challenges Completed"]=n.totalDailyChallengesCompleted,Je["Consecutive DCs Completed"]=n.consecutiveDailyChallengesCompleted,Je["Race Attempts"]=n.totalRacesEntered,Je["Challenges Played"]=n.challengesPlayed,Je["Challenges Shared"]=n.challengesShared,Je["Continues Used"]=n.continuesUsed;let e=0,t=0;n.achievementsClaimed.forEach((a=>{let n=_e[He(a)];n&&(n.model.hidden?e+=1:t+=1)})),Je["Hidden Achievements"]=`${e}/${ze.hiddenAchievements}`,Je.Achievements=`${t}/${ze.achievements}`}function _t(){let e={};for(let[t,a]of Object.entries(he))Ze["Medal"+a]=d._medalsSinglePlayer[t]||0,e["MedalCoop"+a]=d._medalsMultiplayer[t]||0;Ze={...Ze,...e},Ze.BlastapopoulosEliteBadge=d.bossBadgesElite.Blastapopoulos||0,Ze.BlastapopoulosBadge=d.bossBadgesNormal.Blastapopoulos||0,Ze.PhayzeEliteBadge=d.bossBadgesElite.Phayze||0,Ze.PhayzeBadge=d.bossBadgesNormal.Phayze||0,Ze.DreadbloonEliteBadge=d.bossBadgesElite.Dreadbloon||0,Ze.DreadbloonBadge=d.bossBadgesNormal.Dreadbloon||0,Ze.VortexEliteBadge=d.bossBadgesElite.Vortex||0,Ze.VortexBadge=d.bossBadgesNormal.Vortex||0,Ze.LychEliteBadge=d.bossBadgesElite.Lych||0,Ze.LychBadge=d.bossBadgesNormal.Lych||0,Ze.BloonariusEliteBadge=d.bossBadgesElite.Bloonarius||0,Ze.BloonariusBadge=d.bossBadgesNormal.Bloonarius||0,Ze.MedalEventBronzeMedal=d._medalsRace.Bronze||0,Ze.MedalEventSilverMedal=d._medalsRace.Silver||0,Ze.MedalEventDoubleSilverMedal=d._medalsRace.DoubleSilver||0,Ze.MedalEventGoldSilverMedal=d._medalsRace.GoldSilver||0,Ze.MedalEventDoubleGoldMedal=d._medalsRace.DoubleGold||0,Ze.MedalEventGoldDiamondMedal=d._medalsRace.GoldDiamond||0,Ze.MedalEventDiamondMedal=d._medalsRace.Diamond||0,Ze.MedalEventRedDiamondMedal=d._medalsRace.RedDiamond||0,Ze.MedalEventBlackDiamondMedal=d._medalsRace.BlackDiamond||0,Ze.OdysseyStarIcon=d.gameplay.totalOdysseyStars||0,Ze.BossMedalEventBronzeMedal=d._medalsBoss.Bronze||0,Ze.BossMedalEventSilverMedal=d._medalsBoss.Silver||0,Ze.BossMedalEventDoubleSilverMedal=d._medalsBoss.DoubleSilver||0,Ze.BossMedalEventGoldSilverMedal=d._medalsBoss.GoldSilver||0,Ze.BossMedalEventDoubleGoldMedal=d._medalsBoss.DoubleGold||0,Ze.BossMedalEventGoldDiamondMedal=d._medalsBoss.GoldDiamond||0,Ze.BossMedalEventDiamondMedal=d._medalsBoss.Diamond||0,Ze.BossMedalEventRedDiamondMedal=d._medalsBoss.RedDiamond||0,Ze.BossMedalEventBlackDiamondMedal=d._medalsBoss.BlackDiamond||0,Ze.EliteBossMedalEventBronzeMedal=d._medalsBossElite.Bronze||0,Ze.EliteBossMedalEventSilverMedal=d._medalsBossElite.Silver||0,Ze.EliteBossMedalEventDoubleSilverMedal=d._medalsBossElite.DoubleSilver||0,Ze.EliteBossMedalEventGoldSilverMedal=d._medalsBossElite.GoldSilver||0,Ze.EliteBossMedalEventDoubleGoldMedal=d._medalsBossElite.DoubleGold||0,Ze.EliteBossMedalEventGoldDiamondMedal=d._medalsBossElite.GoldDiamond||0,Ze.EliteBossMedalEventDiamondMedal=d._medalsBossElite.Diamond||0,Ze.EliteBossMedalEventRedDiamondMedal=d._medalsBossElite.RedDiamond||0,Ze.EliteBossMedalEventBlackDiamondMedal=d._medalsBossElite.BlackDiamond||0,Ze.CtLocalPlayerBronzeMedal=d._medalsCTLocal.Bronze||0,Ze.CtLocalPlayerSilverMedal=d._medalsCTLocal.Silver||0,Ze.CtLocalPlayerDoubleGoldMedal=d._medalsCTLocal.DoubleGold||0,Ze.CtLocalPlayerGoldDiamondMedal=d._medalsCTLocal.GoldDiamond||0,Ze.CtLocalPlayerDiamondMedal=d._medalsCTLocal.Diamond||0,Ze.CtLocalPlayerRedDiamondMedal=d._medalsCTLocal.RedDiamond||0,Ze.CtLocalPlayerBlackDiamondMedal=d._medalsCTLocal.BlackDiamond||0,Ze.CtGlobalPlayerBronzeMedal=d._medalsCTGlobal.Bronze||0,Ze.CtGlobalPlayerSilverMedal=d._medalsCTGlobal.Silver||0,Ze.CtGlobalPlayerDoubleSilverMedal=d._medalsCTGlobal.DoubleSilver||0,Ze.CtGlobalPlayerGoldSilverMedal=d._medalsCTGlobal.GoldSilver||0,Ze.CtGlobalPlayerDoubleGoldMedal=d._medalsCTGlobal.DoubleGold||0,Ze.CtGlobalPlayerGoldDiamondMedal=d._medalsCTGlobal.GoldDiamond||0,Ze.CtGlobalPlayerDiamondMedal=d._medalsCTGlobal.Diamond||0,Ze.CtGlobalPlayerRedDiamondMedal=d._medalsCTGlobal.RedDiamond||0,Ze.CtGlobalPlayerBlackDiamondMedal=d._medalsCTGlobal.BlackDiamond||0}function qt(){n.unlockedBigBloons&&(Xe["Big Bloons"]=n.bigBloonsActive),n.unlockedSmallBloons&&(Xe["Small Bloons"]=n.smallBloonsActive),n.seenBigTowers&&(Xe["Big Monkey Towers"]=n.bigTowersActive),n.unlockedSmallTowers&&(Xe["Small Monkey Towers"]=n.smallTowersActive),n.unlockedSmallBosses&&(Xe["Small Bosses"]=n.smallBossesActive)}function Kt(){let e=Object.keys(n.unlockedTowers).filter((e=>n.unlockedTowers[e])).length;Qe.Towers=`${e}/${Object.keys(n.unlockedTowers).length} Towers Unlocked`;let t=Object.keys(n.acquiredUpgrades),a=t.filter((e=>n.acquiredUpgrades[e])),l=t.filter((e=>e.includes("Paragon")&&"Sentry Paragon"!=e)),s=l.filter((e=>n.acquiredUpgrades[e]));Qe.Upgrades=`${a.length-s.length}/${t.length-l.length} Upgrades Unlocked`,s.length>0&&(Qe.Paragons=`${s.length}/${l.length} Paragon${1!=s.length?"s":""} Unlocked`);let i=Object.keys(n.unlockedHeros).filter((e=>n.unlockedHeros[e])).length;Qe.Heroes=`${i}/${Object.keys(n.unlockedHeros).length} Hero${1!=i?"es":""} Unlocked`;let o=Object.keys(n.unlockedSkins).filter((e=>!Object.keys(ze.heroesInOrder).includes(e))).filter((e=>n.unlockedSkins[e])).length;Qe.Skins=`${o}/${Object.keys(n.unlockedSkins).filter((e=>!Object.keys(ze.heroesInOrder).includes(e))).length} Hero Skin${1!=o?"s":""} Unlocked`,Qe.Knowledge=`${Object.keys(n.acquiredKnowledge).filter((e=>n.acquiredKnowledge[e])).length}/${Object.keys(n.acquiredKnowledge).length} Knowledge Points Unlocked`;let r=Object.keys(n.mapProgress).filter((e=>n.mapProgress[e])).length;Qe.MapProgress=`${r} Map${1!=r?"s":""} Played`;let c=Object.values(et.Medals.single).map((e=>e.Clicks)).filter((e=>e)).length,p=Object.values(et.Medals.coop).map((e=>e.Clicks)).filter((e=>e)).length;c+p>0&&(Qe.CHIMPS=`${c+p} CHIMPS Medal${c+p!=1?"s":""} Earned`);let m=Object.values(n.powers).map((e=>"object"==typeof e&&e.quantity?e.quantity:0)).reduce(((e,t)=>e+t));Qe.Powers=`${m} Power${1!=m?"s":""} Collected`;let u=Object.values(ut.TowerTotal).reduce(((e,t)=>e+t));Qe.InstaMonkeys=`${u} Insta${1!=u?"s":""} Collected`,Qe.Achievements=`${d.achievements}/${ze.achievements+ze.hiddenAchievements} Achievement${1!=d.achievements?"s":""} Earned`;let h=Object.keys(Xe).length;Qe.TrophyStore=`${Object.keys(n.trophyStoreItems).filter((e=>n.trophyStoreItems[e]&&qe[e])).length} Trophy Store Items Collected`,Qe.TeamsStore=`${Object.keys(n.trophyStoreItems).filter((e=>n.trophyStoreItems[e]&&Ke[e])).length} Team Store Items Unlocked`,Qe.Extras=`${h} Extra${1!=h?"s":""} Unlocked`}function zt(){for(let[e,t]of Object.entries(n.mapProgress)){let a={single:{},coop:{}};a.single.Easy=t.difficulty?.Easy?.single?.Standard,a.single.PrimaryOnly=t.difficulty?.Easy?.single?.PrimaryOnly,a.single.Deflation=t.difficulty?.Easy?.single?.Deflation,a.single.Medium=t.difficulty?.Medium?.single?.Standard,a.single.MilitaryOnly=t.difficulty?.Medium?.single?.MilitaryOnly,a.single.Apopalypse=t.difficulty?.Medium?.single?.Apopalypse,a.single.Reverse=t.difficulty?.Medium?.single?.Reverse,a.single.Hard=t.difficulty?.Hard?.single?.Standard,a.single.MagicOnly=t.difficulty?.Hard?.single?.MagicOnly,a.single.DoubleMoabHealth=t.difficulty?.Hard?.single?.DoubleMoabHealth,a.single.HalfCash=t.difficulty?.Hard?.single?.HalfCash,a.single.AlternateBloonsRounds=t.difficulty?.Hard?.single?.AlternateBloonsRounds,a.single.Impoppable=t.difficulty?.Hard?.single?.Impoppable,a.single.Clicks=t.difficulty?.Hard?.single?.Clicks,a.coop.Easy=t.difficulty?.Easy?.coop?.Standard,a.coop.PrimaryOnly=t.difficulty?.Easy?.coop?.PrimaryOnly,a.coop.Deflation=t.difficulty?.Easy?.coop?.Deflation,a.coop.Medium=t.difficulty?.Medium?.coop?.Standard,a.coop.MilitaryOnly=t.difficulty?.Medium?.coop?.MilitaryOnly,a.coop.Apopalypse=t.difficulty?.Medium?.coop?.Apopalypse,a.coop.Reverse=t.difficulty?.Medium?.coop?.Reverse,a.coop.Hard=t.difficulty?.Hard?.coop?.Standard,a.coop.MagicOnly=t.difficulty?.Hard?.coop?.MagicOnly,a.coop.DoubleMoabHealth=t.difficulty?.Hard?.coop?.DoubleMoabHealth,a.coop.HalfCash=t.difficulty?.Hard?.coop?.HalfCash,a.coop.AlternateBloonsRounds=t.difficulty?.Hard?.coop?.AlternateBloonsRounds,a.coop.Impoppable=t.difficulty?.Hard?.coop?.Impoppable,a.coop.Clicks=t.difficulty?.Hard?.coop?.Clicks;for(let[e,t]of Object.entries(a.single))t&&!1===t.completed&&(t.bestRound>=ze.endRound[e]||t.completedWithoutLoadingSave)&&(t.completed=!0);for(let[e,t]of Object.entries(a.single))t&&!0===t.completed&&t.bestRound<ze.endRound[e]&&0==t.timesCompleted&&(t.completed=!1);for(let[e,t]of Object.entries(a.coop))t&&!1===t.completed&&(t.bestRound>=ze.endRound[e]||t.completedWithoutLoadingSave)&&(t.completed=!0);for(let[e,t]of Object.entries(a.coop))t&&!0===t.completed&&t.bestRound<ze.endRound[e]&&0==t.timesCompleted&&(t.completed=!1);et.Medals.single[e]={},et.Medals.coop[e]={};for(let[t,n]of Object.entries(a.single))n&&n.completed?et.Medals.single[e][t]=!0:et.Medals.single[e][t]=!1;for(let[t,n]of Object.entries(a.coop))n&&n.completed?et.Medals.coop[e][t]=!0:et.Medals.coop[e][t]=!1;et.Medals.single[e]["CHIMPS-BLACK"]=!(!a.single.Clicks||!a.single.Clicks.completed)&&a.single.Clicks.completedWithoutLoadingSave,et.Medals.coop[e]["CHIMPS-BLACK"]=!(!a.coop.Clicks||!a.coop.Clicks.completed)&&a.coop.Clicks.completedWithoutLoadingSave;let n=["Easy","PrimaryOnly","Deflation"].every((e=>a.single[e]&&!0===a.single[e].completed)),l=n&&["Medium","MilitaryOnly","Apopalypse","Reverse"].every((e=>a.single[e]&&!0===a.single[e].completed)),d=l&&["Hard","MagicOnly","DoubleMoabHealth","HalfCash","AlternateBloonsRounds","Impoppable","Clicks"].every((e=>a.single[e]&&!0===a.single[e].completed)),s=d&&a.single.Clicks.completedWithoutLoadingSave;et.Borders.single[e]=s?"Black":d?"Gold":l?"Silver":n?"Bronze":"None",n=["Easy","PrimaryOnly","Deflation"].every((e=>a.coop[e]&&!0===a.coop[e].completed)),l=n&&["Medium","MilitaryOnly","Apopalypse","Reverse"].every((e=>a.coop[e]&&!0===a.coop[e].completed)),d=l&&["Hard","MagicOnly","DoubleMoabHealth","HalfCash","AlternateBloonsRounds","Impoppable","Clicks"].every((e=>a.coop[e]&&!0===a.coop[e].completed)),s=d&&a.coop.Clicks.completedWithoutLoadingSave,et.Borders.coop[e]=s?"Black":d?"Gold":l?"Silver":n?"Bronze":"None",et.Maps[e]=a}}function Wt(){let e={},t={},a={},l={},d={};for(let[s,i]of Object.entries(n.instaTowers)){d[s]=[],e[s]=0;let n={1:0,2:0,3:0,4:0,5:0};t[s]=t[s]||n;let o={1:[],2:[],3:[],4:[],5:[]};a[s]=a[s]||o;for(let[a,n]of Object.entries(i))e[s]+=n,ze.instaTiers[5].includes(a)&&(t[s][5]+=1),ze.instaTiers[4].includes(a)&&(t[s][4]+=1),ze.instaTiers[3].includes(a)&&(t[s][3]+=1),ze.instaTiers[2].includes(a)&&(t[s][2]+=1),ze.instaTiers[1].includes(a)&&(t[s][1]+=1);if(ze.collectionOrder.forEach((e=>{null==i[e]&&(ze.instaTiers[5].includes(e)&&a[s][5].push(e),ze.instaTiers[4].includes(e)&&a[s][4].push(e),ze.instaTiers[3].includes(e)&&a[s][3].push(e),ze.instaTiers[2].includes(e)&&a[s][2].push(e),ze.instaTiers[1].includes(e)&&a[s][1].push(e))})),t[s][4]==ze.instaTiers[4].length&&t[s][3]==ze.instaTiers[3].length&&t[s][2]==ze.instaTiers[2].length&&t[s][1]==ze.instaTiers[1].length){if(t[s][5]==ze.instaTiers[5].length){l[s]="Black";continue}l[s]="Gold"}else l[s]=""}ut.TowerTotal=e,ut.TowerTierTotals=t,ut.TowerMissingByTier=a,ut.TowerBorders=l,ut.TowerObtained=d}function Vt(e){ut.TowerTierTotals[e][4]==ze.instaTiers[4].length&&ut.TowerTierTotals[e][3]==ze.instaTiers[3].length&&ut.TowerTierTotals[e][2]==ze.instaTiers[2].length&&ut.TowerTierTotals[e][1]==ze.instaTiers[1].length?ut.TowerTierTotals[e][5]==ze.instaTiers[5].length?ut.TowerBorders[e]="Black":ut.TowerBorders[e]="Gold":ut.TowerBorders[e]=""}function Yt(){let e=0;function t(){e--,0===e&&(document.getElementById("loading").style.transform="scale(0)")}new MutationObserver((a=>{a.forEach((a=>{"childList"===a.type&&a.addedNodes.forEach((a=>{"IMG"===a.nodeName&&(e++,a.addEventListener("load",t))}))}))})).observe(document.body,{childList:!0,subtree:!0}),document.getElementById("loading").style.removeProperty("transform")}function Jt(){document.getElementById("loading").style.transform="scale(0)"}fetch("./data/Constants.json").then((e=>e.json())).then((e=>{ze=e,Ge[4]=1,na()})).catch((e=>{console.error("Error:",e),yl(e,"js")}));const Zt=document.createElement("div");document.body.appendChild(Zt),document.body.classList.add("hex-bg");const Xt=document.createElement("div");Xt.classList.add("header"),Zt.appendChild(Xt);const Qt=document.createElement("div");Qt.classList.add("header-div"),Xt.appendChild(Qt);const ea=document.createElement("h1");ea.classList.add("title"),ea.innerHTML="Bloons TD 6 API Explorer",Qt.appendChild(ea);const ta=document.createElement("div");function aa(){null!=document.getElementById("front-page")&&document.getElementById("front-page").remove();const e=document.createElement("div");e.id="front-page",e.classList.add("front-page"),ta.appendChild(e);let t=document.createElement("p");t.classList.add("disclaimer-text"),t.innerHTML="This site is not affiliated with Ninja Kiwi. All game assets belong to Ninja Kiwi.",e.appendChild(t);let n=document.createElement("p");n.classList.add("front-page-text"),n.innerHTML="Access your profile using an OAK token for the best experience!",e.appendChild(n);let l=document.createElement("div");l.classList.add("previous-oak"),e.appendChild(l),Object.entries(m).forEach((([e,t])=>{let n=document.createElement("div");n.classList.add("previous-oak-entry"),n.style.backgroundImage=`linear-gradient(to right, transparent 80%, var(--profile-primary) 100%),url(${t.banner})`,l.appendChild(n),n.appendChild(ca(100,t.avatar));let s=document.createElement("p");s.classList.add("profile-name","black-outline"),s.innerHTML=t.displayName,n.appendChild(s);let i=document.createElement("img");i.classList.add("use-button"),i.src="./Assets/UI/ContinueBtn.webp",i.addEventListener("click",(()=>{d.pause(),Ne||(Ne=!0,document.getElementById("loading").style.removeProperty("transform"),$t=!0,a=e,F(e))})),n.appendChild(i);let o=document.createElement("img");o.classList.add("delete-button"),o.src="./Assets/UI/CloseBtn.webp",o.addEventListener("click",(()=>{delete m[e],de(),l.removeChild(n)})),n.appendChild(o)}));let d=document.createElement("video");d.preload="none",d.classList.add("trailer-video"),d.src="./Assets/Trailer/Trailer.mp4",d.controls=!0;let s=document.createElement("div");s.classList.add("site-access-div"),e.appendChild(s);let i=document.createElement("div");i.classList.add("site-login-buttons"),s.appendChild(i);let o=document.createElement("p");o.classList.add("site-access-button","black-outline"),o.innerHTML="Preview Site",o.addEventListener("click",(()=>{d.pause(),Ut()})),i.appendChild(o);let r=document.createElement("p");r.classList.add("challenge-selector-or","black-outline"),r.innerHTML="OR",i.appendChild(r);let c=document.createElement("p");c.classList.add("site-access-button","black-outline"),c.innerHTML="Login With OAK",c.addEventListener("click",(()=>{document.querySelector(".oak-entry-div").style.display="flex",i.style.display="none"})),i.appendChild(c);let p=document.createElement("div");p.classList.add("oak-entry-div"),p.style.display="none",e.appendChild(p);let u=document.createElement("input");u.classList.add("key-entry"),u.placeholder="Enter your OAK here",p.appendChild(u);let h=document.createElement("div");h.classList.add("start-button","black-outline"),h.innerHTML="Start",h.addEventListener("click",(()=>{d.pause();let e=u.value;e.length<5||e.length>30||!e.startsWith("oak_")?yl('Please enter a valid OAK! This will start with "oak_".'):Ne||(document.getElementById("loading").style.removeProperty("transform"),Ne=!0,$t=!0,a=u.value,F(a))})),p.appendChild(h);let g=document.createElement("div");g.classList.add("get-oak-div"),e.appendChild(g);let L=document.createElement("p");L.classList.add("where-text"),L.innerHTML="Don't have an OAK token? Read here:",g.appendChild(L);let b=document.createElement("p");b.classList.add("where-button","black-outline"),b.innerHTML="View OAK Guide",g.appendChild(b);let y=document.createElement("div");y.id="oak-instructions-div",y.classList.add("oak-instructions-div"),y.style.display="none",e.appendChild(y);let v=document.createElement("p");v.classList.add("site-info-header","black-outline"),v.innerHTML="Site Information",e.appendChild(v);let C=document.createElement("div");C.classList.add("info-buttons"),e.appendChild(C);let E=document.createElement("p");E.classList.add("where-button","black-outline"),E.innerHTML="Watch Trailer",C.appendChild(E);let w=document.createElement("p");w.classList.add("where-button","black-outline"),w.innerHTML="FAQ",C.appendChild(w);let k=document.createElement("p");k.classList.add("where-button","black-outline"),k.innerHTML="Known Issues",C.appendChild(k);let f=document.createElement("p");f.classList.add("where-button","black-outline"),f.innerHTML="Changelog",C.appendChild(f);let T=document.createElement("p");T.classList.add("where-button","black-outline"),T.innerHTML="Privacy Policy",C.appendChild(T);let M=document.createElement("p");M.classList.add("where-button","black-outline"),M.innerHTML="Send Feedback",C.appendChild(M);let I=document.createElement("div");I.id="faq-div",I.classList.add("faq-div"),I.style.display="none",e.appendChild(I);let B=document.createElement("div");B.id="privacy-div",B.classList.add("privacy-div"),B.style.display="none",e.appendChild(B);let H=document.createElement("div");H.id="known-issues-div",H.classList.add("known-issues-div"),H.style.display="none",e.appendChild(H);let S=document.createElement("div");S.id="changelog-div",S.classList.add("changelog-div"),S.style.display="none",e.appendChild(S);let x=document.createElement("div");x.id="trailer-div",x.classList.add("trailer-div"),x.style.display="none",e.appendChild(x);let A=document.createElement("div");A.id="feedback-div",A.classList.add("feedback-div"),A.style.display="none",e.appendChild(A);let P=document.createElement("p");P.classList.add("site-info-header","sites-text","black-outline"),P.innerHTML="Standalone Sites",e.appendChild(P);let D=document.createElement("p");D.classList.add("where-text"),D.innerHTML="Separate sites with just one module of this site:",e.appendChild(D);let $=document.createElement("div");$.classList.add("site-access-div"),e.appendChild($);let O=document.createElement("div");O.classList.add("site-login-buttons"),$.appendChild(O);let R=document.createElement("p");R.classList.add("where-text","underline-text"),R.innerHTML="Roundsets",R.addEventListener("click",(()=>{dl("https://btd6apiexplorer.github.io/rounds")})),O.appendChild(R);let U=document.createElement("p");U.classList.add("where-text","underline-text"),U.innerHTML="Leaderboards",U.addEventListener("click",(()=>{dl("https://btd6apiexplorer.github.io/leaderboards")})),O.appendChild(U);let G=document.createElement("p");G.classList.add("where-text","underline-text"),G.innerHTML="Insta Tracker",G.addEventListener("click",(()=>{dl("https://btd6apiexplorer.github.io/insta")})),O.appendChild(G);let N=document.createElement("div");N.id="version-div",N.classList.add("version-div"),e.appendChild(N),b.id="oak-instructions-button",b.addEventListener("click",(()=>{re("oak-instructions")})),w.id="faq-button",w.addEventListener("click",(()=>{re("faq")})),T.id="privacy-button",T.addEventListener("click",(()=>{re("privacy")})),k.id="known-issues-button",k.addEventListener("click",(()=>{re("known-issues")})),f.id="changelog-button",f.addEventListener("click",(()=>{re("changelog")})),E.id="trailer-button",M.id="feedback-button",M.addEventListener("click",(()=>{re("feedback")}));let j=document.createElement("p");j.classList.add("oak-instructions-header","black-outline"),j.innerHTML="What is an Open Access Key?",y.appendChild(j);let _=document.createElement("p");_.classList.add("oak-instructions-text"),_.innerHTML='An Open Access Key (OAK) is a unique key that allows you to access your Bloons TD 6 data from Ninja Kiwi\'s Open Data API. The site will use this to fetch your information from the API. <br><br>NOTE: Progress tracking is not available for BTD6+ on Apple Arcade and BTD6 Netflix as OAK tokens are unavailable. Alternatively, you can <p onclick="previewSite()" style="font-family:GardeniaBold;color: white;cursor: pointer;text-decoration: underline;display: inline-block;">Preview The Site</p>',y.appendChild(_);let q=document.createElement("p");q.classList.add("oak-instructions-header","black-outline"),q.innerHTML="How do I get one?",y.appendChild(q);let K=document.createElement("p");K.classList.add("oak-instructions-text"),K.innerHTML="Step 1: Login and Backup your progress with a Ninja Kiwi Account in BTD6. You can do this by going to settings from the main menu and clicking on the Account button.",y.appendChild(K);let z=document.createElement("img");z.classList.add("oak-instruction-img"),z.src="./Assets/UI/OAKTutorial1.webp",y.appendChild(z);let W=document.createElement("p");W.classList.add("oak-instructions-text"),W.innerHTML='Step 2: Select "Open Data API" at the bottom right of the account screen.',y.appendChild(W);let V=document.createElement("img");V.classList.add("oak-instruction-img"),V.src="./Assets/UI/OAKTutorial2.webp",y.appendChild(V);let Y=document.createElement("p");Y.classList.add("oak-instructions-text"),Y.innerHTML='Step 3: Generate a key and copy that in to the above text field. It should start with "oak_". Then click "Start" to begin!',y.appendChild(Y);let J=document.createElement("img");J.classList.add("oak-instruction-img"),J.src="./Assets/UI/OAKTutorial3.webp",y.appendChild(J);let Z=document.createElement("p");Z.classList.add("oak-instructions-text"),Z.innerHTML='You can read more about the Open Data API here: <a href="https://ninja.kiwi/opendatafaq" target="_blank", style="color:white";>Open Data API Article</a>',y.appendChild(Z);let X=document.createElement("p");X.classList.add("oak-instructions-header","black-outline"),X.innerHTML="Frequently Asked Questions",I.appendChild(X);let Q={"What can I do with this?":"Some primary uses are tracking your progress automatically, viewing events and leaderboards up to two months in the past, browsing user generated content, and as a bonus feature: viewing round information. You can also view more detailed stats and progress than you can see in the game such as your highest round for every mode on every map you've played. Those who are working on their Insta Monkey collection can use this as a tracker as the data pulled is always up to date!","How long does the API take to update after I do something in the game?":"15 minutes is the most I've seen. Be sure to press the save button in settings if you want to minimize the time it takes to update! It should not take more than 24 hours to update in any circumstance (browser caching, etc).","Why is this not available for BTD6+ and Netflix?":"This is because the data is stored differently for these versions such as using iCloud for BTD6+. This is not compatible with the Open Data API."};for(let[e,t]of Object.entries(Q)){let a=document.createElement("div");a.classList.add("faq-entry-div"),I.appendChild(a);let n=document.createElement("div");n.classList.add("faq-question-div"),a.appendChild(n);let l=document.createElement("p");l.classList.add("faq-question"),l.innerHTML=e,n.appendChild(l);let d=document.createElement("img");d.classList.add("arrow-hide-btn"),d.src="./Assets/UI/ArrowHideBtn.webp",n.appendChild(d);let s=document.createElement("div");s.classList.add("faq-answer-div"),s.style.display="none",a.appendChild(s);let i=document.createElement("p");i.classList.add("faq-answer"),i.innerHTML=t,s.appendChild(i),n.addEventListener("click",(()=>{"none"===s.style.display?(s.style.display="block",d.style.transform="rotate(180deg)"):(s.style.display="none",d.style.transform="rotate(0deg)")}))}let ee=document.createElement("p");ee.classList.add("oak-instructions-header","black-outline"),ee.innerHTML="Privacy Policy",B.appendChild(ee);let te=document.createElement("p");te.classList.add("oak-instructions-text"),te.innerHTML='This app does not store any data being sent to or retrieved from Ninja Kiwi\'s Open Data API outside of your browser/device. The localStorage browser feature is used to prevent users from having to re-enter their OAK token every time they visit the site. If you would like to delete this stored data, you can do so by clicking the "X" on the profile you would like to delete on this homepage or clearing your browsing data.',B.appendChild(te);let ae=document.createElement("p");ae.classList.add("oak-instructions-header","black-outline"),ae.innerHTML="Known Issues",H.appendChild(ae);let ne=document.createElement("p");ne.classList.add("oak-instructions-text"),ne.innerHTML="None Currently!",H.appendChild(ne),x.appendChild(d),E.addEventListener("click",(()=>{re("trailer"),d.play()}));let le=document.createElement("p");le.classList.add("oak-instructions-header","black-outline"),le.innerHTML="Changelog",S.appendChild(le);let se=document.createElement("p");se.classList.add("oak-instructions-text"),se.innerHTML='v1.6.0 Leaderboards improvements and page!<br>- There is now a <a href="./leaderboards" target="_blank" style="color: white;">Leaderboards Page</a> made specifically for viewing them all in one place.<br>- Loading profiles automatically has been turned back on because...<br>- Improved the handling of automatically loading leaderboard profiles to not be rate limited as quickly. This system should hopefully prevent any rate limiting at all.<br><br>\n    v1.5.1: Bug fixes! <br>- Zero limited or excluded towers/heroes like the upcoming Bloonarius 56 will no longer show an empty box<br>- The timer no longer jumps to the first event of the list assuming there is only one active at a time.<br><br>\n    v1.5.0: Trophy Store Items and Update 46!<br>- Added Update 46 content<br>- Added the Trophy Store Items menu for those who want to see all that exist and your collection.<br>- Team Store items have also been added, but since I am unable to test how that works, it is hidden in settings by default.<br>- Settings should now save when reloading the page using the same system that saves the OAK tokens you\'ve used.<br>- Fixed a bug that prevented newer maps from showing up<br>- Added missing badges<br><br>\n    v1.4.0: Extras and Events in Roundsets<br>- User profiles on the leaderboards and content browser no longer load by default. This caused too many rate limiting issues.<br>- Added a setting in Settings to toggle automatic profile loading back on if you wanted to see the profile avatar and banner of users on the leaderboard.<br>- Added known previous events with custom roundsets to the Roundsets section.<br>- Fixed a bug involving timers going weirdly negative<br>- Added Creator Support instructions<br><br>\n    v1.3.0: QoL Changes<br>- Added Update 45 images and content<br>- You can now toggle to see just the excluded towers and heroes of a challenge or event<br>- You can now swap between Normal/Elite on the details for a boss<br>- Bloon groups can now be hidden in the round previewer by clicking on them<br>- Added a checkmark in the Collection Event list to categories that were completely collected<br>- Updated Endurance Rounds to use updated round thresholds<br>- Resolved an issue when applying a filter to content browser content and not refreshing<br>- Added Ceramic Flood Roundset (very late)<br><br>\n    v1.2.3: Collection Event Menu Upgrade<br>- Added a how to use guide at the top of the Collection Event Menu<br>- Added the Insta Chest odds to the Collection Event Menu<br>- Clicking on a missing Insta will now temporarily mark it as obtained<br><br>\n    v1.2.2: Missing Medals<br>- Added a few missing medals from the overview/leaderboard profile pages<br>- Added mouse hover tooltips to various elements<br><br>\n    v1.2.1: Insta Monkey Collection Improvements<br>- Resolved an issue preventing the collected but used Insta Monkeys from being displayed.<br>- Add a new list of all the Insta Monkey tower chances in the Collection Event Helper for efficient checking of what the best Featured Insta Monkey to choose is.<br>- The trailer video no longer plays in the background after previewing the site or logging in! Thanks for the feedback.<br><br>v1.2.0: Preview Mode and UI Improvements <br>- Added a way to use the site without an OAK token. Useful when you don\'t have it accessible or can\'t make one<br>- The site now prompts when your data has new content that the site doesn\'t have updated yet<br>- Challenge details now correctly shows the max amount of specific monkeys if limited<br>- Other UI fixes<br><br>\n    v1.1.0: Insta Monkey Collection Features<br>- Added Insta Monkey Collection Event Helper. This displays the odds of getting a new Insta Monkey for each chest type and when selecting a featured tower.<br>- Also added a page documentating all of the continuous sources of Insta Monkeys<br>- UI fixes and improvements<br><br>v1.0.1: Bug Fixes<br>- Daily challenges now show the correct associated date<br>- Rework roundset processing to fix numerous bugs<br>- Add extra one-off roundsets to the list for completion sake<br>- Other minor UI fixes<br><br>\n    v1.0.0: Initial Release<br>- The Odyssey tab is still being worked on and will be added in the near future.<br>- An Insta Monkeys Rotation helper will also be added soon.',S.appendChild(se);let ie=document.createElement("p");ie.classList.add("oak-instructions-header","black-outline"),ie.innerHTML="Send Feedback",A.appendChild(ie);let oe=document.createElement("p");function re(e){["oak-instructions","faq","privacy","known-issues","changelog","trailer","feedback"].forEach((t=>{d.pause();let a=document.getElementById(t+"-div"),n=document.getElementById(t+"-button");t===e&&"none"==a.style.display?(n.classList.add("square-btn-yellow"),a.style.display="block",activeTab=e):(n.classList.remove("square-btn-yellow"),a.style.display="none")}))}oe.classList.add("oak-instructions-text"),oe.innerHTML='If you have any feedback, things to add or change on the site, or most importantly bug reports, please fill out this anonymous form: <a href="https://forms.gle/Tg1PuRNj2ftojMde6" target="_blank" style="color: white;">Feedback Form</a>',A.appendChild(oe)}function na(){let e=document.getElementById("version-div"),t=document.createElement("p");t.classList.add("tool-version-text"),t.innerHTML=`App Version: ${ze.version} / Game Content Version: v${ze.projectContentVersion}`,e.appendChild(t)}function la(){const e=document.createElement("div");e.classList.add("header-container"),Xt.appendChild(e);let t=["Overview","Progress","Events","Explore","Extras"];t.forEach((t=>{t=t.toLowerCase();let a=document.createElement("p");a.classList.add("header-label","black-outline"),a.id=t.toLowerCase(),a.innerHTML=t,a.addEventListener("click",(()=>{da(t.toLowerCase())})),e.appendChild(a)})),t.forEach((e=>{e=e.toLowerCase();let t=document.createElement("div");t.id=e+"-content",t.classList.add("content-div"),t.classList.add(e),t.style.display="none",ta.appendChild(t)}));["Challenge","Map","PublicProfile","Leaderboard","Browser","Relics","Roundset"].forEach((e=>{e=e.toLowerCase();let t=document.createElement("div");t.id=e+"-content",t.classList.add("sub-content-div"),t.classList.add(e),t.style.display="none",ta.appendChild(t)}))}function da(e){gl(),ht&&clearInterval(ht),ul(ze.BGColor);let t=document.getElementsByClassName("content-div");for(let e of t)e.style.display="none",document.getElementById(e.id.replace("-content","")).classList.remove("selected");for(let e of document.getElementsByClassName("sub-content-div"))e.style.display="none";switch(document.getElementById(e+"-content").style.display="flex",document.getElementById(e).classList.add("selected"),e){case"overview":ra();break;case"progress":ma();break;case"events":pn();break;case"explore":Hn();break;case"extras":Un()}}ta.classList.add("content"),Zt.appendChild(ta),le(),aa();let sa,ia,oa=0;function ra(){let e=document.getElementById("overview-content");if(e.innerHTML="",$t){let t=document.createElement("div");t.classList.add("profile-header"),t.classList.add("profile-banner"),t.style.backgroundImage=`linear-gradient(to bottom, transparent 50%, var(--profile-primary) 70%),url('${$e(d)}')`,e.appendChild(t),t.appendChild(ca(100,d.avatarURL));let a=document.createElement("div");a.classList.add("profile-top-bottom"),t.appendChild(a);let l=document.createElement("div");l.classList.add("profile-top"),a.appendChild(l);let s=document.createElement("p");if(s.classList.add("profile-name","black-outline"),s.innerHTML=d.displayName,l.appendChild(s),d.followers>0){let e=document.createElement("div");e.classList.add("profile-followers"),l.appendChild(e);let t=document.createElement("p");t.classList.add("followers-label","black-outline"),t.innerHTML="Followers",e.appendChild(t);let a=document.createElement("p");a.classList.add("followers-count"),a.innerHTML=d.followers.toLocaleString(),e.appendChild(a)}let i=document.createElement("div");i.classList.add("profile-bottom"),a.appendChild(i),i.appendChild(pa()),n.veteranXp>0&&i.appendChild(pa(!0));let o=document.createElement("div");o.classList.add("below-profile-header"),e.appendChild(o);let r=document.createElement("div");r.classList.add("left-column-div"),o.appendChild(r);let c=document.createElement("div");c.classList.add("quick-stats-div"),r.appendChild(c);let p=document.createElement("div");p.classList.add("quick-stats-header"),c.appendChild(p);let m=document.createElement("p");m.classList.add("column-header-text","black-outline"),m.innerHTML="Quick Stats",p.appendChild(m);let u=document.createElement("div");u.classList.add("quick-stats-content"),c.appendChild(u);let h={Towers:"../Assets/UI/MaxMonkeysIcon.webp",Heroes:"../Assets/UI/AllHeroesIcon.webp",Extras:"../Assets/UI/SmallBloonsModeIcon.webp",Achievements:"../Assets/AchievementIcon/AchievementsIcon.webp",CHIMPS:"../Assets/MedalIcon/MedalImpoppableRuby.webp",InstaMonkeys:"../Assets/UI/InstaIcon.webp",MapProgress:"../Assets/UI/StartRoundIconSmall.webp",Paragons:"../Assets/UI/ParagonPip.webp",Powers:"../Assets/UI/PowerContainer.webp",Skins:"../Assets/UI/TopHatSprite.webp",Upgrades:"../Assets/UI/UpgradeIcon.webp",Knowledge:"../Assets/UI/KnowledgeIcon.webp",TrophyStore:"../Assets/UI/LimitedRunIcon.webp",TeamsStore:"../Assets/UI/TeamTrophyIconSmall.webp"};Object.entries(Qe).forEach((([e,t])=>{if(t.includes("0 Extras")||t.includes("0 CHIMPS")||t.includes("Team Store"))return;if(t.match(/0\/[0-9]+ Paragons/))return;let a=document.createElement("div");a.classList.add("quick-stat"),u.appendChild(a);let n=document.createElement("img");n.classList.add("quick-stat-icon"),n.src=h[e],a.appendChild(n);let l=document.createElement("p");l.classList.add("quick-stat-name"),l.innerHTML=t,a.appendChild(l)}));let g=document.createElement("div");g.classList.add("currency-medals-div"),r.appendChild(g);let L=document.createElement("div");L.classList.add("left-column-header"),g.appendChild(L);let b=document.createElement("p");b.classList.add("column-header-text","black-outline"),b.innerHTML="Currency and Medals",L.appendChild(b);let y=document.createElement("div");y.classList.add("currency-div"),g.appendChild(y);let v=document.createElement("div");v.classList.add("currency-mm-div"),y.appendChild(v);let C=document.createElement("img");C.classList.add("currency-mm-img"),C.src="../Assets/UI/BloonjaminsIcon.webp",v.appendChild(C);let E=document.createElement("p");E.classList.add("currency-mm-text","mm-outline"),E.innerHTML="$"+n.monkeyMoney.toLocaleString(),v.appendChild(E);let w=document.createElement("div");w.classList.add("currency-knowledge-div"),y.appendChild(w);let k=document.createElement("img");k.classList.add("currency-knowledge-img"),k.src="../Assets/UI/KnowledgeIcon.webp",w.appendChild(k);let f=document.createElement("p");f.classList.add("currency-knowledge-text","knowledge-outline"),f.innerHTML=n.knowledgePoints.toLocaleString(),w.appendChild(f);let T=document.createElement("div");T.classList.add("currency-trophies-div"),y.appendChild(T);let M=document.createElement("img");M.classList.add("currency-trophies-img"),M.src="../Assets/UI/TrophyIcon.webp",T.appendChild(M);let I=document.createElement("p");I.classList.add("currency-trophies-text","black-outline"),I.innerHTML=n.trophies.toLocaleString(),T.appendChild(I);let B=document.createElement("div");B.classList.add("medals-div"),g.appendChild(B);for(let[e,t]of Object.entries(Ze)){if(0===t)continue;let a=document.createElement("div");a.classList.add("medal-div"),a.title=ze.medalLabels[e],B.appendChild(a);let n=document.createElement("img");n.classList.add("medal-img"),n.src=Se(e),n.style.display="none",n.addEventListener("load",(()=>{n.width<n.height?n.style.width=`${hl(3,70,256,0,n.width)}px`:n.style.height=`${hl(3,70,256,0,n.height)}px`,n.style.removeProperty("display")})),a.appendChild(n);let l=document.createElement("p");l.classList.add("medal-text","black-outline"),l.innerHTML=t.toLocaleString(),a.appendChild(l)}let H=document.createElement("div");H.classList.add("top-heroes-monkeys-div"),r.appendChild(H);let S=document.createElement("div");S.classList.add("top-heroes-div"),H.appendChild(S);let x=document.createElement("div");x.classList.add("top-heroes-top-div"),S.appendChild(x);let A=document.createElement("div");A.classList.add("top-heroes-top-ribbon-div"),x.appendChild(A);let P=document.createElement("p");P.classList.add("top-heroes-text","black-outline"),P.innerHTML="Top Heroes",A.appendChild(P);let D=document.createElement("div");D.classList.add("maps-progress-coop-toggle"),x.appendChild(D);let $=document.createElement("p");$.classList.add("maps-progress-coop-toggle-text","black-outline"),$.innerHTML="Show All: ",D.appendChild($);let O=document.createElement("input");O.classList.add("maps-progress-coop-toggle-input"),O.type="checkbox",D.appendChild(O);let R=document.createElement("div");R.classList.add("top-heroes-list"),S.appendChild(R);let U=document.createElement("div");U.classList.add("top-3-heroes-div"),R.appendChild(U);let G=document.createElement("div");G.classList.add("other-heroes-div"),G.style.display="none",R.appendChild(G),O.addEventListener("change",(()=>{O.checked?G.style.display="flex":G.style.display="none"}));let N=0,j=Object.keys(ze.heroesInOrder);for(let[e,t]of Object.entries(d.heroesPlaced).sort(((e,t)=>t[1]-e[1]))){if(0===t)continue;if(!j.includes(e))continue;let a=document.createElement("div");a.classList.add("hero-div"),a.title=Re(e),N<3?U.appendChild(a):G.appendChild(a);let n=document.createElement("img");n.classList.add("hero-img"),n.src=we(e,1),n.style.display="none",n.addEventListener("load",(()=>{n.width<n.height?n.style.width=`${hl(3,150,1920,0,n.width)}px`:n.style.height=`${hl(3,150,1920,0,n.height)}px`,n.style.removeProperty("display")})),a.appendChild(n);let l=document.createElement("p");l.classList.add("hero-text","black-outline"),l.innerHTML=t.toLocaleString(),a.appendChild(l),N++}let F=document.createElement("div");F.classList.add("top-heroes-div"),H.appendChild(F);let _=document.createElement("div");_.classList.add("top-heroes-top-div"),F.appendChild(_);let q=document.createElement("div");q.classList.add("top-heroes-top-ribbon-div"),_.appendChild(q);let K=document.createElement("p");K.classList.add("top-heroes-text","black-outline"),K.innerHTML="Top Towers",q.appendChild(K);let z=document.createElement("div");z.classList.add("maps-progress-coop-toggle"),_.appendChild(z);let W=document.createElement("p");W.classList.add("maps-progress-coop-toggle-text","black-outline"),W.innerHTML="Show All: ",z.appendChild(W);let V=document.createElement("input");V.classList.add("maps-progress-coop-toggle-input"),V.type="checkbox",z.appendChild(V);let Y=document.createElement("div");Y.classList.add("top-heroes-list"),F.appendChild(Y);let J=document.createElement("div");J.classList.add("top-3-heroes-div"),Y.appendChild(J);let Z=document.createElement("div");Z.classList.add("other-heroes-div"),Z.style.display="none",Y.appendChild(Z),V.addEventListener("change",(()=>{V.checked?Z.style.display="flex":Z.style.display="none"})),N=0;let X=Object.keys(ze.towersInOrder);for(let[e,t]of Object.entries(d.towersPlaced).sort(((e,t)=>t[1]-e[1]))){if(0===t)continue;if(!X.includes(e))continue;let a=document.createElement("div");a.classList.add("hero-div"),a.title=Re(e),N<3?J.appendChild(a):Z.appendChild(a);let n=document.createElement("img");n.classList.add("hero-img"),n.src=ye(e,"000"),a.appendChild(n);let l=document.createElement("p");l.classList.add("hero-text","black-outline"),l.innerHTML=t.toLocaleString(),a.appendChild(l),N++}let Q=document.createElement("div");Q.classList.add("right-column-div"),o.appendChild(Q);let ee=document.createElement("div");ee.classList.add("profile-stats"),Q.appendChild(ee);let te=document.createElement("div");te.classList.add("overview-right-column-header"),ee.appendChild(te);let ae=document.createElement("p");ae.classList.add("column-header-text","black-outline"),ae.innerHTML="Overall Stats",te.appendChild(ae);for(let[e,t]of Object.entries(Je)){let a=document.createElement("div");a.classList.add("stat"),ee.appendChild(a);let n=document.createElement("p");n.classList.add("stat-name"),n.innerHTML=e,a.appendChild(n);let l=document.createElement("p");l.classList.add("stat-value"),l.innerHTML=t.toLocaleString(),a.appendChild(l)}}else{let t=document.createElement("p");t.classList.add("not-logged-in-text"),t.innerHTML="You're in preview mode.<br>The Events, Explore, and Extras tabs can be used without an OAK token.",e.appendChild(t);let a=document.createElement("p");a.classList.add("site-info-header","black-outline"),a.innerHTML="When an OAK token is entered:",e.appendChild(a);let n={Profile:{name:"View Your Profile!",desc:"You can see anything you can see on your in-game profile plus some extra Quick Stats"},FullMonkeyUses:{name:"Full Top Heroes and Top Monkeys List!",desc:"The in-game profiles only show the top 3 heroes and towers, but here you can see the full list!"},ExtraStats:{name:"View Extra Stats!",desc:"In addition to the in-game profile stats, you can view extra stats such as Total Race Attempts, Total Challenges Played, and even Continues Used"}},l=document.createElement("div");l.classList.add("insta-monkey-guide-container"),e.appendChild(l),Object.keys(n).forEach((e=>{let t=document.createElement("div");t.classList.add("insta-monkey-guide-method"),l.appendChild(t);let a=document.createElement("p");a.classList.add("insta-monkey-guide-method-text","black-outline"),a.innerHTML=n[e].name,t.appendChild(a);let d=document.createElement("p");d.classList.add("insta-monkey-guide-method-desc"),d.innerHTML=n[e].desc,t.appendChild(d);let s=document.createElement("img");s.classList.add("insta-monkey-guide-method-img"),s.src=`./Assets/UI/Overview${e}.webp`,t.appendChild(s)}))}}function ca(e,t){let a=document.createElement("div");a.style.width=`${e}px`,a.style.height=`${e}px`,a.classList.add("avatar");let n=document.createElement("img");n.classList.add("avatar-frame","noSelect"),n.style.width=`${e}px`,n.src="../Assets/UI/InstaTowersContainer.webp",a.appendChild(n);let l=document.createElement("img");return l.classList.add("avatar-img","noSelect"),l.style.width=`${e}px`,l.src=t,a.appendChild(l),a}function pa(e){let t=document.createElement("div");t.classList.add("rank");let a=document.createElement("div");a.classList.add("rank-star"),t.appendChild(a);let n=document.createElement("img");n.classList.add("rank-img"),n.src=e?"../Assets/UI/LvlHolderVeteran.webp":"../Assets/UI/LvlHolder.webp",a.appendChild(n);let l=document.createElement("p");l.classList.add("rank-text","black-outline"),l.innerHTML=e?Ye.rank:We.rank,a.appendChild(l);let d=document.createElement("div");d.classList.add("rank-bar"),t.appendChild(d);let s=document.createElement("div");s.classList.add("rank-bar-fill"),e?(d.classList.add("rank-bar-veteran"),s.classList.add("rank-bar-fill-veteran"),s.style.width=null===Ye.xp?"100%":Ye.xp/Ye.xpGoal*100+"%"):s.style.width=null===We.xp?"100%":We.xp/We.xpGoal*100+"%",d.appendChild(s);let i=document.createElement("p");return i.classList.add("rank-bar-text"),i.innerHTML=e?null===Ye.xp?"Max Level":`${Ye.xp.toLocaleString()}/${Ye.xpGoal.toLocaleString()}`:null===We.xp?"Max Level":`${We.xp.toLocaleString()}/${We.xpGoal.toLocaleString()}`,null!=We.xp||e||i.classList.add("rank-bar-text-max"),d.appendChild(i),t}function ma(){let e=document.getElementById("progress-content");if(e.innerHTML="",$t){let t=document.createElement("div");t.classList.add("progress-page"),e.appendChild(t);let a=document.createElement("div");a.classList.add("selectors-div"),t.appendChild(a),rt="game",["Towers","Heroes","MapProgress","Powers","InstaMonkeys","Knowledge","Achievements","TrophyStore","TeamsStore","Extras"].forEach((e=>{if(Qe[e].includes("0 Extras"))return;if(Qe[e].includes("Team Store")&&!Dt)return;let t=document.createElement("div");t.classList.add("selector-div"),t.addEventListener("click",(()=>{ua(e)})),a.appendChild(t);let l=document.createElement("img");l.classList.add("selector-img"),l.src="Heroes"==e?`../Assets/HeroIconCircle/HeroIcon${n.primaryHero}.webp`:"../Assets/UI/"+e.replace(" ","")+"Btn.webp",t.appendChild(l);let d=document.createElement("p");d.classList.add("selector-text","black-outline"),d.innerHTML=Qe[e],t.appendChild(d);let s=document.createElement("img");s.classList.add("selector-go-img"),s.src="../Assets/UI/ContinueBtn.webp",t.appendChild(s)}))}else{let t=document.createElement("p");t.classList.add("not-logged-in-text"),t.innerHTML="You're in preview mode.<br>The Events, Explore, and Extras tabs can be used without an OAK token.",e.appendChild(t),e.classList.add("overview");let a=document.createElement("p");a.classList.add("site-info-header","black-outline"),a.innerHTML="When an OAK token is entered:",e.appendChild(a);let n={Maps:{name:"View Extra Map Stats!",desc:"You can view your highest round and times completed count for every map on every mode!"},InstaMonkeys:{name:"View Your Insta Monkeys Collection!",desc:"You can view how many of each Insta Monkey you've accumulated here as well as track your collection."},CollectionEvent:{name:"Collection Event Helper!",desc:"Using your current inventory, you can view the odds of getting a new Insta Monkey for each chest type in general and when selecting a featured tower."},Achievements:{name:"View Achievements!",desc:"You can view your achievement progress here as well as use a few useful filters such as finding Monkey Knowledge points as rewards."},Towers:{name:"View Your Towers!",desc:"You can view portait art and total xp for every tower you've unlocked here."},Heroes:{name:"View Your Heroes!",desc:"You can view all portrait art for all heroes and skins you've unlocked as well as hero level information here."},Powers:{name:"View Your Powers!",desc:"You can view how many of each power you've accumulated here."},Knowledge:{name:"View Your Knowledge!",desc:"You can view your Monkey Knowledge point unlock progress here."}},l=document.createElement("div");l.classList.add("insta-monkey-guide-container"),e.appendChild(l),Object.keys(n).forEach((e=>{let t=document.createElement("div");t.classList.add("insta-monkey-guide-method"),l.appendChild(t);let a=document.createElement("p");a.classList.add("insta-monkey-guide-method-text","black-outline"),a.innerHTML=n[e].name,t.appendChild(a);let d=document.createElement("p");d.classList.add("insta-monkey-guide-method-desc"),d.innerHTML=n[e].desc,t.appendChild(d);let s=document.createElement("img");s.classList.add("insta-monkey-guide-method-img"),s.src=`./Assets/UI/Progress${e}.webp`,t.appendChild(s)}))}}function ua(e){switch(gl(),ht&&clearInterval(ht),e){case"Towers":ha();break;case"Heroes":Ea();break;case"Knowledge":ul(ze.ParagonBGColor),Ma();break;case"MapProgress":dt="grid",st=!1,it="All",ot=0,Ba();break;case"Powers":Ga();break;case"InstaMonkeys":Na();break;case"Achievements":dn();break;case"Extras":on();break;case"TrophyStore":Qn();break;case"TeamsStore":al()}}function ha(){let e=document.getElementById("progress-content");e.innerHTML="";let t=document.createElement("div");t.classList.add("tower-progress-container"),e.appendChild(t);let a=document.createElement("div");a.classList.add("tower-progress-div"),t.appendChild(a);let l=document.createElement("div");l.classList.add("tower-selector-header-top"),a.appendChild(l);let d=document.createElement("p");d.classList.add("tower-selector-header-text","black-outline"),d.innerHTML=`Towers - ${Object.keys(n.unlockedTowers).filter((e=>n.unlockedTowers[e])).length}/${Object.keys(n.unlockedTowers).length}`,l.appendChild(d);let s=document.createElement("p");s.classList.add("tower-selector-header-text","black-outline"),s.innerHTML=`Upgrades - ${Object.keys(n.acquiredUpgrades).filter((e=>n.acquiredUpgrades[e])).length}/${Object.keys(n.acquiredUpgrades).length}`,l.appendChild(s);let i=document.createElement("div");i.classList.add("tower-selector-header"),a.appendChild(i);n.unlockedTowers;for(let[e,t]of Object.entries(ze.towersInOrder)){if(!Object.keys(n.unlockedTowers).includes(e))continue;let a=document.createElement("div");a.id=e+"-selector",a.classList.add(`tower-selector-${t.toLowerCase()}`),n.unlockedTowers[e]||a.classList.add("hero-selector-div-disabled"),a.addEventListener("click",(()=>{n.unlockedTowers[e]&&ga(e)})),i.appendChild(a);let l=document.createElement("img");l.classList.add("tower-selector-img"),l.src=ye(e,"000"),a.appendChild(l);let d=document.createElement("div");d.id=e+"-selector-highlight",d.classList.add("tower-selector-highlight"),a.appendChild(d)}let o=document.createElement("div");o.id="tower-progress-content",o.classList.add("tower-progress-content"),t.appendChild(o),t.append(ga("DartMonkey"))}function ga(e){let t=document.getElementById("tower-progress-content");t.innerHTML="";let a=0;for(let t of Object.values(ze.towerPaths[e]))for(let e of Object.keys(t))n.acquiredUpgrades[e]&&(a+=1);a=15===a;let l=!!ze.paragonsAvailable.includes(e)&&n.acquiredUpgrades[`${e} Paragon`],d=document.createElement("div");d.classList.add("tower-progress-top"),l&&d.classList.add("tower-progress-top-paragon"),t.appendChild(d);let s=document.createElement("div");s.classList.add("tower-progress-content-top"),d.appendChild(s);let i=document.createElement("div");i.classList.add("tower-progress-info-container"),s.appendChild(i);let o=document.createElement("p");o.classList.add("tower-progress-content-text",l?"knowledge-outline":"black-outline"),o.innerHTML=tt&&n.namedMonkeys[e]?n.namedMonkeys[e]:Re(e),i.appendChild(o);let r=document.createElement("p");r.classList.add("tower-progress-content-xp","mm-outline"),r.innerHTML=`XP: ${n.towerXP[e].toLocaleString()}`,i.appendChild(r);let c=document.createElement("p");c.classList.add("tower-progress-content-desc"+(l?"-paragon":"")),c.innerHTML=Re(`${e} Description`),s.appendChild(c);let p=document.createElement("div");p.classList.add("tower-name-and-portrait"),t.appendChild(p);let m=document.createElement("p");m.id="tower-portrait-name",m.classList.add("tower-portrait-name","black-outline"),m.innerHTML=Re(e),p.appendChild(m);let u=document.createElement("div");u.id="tower-progress-portrait",u.classList.add("tower-progress-portrait"),u.classList.add(`tower-progress-portrait-${ze.towersInOrder[e].toLowerCase()}`),p.appendChild(u);let h=document.createElement("img");h.id="tower-progress-portrait-img",h.classList.add("tower-progress-portrait-img"),h.src=be(e,"000"),u.appendChild(h);let g=document.createElement("div");g.id="upgrade-tooltip",g.classList.add("upgrade-tooltip"),g.innerHTML=Re(`${e} Description`),t.appendChild(g);let L=document.createElement("div");L.classList.add("tower-progress-main-div"),t.appendChild(L),L.appendChild(La(e,a,l));let b=document.createElement("div");b.classList.add("tower-progress-bottom"),t.appendChild(b);for(let e of document.getElementsByClassName("tower-selector-highlight"))e.style.display="none";return document.getElementById(`${e}-selector-highlight`).style.display="block",l?ul(ze.ParagonBGColor):ul(),t}function La(e,t,a){let l=document.createElement("div");l.classList.add("upgrade-container");let d=document.createElement("div");d.classList.add("upgrade-rows"),l.appendChild(d);let s=document.createElement("div");s.classList.add("upgrade-row"),d.appendChild(s);let i=document.createElement("div");i.classList.add("upgrade-row"),d.appendChild(i);let o=document.createElement("div");o.classList.add("upgrade-row"),d.appendChild(o);let r=0,c=!1;for(let[t,l]of Object.entries(ze.towerPaths[e].path1)){let l=n.acquiredUpgrades[t]?"unlocked":"locked";s.appendChild(ba(e,t,l,1,r,a,c)),"locked"==l&&(c=!0),r++}r=0,c=!1;for(let[t,l]of Object.entries(ze.towerPaths[e].path2)){let l=n.acquiredUpgrades[t]?"unlocked":"locked";i.appendChild(ba(e,t,l,2,r,a,c)),"locked"==l&&(c=!0),r++}r=0,c=!1;for(let[t,l]of Object.entries(ze.towerPaths[e].path3)){let l=n.acquiredUpgrades[t]?"unlocked":"locked";o.appendChild(ba(e,t,l,3,r,a,c)),"locked"==l&&(c=!0),r++}if(ze.paragonsAvailable.includes(e)&&t){let t=document.createElement("div");t.classList.add("upgrade-container-paragon"),l.appendChild(t),t.appendChild(ya(e,`${e} Paragon`,n.acquiredUpgrades[`${e} Paragon`]?"unlocked":"locked"))}return l}function ba(e,t,a,l,d,s,i){let o=document.createElement("div");o.id=`${e}-${t}-div`,o.classList.add("upgrade-div");let r="";switch(l){case 1:r=`${d+1}00`;break;case 2:r=`0${d+1}0`;break;case 3:r=`00${d+1}`}let c=document.createElement("div");c.id=`${e}-${t}-glow`,o.appendChild(c);let p=document.createElement("div");p.classList.add("upgrade-bg-img");let m=n.towerXP[e]>=ze.towerPaths[e][`path${l}`][t];4==d?n.acquiredUpgrades[t]?p.classList.add("upgrade-t5"):p.classList.add("upgrade-t5-locked"):p.classList.add(`upgrade-${s?"paragon":"unlocked"==a?a:m?"green":"red"}`),o.appendChild(p);let u=document.createElement("img");u.classList.add("upgrade-img"),u.src=Ce(t),n.acquiredUpgrades[t]||4!=d||(u.style.visibility="hidden"),o.appendChild(u);let h=document.createElement("p");return h.classList.add("upgrade-text"),h.innerHTML=Re(t),o.appendChild(h),o.addEventListener("click",(()=>{va(e,t,r),document.getElementById("upgrade-tooltip").innerHTML=Re(`${t} Description`),Array.from(document.getElementsByClassName("upgrade-glow")).forEach((e=>{e.classList.remove("upgrade-glow")})),document.getElementsByClassName("upgrade-glow-paragon").length>0&&document.getElementsByClassName("upgrade-glow-paragon")[0].classList.remove("upgrade-glow-paragon"),c.classList.add("upgrade-glow")})),i&&(p.classList.add("upgrade-after-locked"),u.classList.add("upgrade-after-locked")),o}function ya(e,t,a){let l=document.createElement("div");l.id=`${e}-paragon-div`,l.classList.add("upgrade-div");let d=document.createElement("div");d.classList.add("upgrade-bg-img"),d.classList.add("upgrade-paragon-special"+(n.acquiredUpgrades[t]?"":"-locked")),l.appendChild(d);let s=document.createElement("div");s.id="paragon-glow",l.appendChild(s);let i=document.createElement("img");i.classList.add("upgrade-img"),i.src=Ce(`${e} Paragon`),n.acquiredUpgrades[t]||(i.style.visibility="hidden"),l.appendChild(i);let o=document.createElement("p");return o.classList.add("upgrade-text"),o.innerHTML=Re(t),l.appendChild(o),l.addEventListener("click",(()=>{Ca(e,t,"Paragon"),document.getElementById("upgrade-tooltip").innerHTML=Re(`${t} Description`),Array.from(document.getElementsByClassName("upgrade-glow")).forEach((e=>{e.classList.remove("upgrade-glow")})),s.classList.add("upgrade-glow-paragon")})),l}function va(e,t,a){let l=document.getElementById("tower-progress-portrait"),d=document.getElementById("tower-portrait-name"),s=document.getElementById("tower-progress-portrait-img");if(d.innerHTML=Re(t),a.includes("5")&&!n.acquiredUpgrades[t])return l.classList.add("tower-progress-portrait-t5-locked"),void(s.src="");l.classList.contains("tower-progress-portrait-t5-locked")&&l.classList.remove("tower-progress-portrait-t5-locked"),l.classList.contains("tower-progress-portrait-paragon")&&l.classList.remove("tower-progress-portrait-paragon"),l.classList.contains("tower-progress-portrait-paragon-locked")&&l.classList.remove("tower-progress-portrait-paragon-locked"),l.classList.add(`tower-progress-portrait-${ze.towersInOrder[e].toLowerCase()}`);for(let e of document.getElementsByClassName("upgrade-div"))e.classList.remove("selected");null!=document.getElementById(`${e}-paragon-div`)&&document.getElementById(`${e}-paragon-div`).classList.remove("selected-paragon"),s.src=be(e,a)}function Ca(e,t,a){let l=document.getElementById("tower-progress-portrait"),d=document.getElementById("tower-portrait-name"),s=document.getElementById("tower-progress-portrait-img");if(d.innerHTML=Re(t),a.includes("Paragon")&&!n.acquiredUpgrades[t])return l.classList.add("tower-progress-portrait-paragon-locked"),void(s.src="");l.classList.contains(`tower-progress-portrait-${ze.towersInOrder[e].toLowerCase()}`)&&l.classList.remove(`tower-progress-portrait-${ze.towersInOrder[e].toLowerCase()}`),l.classList.add("tower-progress-portrait-paragon");for(let e of document.getElementsByClassName("upgrade-div"))e.classList.remove("selected");s.src=be(e,a)}function Ea(){let e=document.getElementById("progress-content");e.innerHTML="";let t=document.createElement("div");t.classList.add("tower-progress-container"),e.appendChild(t);let a=document.createElement("div");a.classList.add("hero-progress-div"),t.appendChild(a);let l=document.createElement("div");l.classList.add("hero-selector-header-top"),a.appendChild(l);let d=document.createElement("p");d.classList.add("hero-selector-header-text","black-outline"),d.innerHTML=`Heroes - ${Object.keys(n.unlockedHeros).filter((e=>n.unlockedHeros[e])).length}/${Object.keys(n.unlockedHeros).length}`,l.appendChild(d);let s=document.createElement("p");s.classList.add("hero-selector-header-text","black-outline"),s.innerHTML=`Skins - ${Object.keys(n.unlockedSkins).filter((e=>n.unlockedSkins[e])).length}/${Object.keys(n.unlockedSkins).length}`,l.appendChild(s);let i=document.createElement("div");i.classList.add("hero-selector-header"),a.appendChild(i);for(let[e,t]of Object.entries(ze.heroesInOrder)){let a=document.createElement("div");a.classList.add("hero-selector-div"),n.unlockedHeros[e]||a.classList.add("hero-selector-div-disabled"),a.addEventListener("click",(()=>{n.unlockedHeros[e]&&wa(e,t)})),i.appendChild(a);let l=document.createElement("img");l.classList.add("hero-selector-img"),l.src=ke(e),a.appendChild(l);let d=document.createElement("div");d.id=e+"-selector-highlight",d.classList.add("hero-selector-highlight"),a.appendChild(d)}let o=document.createElement("div");o.id="hero-progress-content",o.classList.add("hero-progress-content"),t.appendChild(o),wa(n.primaryHero,ze.heroesInOrder[n.primaryHero])}function wa(e,t){at=e;let a=document.getElementById("hero-progress-content");a.innerHTML="";let l=document.createElement("div");l.classList.add("hero-progress-container"),a.appendChild(l);let d=document.createElement("div");d.classList.add("hero-progress-top"),l.appendChild(d);let s=document.createElement("div");s.classList.add("hero-progress-header"),d.appendChild(s);let i=document.createElement("img");i.classList.add("hero-progress-trail-fx"),i.src="./Assets/UI/TrailFx.webp",s.appendChild(i);let o=document.createElement("p");o.id="hero-progress-header-text",o.classList.add("hero-progress-header-text"),o.style.backgroundImage=`url('../Assets/UI/${t}TxtTextureMain.webp')`,o.innerHTML=Re(e),s.appendChild(o);let r=document.createElement("p");r.id="hero-progress-header-subtitle",r.classList.add("hero-progress-header-subtitle","subtitle-outline"),r.innerHTML=Re(`${e} Short Description`),s.appendChild(r);let c=document.createElement("div");c.classList.add("hero-progress-middle"),l.appendChild(c);let p=document.createElement("div");p.id="hero-portrait-level-select-btns",p.classList.add("hero-portrait-level-select-btns"),c.appendChild(p),Ta(e);let m=document.createElement("div");m.classList.add("hero-portrait-div"),c.appendChild(m);let u=document.createElement("img");u.id="hero-portrait-img",u.classList.add("hero-portrait-img"),u.src=we(e,1),m.appendChild(u);let h=document.createElement("div");h.classList.add("hero-portrait-bar"),m.appendChild(h);let g=document.createElement("div");g.id="hero-portrait-glow",g.classList.add("hero-portrait-glow"),g.style.background=`radial-gradient(circle, rgb(${255*ze.HeroBGColors[e][0]},${255*ze.HeroBGColors[e][1]},${255*ze.HeroBGColors[e][2]}) 0%, transparent 70%)`,m.appendChild(g);let L=document.createElement("div");L.classList.add("hero-skins-div"),c.appendChild(L),ze.heroSkins[e].forEach((t=>{if(null==n.unlockedSkins[ge[t]||t]&&t!=e)return;let a=document.createElement("img");a.id=`${e}-${t}-skin`,a.classList.add("hero-skin"),a.src=fe(t),0==n.unlockedSkins[ge[t]||t]?a.classList.add("insta-tower-container-none"):a.addEventListener("click",(()=>{let a=ze.HeroBGColors[t]?ze.HeroBGColors[t]:ze.HeroBGColors[e];ul(a),ka(t,e==t),document.getElementById("hero-portrait-glow").style.background=`radial-gradient(circle, rgb(${255*a[0]},${255*a[1]},${255*a[2]}) 0%, transparent 70%)`})),L.appendChild(a)}));let b=document.createElement("div");b.classList.add("hero-progress-bottom"),l.appendChild(b);let y=document.createElement("p");y.id="hero-progress-desc",y.classList.add("hero-progress-desc"),y.innerHTML=Re(`${e} Description`),b.appendChild(y);let v=document.createElement("div");v.classList.add("hero-level-descs"),b.appendChild(v);for(let t=1;t<21;t++){let a=document.createElement("div");a.classList.add("hero-level-desc-div"),v.appendChild(a);let n=document.createElement("div");n.classList.add("hero-level-desc-icon-div"),20==t?n.classList.add("hero-level-desc-image-purple"):ze.heroLevelIcons[e].includes(t)?n.classList.add("hero-level-desc-image-gold"):n.classList.add("hero-level-desc-image"),a.appendChild(n);let l=document.createElement("p");l.classList.add("hero-level-desc-text","black-outline"),l.innerHTML=t,n.appendChild(l);let d=document.createElement("p");d.classList.add("hero-level-desc"),d.innerHTML=Re(`${e} Level ${t} Description`),a.appendChild(d)}for(let e of document.getElementsByClassName("hero-selector-highlight"))e.style.display="none";return document.getElementById(`${e}-selector-highlight`).style.display="block",ul(ze.HeroBGColors[e]),a}function ka(e,t){at=e,document.getElementById("hero-progress-header-subtitle").innerHTML=Re(t?`${e} Short Description`:`${e}SkinName`),document.getElementById("hero-progress-desc").innerHTML=Re(t?`${e} Description`:`${e}SkinDescription`),fa(1),document.body.style.display="none",document.body.offsetHeight,document.body.style.removeProperty("display")}function fa(e){document.getElementById("hero-portrait-img").src=Te(at,e),Ta(at);for(let e of document.getElementsByClassName("hero-level-select-btn"))e.classList.remove("selected-level-btn");document.getElementById(`${e}-level-select-btn`).classList.add("selected-level-btn")}function Ta(e){let t=document.getElementById("hero-portrait-level-select-btns");t.innerHTML="",ze.HeroPortraitLevels[e].forEach((e=>{if("20SunGod"==e&&!n.acquiredUpgrades["True Sun God"])return;if(("20SunGodVengeful"==e||"20SunGodVengful"==e)&&!n.achievementsClaimed.includes("Strangely Adorable"))return;let a=document.createElement("div");a.id=`${e}-level-select-div`,a.classList.add("hero-level-select-div"),t.appendChild(a);let l=document.createElement("div");if(l.id=`${e}-level-select-btn`,l.classList.add("hero-level-select-btn"),a.appendChild(l),"20SunGod"==e||"20SunGodVengeful"==e||"20SunGodVengful"==e){let t=document.createElement("img");t.id=`${e}-level-select-img`,t.classList.add("hero-level-select-img"),t.src="20SunGod"==e?"./Assets/UI/BuffIconTrueSunGod5xx.webp":"./Assets/UI/BuffIconTrueSunGod555.webp",a.appendChild(t)}else{let t=document.createElement("p");t.id=`${e}-level-select-text`,t.classList.add("hero-level-select-text","black-outline"),t.innerHTML=e,a.appendChild(t)}a.addEventListener("click",(()=>{fa(e)}))})),document.getElementById("1-level-select-btn").classList.add("selected-level-btn")}function Ma(){let e=document.getElementById("progress-content");e.innerHTML="";let t=[0,0,0];for(let[e,a]of Object.entries(n.acquiredKnowledge))a?t[0]+=1:ze.RecommendedKnowledge.includes(e)?t[1]+=1:t[2]+=1;let a=document.createElement("div");a.id="knowledge-progress-container",a.classList.add("knowledge-progress-container"),e.appendChild(a);let l=document.createElement("div");l.classList.add("knowledge-progress-container-div"),a.appendChild(l);let d=document.createElement("p");d.classList.add("column-header-text","black-outline"),d.innerHTML=`${t[0]} Unlocked Knowledge Points`,l.appendChild(d);let s=document.createElement("div");s.classList.add("knowledge-progress-div"),l.appendChild(s);let i=document.createElement("div");i.classList.add("knowledge-progress-container-div"),a.appendChild(i);let o=document.createElement("p");o.classList.add("column-header-text","black-outline"),o.innerHTML=`${t[2]+t[1]} Locked Knowledge Points`,i.appendChild(o);let r=document.createElement("div");r.classList.add("knowledge-progress-div"),i.appendChild(r);for(let[e,t]of Object.entries(n.acquiredKnowledge)){if(!Re(e))continue;let a=document.createElement("div");a.classList.add("knowledge-icon-div"),t?s.appendChild(a):r.appendChild(a);let n=document.createElement("div");n.id=`${e}-glow`,a.appendChild(n);let l=document.createElement("img");l.classList.add("knowledge-icon"),l.src=Ee(e),a.appendChild(l),a.addEventListener("click",(()=>{Ia(e),Array.from(document.getElementsByClassName("knowledge-glow")).forEach((e=>{e.classList.remove("knowledge-glow")})),n.classList.add("knowledge-glow")}))}""==r.innerHTML&&(o.style.display="none"),""==s.innerHTML&&(d.style.display="none");let c=document.createElement("div");c.classList.add("tooltip-container-div"),a.appendChild(c);let p=document.createElement("div");p.id="knowledge-progress-floating-tooltip",p.classList.add("knowledge-progress-floating-tooltip"),c.appendChild(p);let m=document.createElement("p");m.id="knowledge-name-text",m.classList.add("knowledge-name-text","black-outline"),p.appendChild(m);let u=document.createElement("p");u.id="knowledge-desc-text",u.classList.add("knowledge-desc-text"),p.appendChild(u)}function Ia(e){document.getElementById("knowledge-progress-floating-tooltip").style.display="block",document.getElementById("knowledge-name-text").innerHTML=Re(e),document.getElementById("knowledge-desc-text").innerHTML=Re(`${e}Description`)}function Ba(){let e=document.getElementById("progress-content");e.innerHTML="";let t=document.createElement("div");t.id="maps-progress-header-bar",t.classList.add("maps-progress-header-bar"),e.appendChild(t);let a=document.createElement("div");a.id="maps-progress-views",a.classList.add("maps-progress-views"),t.appendChild(a);let n=document.createElement("p");n.classList.add("maps-progress-coop-toggle-text","black-outline"),n.innerHTML="Display Type:",a.appendChild(n);let l=document.createElement("div");l.id="maps-progress-game",l.classList.add("maps-progress-view","black-outline"),l.innerHTML="Game",l.addEventListener("click",(()=>{Ha("game")})),a.appendChild(l);let d=document.createElement("div");d.id="maps-progress-grid",d.classList.add("maps-progress-view","black-outline","maps-progress-view-selected"),d.innerHTML="Grid",d.addEventListener("click",(()=>{Ha("grid")})),a.appendChild(d);let s=document.createElement("div");s.id="maps-progress-list",s.classList.add("maps-progress-view","black-outline","maps-progress-view-list"),s.innerHTML="List",s.addEventListener("click",(()=>{Ha("list")})),a.appendChild(s);let i=document.createElement("div");i.classList.add("maps-progress-filter"),t.appendChild(i);let o=document.createElement("div");o.classList.add("map-progress-filter-difficulty"),i.appendChild(o);let r=document.createElement("p");r.classList.add("maps-progress-coop-toggle-text","black-outline"),r.innerHTML="Filter Difficulty:",o.appendChild(r);let c=document.createElement("select");c.id="map-progress-filter-difficulty-select",c.classList.add("map-progress-filter-difficulty-select"),c.addEventListener("change",(()=>{xa(c.value)}));["All","Beginner","Intermediate","Advanced","Expert"].forEach((e=>{let t=document.createElement("option");t.value=e,t.innerHTML=e,c.appendChild(t)})),o.appendChild(c);let p=document.createElement("div");p.classList.add("maps-progress-coop-toggle"),i.appendChild(p);let m=document.createElement("p");m.classList.add("maps-progress-coop-toggle-text","black-outline"),m.innerHTML="Co-op: ",p.appendChild(m);let u=document.createElement("input");u.id="maps-progress-coop-toggle-input",u.classList.add("maps-progress-coop-toggle-input"),u.type="checkbox",u.addEventListener("change",(()=>{Sa(u.checked)})),p.appendChild(u);let h=document.createElement("div");h.id="maps-progress-container",h.classList.add("maps-progress-container"),e.appendChild(h);let g=document.createElement("div");g.id="map-progress-container",g.classList.add("map-progress-container"),g.style.display="none",e.appendChild(g),Ha("game")}function Ha(e){switch(dt=e,e){case"grid":document.getElementById("maps-progress-grid").classList.add("stats-tab-yellow"),document.getElementById("maps-progress-list").classList.remove("stats-tab-yellow"),document.getElementById("maps-progress-game").classList.remove("stats-tab-yellow"),document.getElementById("maps-progress-header-bar").classList.add("border-top-only"),Oa();break;case"list":document.getElementById("maps-progress-grid").classList.remove("stats-tab-yellow"),document.getElementById("maps-progress-list").classList.add("stats-tab-yellow"),document.getElementById("maps-progress-game").classList.remove("stats-tab-yellow"),document.getElementById("maps-progress-header-bar").classList.add("border-top-only"),Ra();break;case"game":document.getElementById("maps-progress-grid").classList.remove("stats-tab-yellow"),document.getElementById("maps-progress-list").classList.remove("stats-tab-yellow"),document.getElementById("maps-progress-game").classList.add("stats-tab-yellow"),document.getElementById("maps-progress-header-bar").classList.remove("border-top-only"),Ua()}}function Sa(e){switch(st=e,document.getElementById("maps-progress-coop-toggle-input").checked=e,dt){case"grid":Oa();break;case"list":Ra();break;case"game":Ua()}}function xa(e){switch(it=e,dt){case"grid":Oa();break;case"list":Ra();break;case"game":Ua()}}function Aa(e){document.getElementById("maps-progress-container").style.display="none",document.getElementById("maps-progress-header-bar").style.display="none",document.getElementById("map-progress-container").style.display="flex",gl(),Da(e)}function Pa(){document.getElementById("map-progress-container").style.display="none",document.getElementById("maps-progress-header-bar").style.display="flex",document.getElementById("maps-progress-container").style.display="block"}function Da(e){let t=document.getElementById("map-progress-container");t.innerHTML="";let a=document.createElement("div");a.classList.add("single-map-progress-header-bar"),t.appendChild(a);let l=document.createElement("div");l.classList.add("map-next-and-prev"),a.appendChild(l);let d=document.createElement("div");d.classList.add("maps-progress-view","black-outline"),d.innerHTML="Previous",d.addEventListener("click",(()=>{let t=Object.keys(ze.mapsInOrder).filter((e=>Object.keys(n.mapProgress).includes(e)));0==t.indexOf(e)?Aa(t[t.length-1]):Aa(t[t.indexOf(e)-1])})),l.appendChild(d);let s=document.createElement("div");s.classList.add("maps-progress-view","black-outline"),s.innerHTML="Next",s.addEventListener("click",(()=>{let t=Object.keys(ze.mapsInOrder).filter((e=>Object.keys(n.mapProgress).includes(e)));t.indexOf(e)==t.length-1?Aa(t[0]):Aa(t[t.indexOf(e)+1])})),l.appendChild(s);let i=document.createElement("img");i.classList.add("modal-close"),i.src="./Assets/UI/CloseBtn.webp",i.addEventListener("click",(()=>{Pa()})),a.appendChild(i);let o=document.createElement("div");o.classList.add("map-below-header-bar"),t.appendChild(o);let r=document.createElement("div");r.classList.add("map-left-column"),o.appendChild(r);let c=document.createElement("div");c.classList.add("map-progress-div"),r.appendChild(c);let p=document.createElement("div");p.classList.add("map-name-top"),c.appendChild(p);let m=document.createElement("img");m.classList.add("map-difficulty-icon"),m.src=`./Assets/DifficultyIcon/Map${ze.mapsInOrder[e]}Btn.webp`,p.appendChild(m);let u=document.createElement("div");u.classList.add("map-name-and-medals"),p.appendChild(u);let h=document.createElement("p");h.classList.add("map-name-large","black-outline"),h.innerHTML=Re(e),u.appendChild(h);let g=document.createElement("div");g.classList.add("map-progress-subtext"),g.innerHTML=`${Object.values(et.Medals.single[e]).filter((e=>1==e)).length}/15 Single Player Medals`,u.appendChild(g);let L=document.createElement("div");L.classList.add("map-progress-subtext"),L.innerHTML=`${Object.values(et.Medals.coop[e]).filter((e=>1==e)).length}/15 Coop Medals`,u.appendChild(L);let b=document.createElement("img");b.classList.add("map-icon"),b.src=Me(e),c.appendChild(b);let y=document.createElement("div");switch(y.classList.add("map-progress-medals"),r.appendChild(y),et.Borders.single[e]){case"None":y.classList.add("none-border");break;case"Bronze":y.classList.add("bronze-border");break;case"Silver":y.classList.add("silver-border");break;case"Gold":y.classList.add("gold-border");break;case"Black":y.classList.add("black-border")}for(let[t,a]of Object.entries(et.Medals.single[e])){if(null==a)continue;let n=document.createElement("div");n.classList.add("medal-div"),y.appendChild(n);let l=document.createElement("img");l.classList.add("medal-img"),l.src=Se(a?`Medal${he[t]}`:"MedalEmpty"),"Black"==et.Borders.single[e]&&l.classList.add("medal-glow"),l.style.display="none",l.addEventListener("load",(()=>{l.width<l.height?l.style.width=`${hl(3,70,256,0,l.width)}px`:l.style.height=`${hl(3,70,256,0,l.height)}px`,l.style.removeProperty("display")})),n.appendChild(l)}let v=document.createElement("div");v.classList.add("map-progress-medals"),r.appendChild(v);for(let[t,a]of Object.entries(et.Medals.coop[e])){if(null==a)continue;let n=document.createElement("div");n.classList.add("medal-div"),v.appendChild(n);let l=document.createElement("img");l.classList.add("medal-img"),l.src=Se(a?`Medal${he[t]}`:"MedalCoopEmpty"),l.style.display="none","Black"==et.Borders.coop[e]&&l.classList.add("medal-glow"),l.addEventListener("load",(()=>{l.width<l.height?l.style.width=`${hl(3,70,256,0,l.width)}px`:l.style.height=`${hl(3,70,256,0,l.height)}px`,l.style.removeProperty("display")})),n.appendChild(l)}switch(et.Borders.coop[e]){case"None":v.classList.add("coop-border");break;case"Bronze":v.classList.add("bronze-border");break;case"Silver":v.classList.add("silver-border");break;case"Gold":v.classList.add("gold-border");break;case"Black":v.classList.add("black-border")}let C=document.createElement("div");C.classList.add("map-right-column"),o.appendChild(C);let E=document.createElement("div");E.classList.add("right-column-header"),C.appendChild(E);let w=document.createElement("p");w.classList.add("column-header-text","black-outline"),w.innerHTML="Mode Stats",E.appendChild(w);let k=document.createElement("div");k.classList.add("maps-progress-coop-toggle"),E.appendChild(k);let f=document.createElement("p");f.classList.add("maps-progress-coop-toggle-text","black-outline"),f.innerHTML="Co-op: ",k.appendChild(f);let T=document.createElement("input");T.id="maps-progress-coop-toggle-input",T.classList.add("maps-progress-coop-toggle-input"),T.type="checkbox",T.addEventListener("change",(()=>{Sa(T.checked),$a(e,st)})),T.checked=st,k.appendChild(T);let M=document.createElement("div");M.id="map-stats-container",M.classList.add("map-stats-container"),C.appendChild(M),$a(e,st)}function $a(e,t){let a=document.getElementById("map-stats-container");a.innerHTML="";for(let[n,l]of Object.entries(t?et.Maps[e].coop:et.Maps[e].single)){if(null==l)continue;let e=document.createElement("div");e.classList.add("map-stats-div"),a.appendChild(e);let t=document.createElement("img");t.classList.add("map-stats-icon"),t.src=xe(n),e.appendChild(t);let d=document.createElement("div");d.classList.add("map-stats-text-div"),e.appendChild(d);let s=document.createElement("p");s.classList.add("map-stats-text-mode","black-outline"),s.innerHTML=Re(`Mode ${n}`),d.appendChild(s);let i=document.createElement("p");i.classList.add("map-stats-text"),i.innerHTML=`Times Completed: ${l.timesCompleted}`,d.appendChild(i);let o=document.createElement("p");o.classList.add("map-stats-text"),o.innerHTML=`Best Round: ${l.bestRound}`,d.appendChild(o)}if(""==a.innerHTML){let e=document.createElement("p");e.classList.add("no-data-found","black-outline"),e.innerHTML="No Data Found.",a.appendChild(e)}}function Oa(){let e=document.getElementById("maps-progress-container");e.innerHTML="";let t=document.createElement("div");t.classList.add("maps-grid-container"),e.appendChild(t);for(let[e,a]of Object.entries(ze.mapsInOrder)){if(null==et.Borders[st?"coop":"single"][e])continue;if("All"!=it&&a!=it)continue;let n=document.createElement("div");switch(n.classList.add("map-div"),et.Borders[st?"coop":"single"][e]){case"None":st?n.classList.add("coop-border"):n.classList.add("none-border");break;case"Bronze":n.classList.add("bronze-border");break;case"Silver":n.classList.add("silver-border");break;case"Gold":n.classList.add("gold-border");break;case"Black":n.classList.add("black-border")}t.appendChild(n);let l=document.createElement("img");l.classList.add("map-img"),l.src=Me(e),n.appendChild(l);let d=document.createElement("p");d.classList.add("map-name","black-outline"),d.innerHTML=Re(e),n.appendChild(d);let s=document.createElement("div");s.classList.add("map-progress"),n.appendChild(s),n.addEventListener("click",(()=>{Aa(e)}))}}function Ra(){let e=document.getElementById("maps-progress-container");e.innerHTML="";let t=document.createElement("div");t.classList.add("maps-list-container"),e.appendChild(t);let a=document.createDocumentFragment(),n=!1;for(let[e,t]of Object.entries(ze.mapsInOrder)){if(!l.parameters.mapProgress.default.allowed.includes(e))continue;if(null==et.Borders[st?"coop":"single"][e])continue;if("All"!=it&&t!=it)continue;if(Object.entries(st?et.Maps[e].coop:et.Maps[e].single).every((([e,t])=>null==t)))continue;let d=document.createElement("div");d.classList.add("map-container"),d.style.backgroundColor=n?"var(--profile-secondary)":"var(--profile-tertiary)",n=!n,a.appendChild(d);let s=document.createElement("div");switch(s.classList.add("map-div"),et.Borders[st?"coop":"single"][e]){case"None":st?s.classList.add("coop-border"):s.classList.add("none-border");break;case"Bronze":s.classList.add("bronze-border");break;case"Silver":s.classList.add("silver-border");break;case"Gold":s.classList.add("gold-border");break;case"Black":s.classList.add("black-border")}d.appendChild(s);let i=document.createElement("img");i.classList.add("map-img"),i.src=Me(e),s.appendChild(i);let o=document.createElement("p");o.classList.add("map-name","black-outline"),o.innerHTML=Re(e),s.appendChild(o);let r=document.createElement("div");r.classList.add("map-sections"),d.appendChild(r);let c=document.createElement("div");c.classList.add("map-section"),r.appendChild(c);let p=document.createElement("p");p.classList.add("map-label-medals","black-outline"),c.appendChild(p);let m=document.createElement("p");m.classList.add("map-label-rounds","black-outline"),m.innerHTML="Best Round:",c.appendChild(m);let u=document.createElement("p");u.classList.add("map-label-completed","black-outline"),u.innerHTML="Times Completed:",c.appendChild(u);for(let[t,a]of Object.entries(st?et.Maps[e].coop:et.Maps[e].single)){if(null==a)continue;let e=document.createElement("div");e.classList.add("map-section-column"),r.appendChild(e);let n=document.createElement("div");n.classList.add("map-section-medal"),e.appendChild(n);let l=document.createElement("img");l.classList.add("map-section-medal-img"),l.src=Se("Clicks"==t&&a.completedWithoutLoadingSave?`Medal${st?"Coop":""}${he["CHIMPS-BLACK"]}`:`Medal${st?"Coop":""}${he[t]}`),l.style.display="none",!a.completed&&a.bestRound<ze.endRound[t]&&!a.completedWithoutLoadingSave&&(l.style.filter="brightness(0.5)"),l.addEventListener("load",(()=>{l.width<l.height?l.style.width=`${hl(3,70,256,0,l.width)}px`:l.style.height=`${hl(3,70,256,0,l.height)}px`,l.style.removeProperty("display")})),n.appendChild(l);let d=document.createElement("p");d.classList.add("map-section-text","black-outline"),d.innerHTML=a.bestRound,e.appendChild(d);let s=document.createElement("p");s.classList.add("map-section-text","black-outline"),s.innerHTML=a.timesCompleted,e.appendChild(s)}s.addEventListener("click",(()=>{Aa(e)}))}t.appendChild(a)}function Ua(){let e=document.getElementById("maps-progress-container");e.innerHTML="";let t=document.createElement("div");t.classList.add("maps-game-container"),e.appendChild(t);let a=Object.keys(ze.mapsInOrder).filter((e=>Object.keys(n.mapProgress).includes(e)));"All"!=it&&(a=a.filter((e=>ze.mapsInOrder[e]==it)));let l=Math.ceil(a.length/6)-1;ot>l&&(ot=0),ot<0&&(ot=l);let d=a.slice(6*ot,6*ot+6),s=document.createElement("div");s.classList.add("map-arrow"),t.appendChild(s);let i=document.createElement("img");i.classList.add("map-arrow-img"),i.src="./Assets/UI/PrevArrow.webp",s.appendChild(i);let o=document.createElement("div");o.classList.add("maps-game-grid"),t.appendChild(o);for(let e of d){let t=document.createElement("div");switch(t.classList.add("map-div-ingame"),et.Borders[st?"coop":"single"][e]){case"None":st?t.classList.add("coop-border"):t.classList.add("none-border");break;case"Bronze":t.classList.add("bronze-border");break;case"Silver":t.classList.add("silver-border");break;case"Gold":t.classList.add("gold-border");break;case"Black":t.classList.add("black-border")}o.appendChild(t);let a=document.createElement("img");a.classList.add("map-img-ingame"),a.src=Me(e),t.appendChild(a);let n=document.createElement("p");n.classList.add("map-name","black-outline"),n.innerHTML=Re(e),t.appendChild(n);for(let[a,n]of st?Object.entries(et.Medals.coop[e]):Object.entries(et.Medals.single[e])){if(null==n)continue;let e=document.createElement("div");["Easy","Medium","Hard","Impoppable"].includes(a)?e.classList.add("medal-div-large"):e.classList.add("medal-div-small"),e.classList.add(`medal-div-${a.toLowerCase()}`),t.appendChild(e);let l=document.createElement("img");l.classList.add("medal-img"),l.src=Se(n?`Medal${he[a]}`:"MedalEmpty"),n||l.classList.add("medal-div-unobtained"),l.style.display="none",l.addEventListener("load",(()=>{l.width<l.height?l.style.width=`${hl(3,70,256,0,l.width)}px`:l.style.height=`${hl(3,70,256,0,l.height)}px`,l.style.removeProperty("display")})),e.appendChild(l)}t.addEventListener("click",(()=>{Aa(e)}))}let r=document.createElement("div");r.classList.add("map-arrow"),t.appendChild(r);let c=document.createElement("img");c.classList.add("map-arrow-img"),c.src="./Assets/UI/NextArrow.webp",r.appendChild(c),s.addEventListener("click",(()=>{ot--,Ua()})),r.addEventListener("click",(()=>{ot++,Ua()}));let p=document.createElement("div");p.classList.add("map-page-dots"),e.appendChild(p);for(let e=0;e<=l;e++){let t=document.createElement("div");t.classList.add("map-page-dot"),e==ot&&t.classList.add("map-page-dot-active"),p.appendChild(t),t.addEventListener("click",(()=>{ot=e,Ua()}))}}function Ga(){let e=document.getElementById("progress-content");e.innerHTML="";let t=document.createElement("div");t.classList.add("powers-progress-container"),e.appendChild(t);for(let[e,a]of Object.entries(n.powers)){let n=document.createElement("div");n.classList.add("power-div"),t.appendChild(n);let l=document.createElement("img");l.classList.add("power-img"),l.src=Ie(e),n.appendChild(l);let d=document.createElement("p");d.classList.add("power-name","black-outline"),d.innerHTML=Re(e),n.appendChild(d);let s=document.createElement("div");s.classList.add("power-progress"),n.appendChild(s);let i=document.createElement("p");i.classList.add("power-progress-text","black-outline"),i.innerHTML=`${a.quantity||0}`,s.appendChild(i)}}function Na(){let e=document.getElementById("progress-content");e.innerHTML="";let t=document.createElement("div");t.classList.add("insta-monkeys-header-bar"),e.appendChild(t);let a=document.createElement("div");a.classList.add("maps-progress-views"),t.appendChild(a);let n=document.createElement("p");n.classList.add("maps-progress-coop-toggle-text","black-outline"),n.classList.add("black-outline"),n.innerHTML="View Inventory:",a.appendChild(n);let l=document.createElement("div");l.id="insta-monkeys-game-view",l.classList.add("maps-progress-view","black-outline"),l.innerHTML="Game",l.addEventListener("click",(()=>{rt="game",ja(t,rt)})),a.appendChild(l);let d=document.createElement("div");d.id="insta-monkeys-list-view",d.classList.add("maps-progress-view","black-outline"),d.innerHTML="List",d.addEventListener("click",(()=>{rt="list",ja(t,rt)})),a.appendChild(d);let s=document.createElement("div");s.classList.add("maps-progress-views"),t.appendChild(s);let i=document.createElement("div");i.id="insta-monkeys-obtain-view",i.classList.add("maps-progress-view","black-outline"),i.innerHTML="Get More",i.addEventListener("click",(()=>{rt="obtain",ja(t,rt)})),s.appendChild(i);let o=document.createElement("div");o.id="insta-monkeys-collection-view",o.classList.add("maps-progress-view","black-outline"),o.innerHTML="Collection Event",o.addEventListener("click",(()=>{rt="collection",ja(t,rt)})),s.appendChild(o);let r=document.createElement("div");r.id="insta-monkeys-progress-container",r.classList.add("insta-monkeys-progress-container"),e.appendChild(r);let c=document.createElement("div");c.id="insta-monkey-progress-container",c.classList.add("insta-monkey-progress-container"),c.style.display="none",e.appendChild(c),ja(t,rt)}function ja(e,t){document.getElementById("insta-monkeys-progress-container").style.removeProperty("display"),document.getElementById("insta-monkey-progress-container").style.display="none";switch(["game","list","obtain","collection"].forEach((e=>{document.getElementById(`insta-monkeys-${e}-view`).classList.remove("stats-tab-yellow")})),document.getElementById(`insta-monkeys-${t}-view`).classList.add("stats-tab-yellow"),t){case"game":e.classList.remove("border-top-only"),Fa();break;case"list":e.classList.remove("border-top-only"),Ya();break;case"obtain":e.classList.add("border-top-only"),Ja();break;case"collection":e.classList.add("border-top-only"),Qa()}}function Fa(){let e=document.getElementById("insta-monkeys-progress-container");e.innerHTML="";let t=document.createElement("div");t.classList.add("insta-monkey-game-container"),e.appendChild(t);let a=document.createElement("div");a.classList.add("towers-container"),t.appendChild(a);let l=[],d=[];Object.keys(ze.towersInOrder).forEach((e=>{Object.keys(n.unlockedTowers).includes(e)&&(void 0!==ut.TowerTotal[e]?l.push(e):d.push(e))})),l.concat(d).forEach((e=>{let t=document.createElement("div");t.classList.add("tower-container"),t.style.backgroundImage=`url(./Assets/UI/InstaTowersContainer${ut.TowerBorders[e]||""}.webp)`,t.addEventListener("click",(()=>{_a(e)})),a.appendChild(t);let n=document.createElement("img");n.classList.add("tower-img"),n.src=ye(e,"000"),t.appendChild(n);let l=document.createElement("p");if(l.classList.add("tower-name","black-outline"),l.innerHTML=Re(e),t.appendChild(l),null!=ut.TowerTotal[e]){let a=document.createElement("p");a.classList.add("insta-progress"),t.appendChild(a);let n=document.createElement("p");n.classList.add("power-progress-text","black-outline"),n.innerHTML=ut.TowerTotal[e]||0,a.appendChild(n)}else t.classList.add("insta-tower-container-none")}))}function _a(e){document.getElementById("insta-monkeys-progress-container").style.display="none",document.getElementById("insta-monkey-progress-container").style.display="flex",qa(e)}function qa(e){let t=document.getElementById("insta-monkey-progress-container");t.innerHTML="";let a=document.createElement("div");t.appendChild(a);let n=document.createElement("div");n.classList.add("insta-monkey-top-bar"),a.appendChild(n);let l=document.createElement("div");l.classList.add("insta-arrow"),l.addEventListener("click",(()=>{Wa(e)})),n.appendChild(l);let d=document.createElement("img");d.classList.add("map-arrow-img"),d.src="./Assets/UI/PrevArrow.webp",l.appendChild(d);let s=document.createElement("div");switch(s.classList.add("insta-monkey-header-div"),ut.TowerBorders[e]){case"Gold":s.classList.add("insta-topbar-gold");break;case"Black":s.classList.add("insta-topbar-black")}n.appendChild(s);let i=document.createElement("div");i.classList.add("insta-arrow"),i.addEventListener("click",(()=>{Va(e)})),n.appendChild(i);let o=document.createElement("img");o.classList.add("map-arrow-img"),o.src="./Assets/UI/NextArrow.webp",i.appendChild(o);let r=document.createElement("div");r.classList.add("maps-progress-coop-toggle"),s.appendChild(r);let c=document.createElement("p");c.classList.add("maps-progress-coop-toggle-text","black-outline"),c.innerHTML="Missing: ",r.appendChild(c);let p=document.createElement("input");p.classList.add("insta-progress-missing-toggle-input","MkOffRed"),p.type="checkbox",p.addEventListener("change",(()=>{za(p.checked)})),p.checked=ct,r.appendChild(p);let m=document.createElement("p");m.classList.add("insta-monkey-name","black-outline"),m.innerHTML=Re(e),s.appendChild(m);let u=document.createElement("div");u.classList.add("insta-monkey-progress"),s.appendChild(u);let h=document.createElement("p");h.classList.add("insta-monkey-progress-text","black-outline"),h.innerHTML=`${ut.TowerTierTotals[e]?Object.values(ut.TowerTierTotals[e]).reduce(((e,t)=>e+t),0):0}/64`,u.appendChild(h);let g=document.createElement("div");g.id=`${e}-main-container`,g.classList.add("insta-monkey-main-container"),a.appendChild(g),Ka(e),za(p.checked)}function Ka(e){let t=document.getElementById(`${e}-main-container`);t.innerHTML="";let a=document.createElement("div");a.classList.add("insta-monkey-icons-container"),t.appendChild(a),ze.collectionOrder.forEach((t=>{let l=document.createElement("div");if(l.classList.add("insta-monkey-tier-container"),n.instaTowers.hasOwnProperty(e)&&n.instaTowers[e][t]||(l.style.display="none",l.classList.add("insta-monkey-unobtained")),a.appendChild(l),n.instaTowers.hasOwnProperty(e)&&n.instaTowers[e][t]>1){let a=document.createElement("p");a.classList.add("insta-progress","insta-tier-scale"),l.appendChild(a);let d=document.createElement("p");d.classList.add("power-progress-text","black-outline"),d.innerHTML=n.instaTowers[e][t],a.appendChild(d)}let d=document.createElement("img");d.classList.add("insta-monkey-tier-img"),d.src=n.instaTowers.hasOwnProperty(e)&&null!=n.instaTowers[e][t]?ve(e,t):"./Assets/UI/InstaUncollected.webp",l.appendChild(d),n.instaTowers.hasOwnProperty(e)&&0==n.instaTowers[e][t]&&d.classList.add("upgrade-after-locked");let s=document.createElement("p");s.classList.add("insta-monkey-tier-text","black-outline"),s.innerHTML=`${t[0]}-${t[1]}-${t[2]}`,l.appendChild(s)}))}function za(e){ct=e;for(let e of document.getElementsByClassName("insta-monkey-unobtained"))e.style.display=ct?"block":"none"}function Wa(e){let t=Object.keys(ze.towersInOrder),a=t.indexOf(e);0==a?a=t.length-1:a--,_a(t[a])}function Va(e){let t=Object.keys(ze.towersInOrder),a=t.indexOf(e);a==t.length-1?a=0:a++,_a(t[a])}function Ya(){let e=document.getElementById("insta-monkeys-progress-container");e.innerHTML="";let t=document.createElement("div");t.classList.add("insta-monkeys-list-container"),e.appendChild(t);let a=document.createElement("div");a.classList.add("insta-monkeys-list"),t.appendChild(a),Object.keys(ze.towersInOrder).forEach((e=>{if(null==ut.TowerTierTotals[e])return;let t=document.createElement("div");switch(t.classList.add("insta-monkey-div"),a.appendChild(t),ut.TowerBorders[e]){case"Gold":t.classList.add("insta-list-gold");break;case"Black":t.classList.add("insta-list-black")}let n=document.createElement("div");n.classList.add("tower-container"),n.style.backgroundImage=`url(./Assets/UI/InstaTowersContainer${ut.TowerBorders[e]||""}.webp)`,n.addEventListener("click",(()=>{_a(e)})),t.appendChild(n);let l=document.createElement("img");l.classList.add("tower-img"),l.src=ye(e,"000"),n.appendChild(l);let d=document.createElement("p");d.classList.add("tower-name","black-outline"),d.innerHTML=Re(e),n.appendChild(d);let s=document.createElement("div");s.classList.add("insta-monkey-top-bottom"),t.appendChild(s);let i=document.createElement("div");i.classList.add("insta-monkey-progress-list"),s.appendChild(i);let o=document.createElement("div");o.classList.add("insta-monkey-total"),i.appendChild(o);let r=document.createElement("p");r.classList.add("insta-monkey-progress-label-text","black-outline"),r.innerHTML="Usable Instas:",o.appendChild(r);let c=document.createElement("p");c.classList.add("insta-monkey-total-text","black-outline"),c.innerHTML=ut.TowerTotal[e],o.appendChild(c);let p=document.createElement("div");p.classList.add("insta-monkey-tier-progress"),i.appendChild(p);let m=document.createElement("p");m.classList.add("insta-monkey-progress-label-text","black-outline"),m.innerHTML="Unique Instas:",p.appendChild(m);let u=document.createElement("p");u.classList.add("insta-monkey-progress-text","black-outline"),u.innerHTML=`${Object.values(ut.TowerTierTotals[e]).reduce(((e,t)=>e+t),0)}/64`,p.appendChild(u);let h=document.createElement("div");h.classList.add("insta-monkey-tiers-container"),s.appendChild(h);let g=document.createElement("p");g.classList.add("insta-monkey-tiers-label","black-outline"),g.innerHTML="Unique By Tier:",h.appendChild(g);for(let[t,a]of Object.entries(ut.TowerTierTotals[e])){let e=document.createElement("div");e.classList.add("insta-monkey-tier-div"),h.appendChild(e);let n=document.createElement("p");n.classList.add("insta-monkey-tier-text-list",`insta-tier-text-${t}`,"5"==t?"t5-insta-outline":"black-outline"),e.style.backgroundImage=`url(./Assets/UI/InstaTier${t}Container.webp)`,n.innerHTML=`${a}/${ze.instaTiers[t].length}`,e.appendChild(n)}}))}function Ja(){let e=document.getElementById("insta-monkeys-progress-container");e.innerHTML="";let t=document.createElement("div");t.classList.add("insta-monkeys-obtain-guide"),e.appendChild(t);let a=document.createElement("p");a.classList.add("insta-monkeys-guide-title-text","black-outline"),a.innerHTML="Where To Get More Insta Monkeys",t.appendChild(a);let n={Collection:{name:"Collection Events",desc:"Collection events are the main way to get Insta Monkeys. They usually happen around holidays. During the event, collect as much of the event currency as possible to open crates that contain random Insta Monkeys. You can use the Collection Event tab to help you view the odds of getting a new Insta Monkey from each of the chest types."},Daily:{name:"Daily Challenges",desc:"Daily Challenges often have random Insta Monkeys ranging from T1 to T3 as a reward. Coop Daily Challenges also give a random T1-T3 Insta Monkey. During a Collection event, these will give event currency for opening Insta Monkey chests."},Boss:{name:"Boss Events",desc:"Boss events happen every week. Defeating the Tier 4 and Tier 5 bosses in these events give random Insta Monkeys. The Normal Boss rewards include a T2 and T3 Insta Monkey, and the Elite Boss rewards include a T3 and T4 Insta Monkey."},Odyssey:{name:"Odyssey Events",desc:"Odyssey events give Insta Monkeys for completing the event and opening the chest. Medium difficulty usually gives a predetermined T3 Insta, and Hard gives a predetermined T4 Insta. During Collection events, Odysseys will give collection event currency instead for Insta Monkey chests."},Ranked:{name:"Ranked Events",desc:"Ranked events give random Insta Monkeys depending on your leaderboard placement. You can view Races, Bosses, and Contested Territory leaderboard rewards at the bottom right of the leaderboard. There is also a Mini Leaderboard for each event which gives extra rewards including Insta Monkeys."},R100:{name:"100 Rounds Rewards",desc:"Every 100 rounds you complete in a game, you get a random Insta Monkey. The tier of the Insta Monkey is dependent on the difficulty of the map. Beginner gives T0-T2, Intermediate gives T1-T3, Advanced gives T2-T4, Expert gives T3-T4. Round 200 and beyond also guarantees T3-T4 regardless of difficulty."},Chest:{name:"Daily Chest",desc:"The daily chest gives a random Insta Monkey on some days. The tiers range from T1-T4."},Shop:{name:"Shop",desc:"Need more Instas? The shop has some Insta packs you can purchase."}},l=document.createElement("div");l.classList.add("insta-monkey-guide-container"),t.appendChild(l),Object.keys(n).forEach((e=>{let t=document.createElement("div");t.classList.add("insta-monkey-guide-method"),l.appendChild(t);let a=document.createElement("div");a.classList.add("insta-monkey-guide-text-div"),t.appendChild(a);let d=document.createElement("p");d.classList.add("insta-monkey-guide-method-text","black-outline"),d.innerHTML=n[e].name,a.appendChild(d);let s=document.createElement("p");s.classList.add("insta-monkey-guide-method-desc"),s.innerHTML=n[e].desc,a.appendChild(s);let i=document.createElement("img");i.classList.add("insta-monkey-guide-method-img"),i.src=`./Assets/UI/Obtain${e}.webp`,t.appendChild(i)}))}function Za(){let e=document.createElement("div");e.classList.add("error-modal-overlay"),document.body.appendChild(e);let t=document.createElement("div");t.classList.add("collection-modal"),e.appendChild(t);let a=document.createElement("div");a.classList.add("collection-modal-header"),t.appendChild(a);let n=document.createElement("div");n.classList.add("collection-header-modal-left"),a.appendChild(n);let l=document.createElement("p");l.classList.add("collection-modal-header-text","black-outline"),l.innerHTML="Standard Chest Base Odds",a.appendChild(l);let d=document.createElement("img");d.classList.add("collection-modal-close"),d.src="./Assets/UI/CloseBtn.webp",d.addEventListener("click",(()=>{e.remove()})),a.appendChild(d);let s=document.createElement("p");s.classList.add("collection-desc-text"),s.innerHTML="These are the standard odds. Certain events may change these, but they will be updated to be accurate when I update the site. Accurate as of 8/30/2024",t.appendChild(s);let i=document.createElement("div");i.classList.add("modal-help-divs"),t.appendChild(i),Object.entries(ze.collection.crateRewards.instaMonkey).forEach((([e,t])=>{let a=document.createElement("div");a.classList.add("chest-container"),i.appendChild(a);let n=document.createElement("img");n.classList.add("collection-event-chest-selector"),n.src=`./Assets/UI/EventMysteryBox${xt[e]}Icon.webp`,a.appendChild(n);let l=document.createElement("div");l.classList.add("chest-tier-div"),a.appendChild(l),Object.entries(t.tierChance).forEach((([e,t])=>{let a=document.createElement("div");a.classList.add("tier-container"),l.appendChild(a);let n=document.createElement("img");n.classList.add("insta-monkey-tier-img"),n.src=`./Assets/UI/InstaRandomTier${e}.webp`,a.appendChild(n);let d=document.createElement("p");d.classList.add("tier-text","black-outline"),d.innerHTML=`${(100*t).toFixed(2)}%`,a.appendChild(d)}));let d=document.createElement("div");d.classList.add("chest-quantity-div"),a.appendChild(d),Object.entries(t.quantityChance).forEach((([e,t])=>{let a=document.createElement("div");a.classList.add("quantity-container"),d.appendChild(a);let n=document.createElement("div");n.classList.add("insta-icon-div"),a.appendChild(n);let l=document.createElement("img");l.classList.add("insta-quantity-icon"),l.src="./Assets/UI/InstaIcon.webp",n.appendChild(l);let s=document.createElement("p");s.classList.add("bloon-group-number","black-outline"),s.innerHTML=`X${e}`,n.appendChild(s);let i=document.createElement("p");i.classList.add("quantity-text","black-outline"),i.innerHTML=100*t+"%",a.appendChild(i)}))}))}function Xa(){let e=document.createElement("div");e.classList.add("error-modal-overlay"),document.body.appendChild(e);let t=document.createElement("div");t.classList.add("collection-modal"),e.appendChild(t);let a=document.createElement("div");a.classList.add("collection-modal-header"),t.appendChild(a);let n=document.createElement("div");n.classList.add("collection-header-modal-left"),a.appendChild(n);let l=document.createElement("p");l.classList.add("collection-modal-header-text","black-outline"),l.innerHTML="How to Use This Helper",a.appendChild(l);let d=document.createElement("img");d.classList.add("collection-modal-close"),d.src="./Assets/UI/CloseBtn.webp",d.addEventListener("click",(()=>{e.remove()})),a.appendChild(d);let s=document.createElement("div");s.classList.add("modal-help-divs"),t.appendChild(s);Object.entries({"What is a Collection Event?":"These are events that occur approximately every other month (usually around holidays) that allow you to earn some form of currency that count towards unlocking Insta Monkey chests. This is the best way for collectors to work on their Insta Monkey collection.","What is a Featured Insta?":"Every 8 hours, a rotating select rotation of 4 Featured Insta Monkeys are available to select in collection events. Selecting a Featured Insta Monkey in-game will guarantee that Insta Monkeys recieved from the chest are of that tower type.","What does this helper do?":"When opening chests, how do you know which Featured Insta Monkey is best to pick to have the highest chance of getting a new Insta Monkey for your collection? This helps you choose what to pick, read below to learn how.","Start by Selecting a Chest":"Choose your current Collection Event chest type to set the type of chest to calculate the odds for.","Choose a Featured Insta Monkey (Optional)":"If you choose a featured Insta Monkey below the chests, you will see the odds by tier and total chance for that Insta Monkey. Select the same one again to go back to All Towers.","Entering Obtained Insta Monkeys":"At the bottom of selecting a featured Insta, you can see the missing Instas. Click on an Insta that you were missing to mark it as obtained manually until the API updates (takes at most 15 minutes).","All Towers":"All Towers displays the chances of getting a new Insta Monkey relative to your entire collection in the selected chest as well as a combined list of all the chances you will see when selecting each Featured Insta.","Featured Insta Odds List":"This is a great way to see which Featured Insta Monkey will be more likely to get a new Insta Monkey for your current chest type, including if it's better to let it go completely random with none selected!","How are the chances calculated?":"The chances are calculated by first taking how likely a specific Insta is out of random Insta Tier roll, and then multiplying it by the chest's likelihood of getting that random tier as a roll. This chance is for each individual roll of an Insta, and does not account for the varying quantities of Instas in chests. For example, using this sample Monkey Sub information, we can calculate how likely getting a missing Tier 2 is from a Silver Chest by first taking the chance of rolling that Insta Monkey when rolling a Tier 2 Insta from the chest, and then multiplying it by the chance of getting a Tier 2 Insta from the chest. In reality, this is 1/12 * 40% which is equivalent to 3.33%."}).forEach((([e,t],a)=>{let n=document.createElement("div");n.classList.add("modal-help-div"),s.appendChild(n);let l=document.createElement("p");l.classList.add("collection-header-title-text","black-outline"),l.innerHTML=e,n.appendChild(l);let d=document.createElement("p");d.classList.add("collection-desc-text"),d.innerHTML=t,n.appendChild(d);let i=document.createElement("img");i.classList.add("collection-help-img"),i.src=`./Assets/UI/CollectionHelp${a+1}.webp`,n.appendChild(i)}))}function Qa(){let e=document.getElementById("insta-monkeys-progress-container");e.innerHTML="",It="None";let t=document.createElement("div");t.classList.add("insta-monkey-collection-container"),e.appendChild(t);let a=document.createElement("p");a.classList.add("collection-header-title-text","black-outline"),a.innerHTML="New Insta Monkey Chances",t.appendChild(a);let l=document.createElement("div");l.classList.add("insta-monkey-collection-top-btns"),t.appendChild(l);let d=document.createElement("p");d.classList.add("where-button","black-outline"),d.innerHTML="How to Use This",d.addEventListener("click",(()=>{Xa()})),l.appendChild(d);let s=document.createElement("p");s.classList.add("where-button","black-outline"),s.style.width="230px",s.innerHTML="View Chest Odds",s.addEventListener("click",(()=>{Za()})),l.appendChild(s);let i=document.createElement("p");i.classList.add("collection-desc-text"),i.innerHTML="Select a chest to see the chances of obtaining a new Insta Monkey based on your current collection. You can also view the Featured list or select a Featured Insta below to check the odds for selecting them in the event. The percentages represent the odds for each Insta Monkey received, so if a chest yields 2 Insta Monkeys, the odds are for 1 Insta Monkey roll.";let o=document.createElement("div");o.classList.add("collection-event-chest-selectors"),t.appendChild(o),Object.keys(xt).forEach((e=>{let t=document.createElement("img");t.id=`collection-event-chest-selector-${e}`,t.classList.add("collection-event-chest-selector"),t.src=`./Assets/UI/EventMysteryBox${xt[e]}Icon.webp`,t.addEventListener("click",(()=>{an(e)})),o.appendChild(t)}));let r=document.createElement("div");r.classList.add("collection-event-tower-selectors"),t.appendChild(r),Object.keys(ze.towersInOrder).forEach((e=>{if(!Object.keys(n.unlockedTowers).includes(e))return;let t=document.createElement("div");t.classList.add("collection-event-tower-selector"),t.addEventListener("click",(()=>{for(element of(Bt=Bt===e?"All":e,document.getElementsByClassName("collection-event-tower-selector")))element.classList.remove("collection-event-tower-selector-active");"All"!=Bt&&t.classList.add("collection-event-tower-selector-active"),tn(Bt)})),r.appendChild(t);let a=document.createElement("img");a.classList.add("collection-tower-icon"),a.src=ve(e,"000"),t.appendChild(a)}));let c=document.createElement("div");c.id="collection-event-tower-info",c.classList.add("collection-event-tower-info"),t.appendChild(c),tn(Bt)}function en(e){let t=[];if("All"==e)for(let e=1;e<6;e++){let a=0;Object.keys(ze.towersInOrder).forEach((t=>{Object.keys(n.unlockedTowers).includes(t)&&(a+=ut.TowerMissingByTier[t][e].length||0)})),t.push(a>0?a/(ze.instaTiers[e].length*Object.keys(n.unlockedTowers).length):0)}else for(let a=1;a<6;a++){let n=ut.TowerMissingByTier[e][a].length||0;t.push(n>0?n/ze.instaTiers[a].length:0)}let a=ze.collection.crateRewards.instaMonkey[It].tierChance;return t.forEach(((e,n)=>{let l=a[n+1]||0;t[n]=e*l})),t}function tn(e){"None"==It&&an("wood");let t=en(e),a=document.getElementById("collection-event-tower-info");a.innerHTML="";let n=document.createElement("div");n.classList.add("insta-monkey-div","insta-monkey-collection-div"),a.appendChild(n);let l=document.createElement("div");if(l.classList.add("insta-monkey-collection-main-div"),n.appendChild(l),"All"!=e)switch(ut.TowerBorders[e]){case"Gold":n.classList.add("insta-list-gold");break;case"Black":n.classList.add("insta-list-black")}let s=document.createElement("div");s.classList.add("insta-tower-and-missing-toggle"),"All"==e&&s.classList.add("insta-collection-all"),l.appendChild(s);let i=document.createElement("div");i.classList.add("tower-container-collection"),i.style.backgroundImage=`url(./Assets/UI/InstaTowersContainer${ut.TowerBorders[e]||""}.webp)`,"All"!=e&&i.addEventListener("click",(()=>{_a(e)})),s.appendChild(i);let o=document.createElement("img");o.classList.add("tower-img"),o.src="All"==e?"./Assets/UI/AllTowersIcon.webp":ye(e,"000"),i.appendChild(o);let r=document.createElement("p");r.classList.add("tower-name","black-outline"),r.innerHTML="All"==e?"All Towers":Re(e),i.appendChild(r);let c=document.createElement("div");c.classList.add("insta-missing-toggle-div");let p=document.createElement("p");p.classList.add("insta-collection-missing-label","black-outline"),p.innerHTML="Show Missing: ",c.appendChild(p);let m=document.createElement("input");m.classList.add("maps-progress-coop-toggle-input"),m.type="checkbox",m.checked=Ht,c.appendChild(m),"All"!=e&&s.appendChild(c);let u=document.createElement("div");u.classList.add("insta-monkey-top-bottom"),l.appendChild(u);let h=document.createElement("div");h.classList.add("insta-monkey-progress-list"),u.appendChild(h);let g=document.createElement("div");g.classList.add("insta-monkey-total"),h.appendChild(g);let L=document.createElement("p");L.classList.add("insta-monkey-progress-label-text","black-outline"),L.innerHTML="Usable Instas:",g.appendChild(L);let b=document.createElement("p");b.classList.add("insta-monkey-total-text","black-outline"),b.innerHTML="All"==e?Object.values(ut.TowerTotal).reduce(((e,t)=>e+t)):ut.TowerTotal[e],g.appendChild(b);let y=document.createElement("div");y.classList.add("insta-monkey-tier-progress"),h.appendChild(y);let v=document.createElement("p");v.classList.add("insta-monkey-progress-label-text","black-outline"),v.innerHTML="Unique Instas:",y.appendChild(v);let C=document.createElement("p");C.classList.add("insta-monkey-progress-text","black-outline"),C.innerHTML="All"==e?`${d.gameplay.instaMonkeyCollection}/${ze.totalInstaMonkeys}`:`${Object.values(ut.TowerTierTotals[e]).reduce(((e,t)=>e+t),0)}/64`,y.appendChild(C);let E=document.createElement("div");E.classList.add("insta-monkey-new-chance"),h.appendChild(E);let w=document.createElement("p");w.classList.add("insta-monkey-progress-label-text","black-outline"),w.innerHTML="Total New Chance:",E.appendChild(w);let k=document.createElement("p");k.classList.add("insta-monkey-total-chance-text","black-outline"),E.appendChild(k);let f=document.createElement("div");f.classList.add("insta-monkey-tiers-container"),u.appendChild(f);let T=document.createElement("p");T.classList.add("insta-monkey-tiers-label","black-outline"),T.innerHTML="Unique By Tier:",f.appendChild(T);let M="All"==e?Object.entries([1,2,3,4,5].reduce(((e,t)=>({...e,[t]:Object.values(ut.TowerTierTotals).map((e=>e[t]||0)).reduce(((e,t)=>e+t),0)})),{})):Object.entries(ut.TowerTierTotals[e]);for(let[t,a]of M){let n=document.createElement("div");if(n.classList.add("insta-monkey-tier-div"),f.appendChild(n),"All"==e){let e=document.createElement("p");e.classList.add("insta-monkey-tier-text-list",`insta-tier-text-${t}`,"5"==t?"t5-insta-outline":"black-outline"),n.style.backgroundImage=`url(./Assets/UI/InstaTier${t}Container.webp)`,e.innerHTML=`${a}`,n.appendChild(e);let l=document.createElement("p");l.classList.add("insta-monkey-tier-fraction-bar",`insta-tier-text-${t}`,"5"==t?"t5-insta-outline":"black-outline"),n.appendChild(l);let d=document.createElement("p");d.classList.add("insta-monkey-tier-text-list",`insta-tier-text-${t}`,"5"==t?"t5-insta-outline":"black-outline"),d.innerHTML=""+ze.instaTiers[t].length*Object.keys(ze.towersInOrder).length,n.appendChild(d)}else{let e=document.createElement("p");e.classList.add("insta-monkey-tier-text-list",`insta-tier-text-${t}`,"5"==t?"t5-insta-outline":"black-outline"),n.style.backgroundImage=`url(./Assets/UI/InstaTier${t}Container.webp)`,e.innerHTML=`${a}/${ze.instaTiers[t].length}`,n.appendChild(e)}}let I=document.createElement("div");I.classList.add("insta-monkey-chance-container"),u.appendChild(I);let B=document.createElement("p");B.classList.add("insta-monkey-tiers-label","black-outline"),B.innerHTML="New Chance:",I.appendChild(B);let H="black-outline";if("All"!=e)switch(ut.TowerBorders[e]){case"Gold":H="knowledge-outline";break;case"Black":H="leaderboard-outline"}let S=ze.collection.crateRewards.instaMonkey[It].tierChance;for(let[e,a]of M){let a=document.createElement("div");a.classList.add("insta-monkey-chance-div"),I.appendChild(a);let n=document.createElement("p");if(n.classList.add("insta-monkey-chance-text-list",H),n.innerHTML=(100*t[e-1]).toFixed(2)+"%",a.appendChild(n),S.hasOwnProperty(e)&&0==t[e-1]){let e=document.createElement("img");e.classList.add("insta-monkey-completed-tick"),e.src="./Assets/UI/TickGreenIcon.webp",a.appendChild(e)}else 0==t[e-1]&&n.classList.add("insta-monkey-chance-zero")}k.innerHTML=`${(100*t.reduce(((e,t)=>e+t),0)).toFixed(2)}%`,0==t.reduce(((e,t)=>e+t),0)&&k.classList.add("insta-monkey-chance-zero");let x=document.createElement("div");x.style.display="none",x.classList.add("insta-monkeys-missing-container"),n.appendChild(x),"All"!=e?m.addEventListener("change",(()=>{x.style.display=m.checked?"flex":"none",x.innerHTML="",Ht=m.checked,nn(x,e,t)})):(x.style.display="flex",ln(x)),Ht&&"All"!=e&&(x.style.display="flex",nn(x,e,t))}function an(e){It=e;for(let e of document.getElementsByClassName("collection-event-chest-selector"))e.classList.remove("chest-selected"),e.classList.add("chest-unselected");document.getElementById(`collection-event-chest-selector-${e}`).classList.add("chest-selected"),tn(Bt)}function nn(e,t,a){function l(t,a,l){let d=document.createElement("div");d.classList.add("insta-monkey-tier-container","insta-monkey-unobtained"),e.appendChild(d);let s=document.createElement("img");s.classList.add("insta-monkey-tier-img"),s.src=ve(t,a),d.appendChild(s),s.classList.add("upgrade-after-locked");let i=document.createElement("p");if(i.classList.add("insta-monkey-tier-text","black-outline"),i.innerHTML=`${a[0]}-${a[1]}-${a[2]}`,d.appendChild(i),l){let e=document.createElement("img");e.classList.add("insta-monkey-tier-obtained"),e.src="./Assets/UI/TickGreenIcon.webp",d.appendChild(e),d.addEventListener("click",(()=>{ut.TowerObtained[t]=ut.TowerObtained[t].filter((e=>e!=a));let e=Object.keys(ze.instaTiers).find((e=>ze.instaTiers[e].includes(a)));ut.TowerMissingByTier[t][e].push(a),delete n.instaTowers[t][a],ut.TowerTierTotals[t][e]-=1,Vt(t),tn(t)}))}else d.addEventListener("click",(()=>{ut.TowerObtained[t].push(a);let e=Object.keys(ze.instaTiers).find((e=>ze.instaTiers[e].includes(a)));ut.TowerMissingByTier[t][e]=ut.TowerMissingByTier[t][e].filter((e=>e!=a)),n.instaTowers[t][a]=0,ut.TowerTierTotals[t][e]+=1,Vt(t),tn(t)}))}if("All"==t)Object.entries(ut.TowerMissingByTier).forEach((([e,t])=>{Object.entries(t).forEach((([t,n])=>{if(a[t-1]>0)for(let t of n)l(e,t)}))}));else{let n=Object.entries(ut.TowerMissingByTier[t]).map((([e,t])=>({tier:e,insta:t}))).filter((({tier:e,insta:t})=>a[e-1]>0)).map((({insta:e})=>e)).flat();n.forEach((e=>{l(t,e,!1)}));let d=ut.TowerObtained[t];if(d.forEach((e=>{l(t,e,!0)})),0==n.length&&0==d.length){let t=document.createElement("p");t.classList.add("no-data-found","none-collection","black-outline"),t.innerHTML="None Missing in this Chest Type!",e.appendChild(t)}}}function ln(e){e.innerHTML="";let t={};t.NoFeatured=en("All"),Object.keys(ze.towersInOrder).forEach((e=>{t[e]=en(e)}));let a=Object.keys(ze.towersInOrder);switch(St){case"Highest Total Chance":a=Object.keys(t).sort(((e,a)=>{let n=t[e].reduce(((e,t)=>e+t),0),l=t[a].reduce(((e,t)=>e+t),0);return l-n}));break;case"In-Game Tower Order":break;case"Alphabetical Towers":a=Object.keys(ze.towersInOrder).sort()}let n=document.createElement("div");n.classList.add("insta-monkey-title-container"),e.appendChild(n);let l=document.createElement("p");l.classList.add("collection-header-list-text","black-outline"),l.innerHTML=`Featured Insta Odds (${It.toLocaleUpperCase()} ${"wood"==It?"Crate":"Chest"})`,n.appendChild(l);let d=document.createElement("div");d.classList.add("insta-monkey-sort-container"),n.appendChild(d);let s=document.createElement("p");s.classList.add("insta-monkey-sort-label","black-outline"),s.innerHTML="Sort By:",d.appendChild(s);let i=document.createElement("select");i.classList.add("map-progress-filter-difficulty-select"),i.addEventListener("change",(()=>{})),d.appendChild(i);["Highest Total Chance","In-Game Tower Order","Alphabetical Towers"].forEach((e=>{let t=document.createElement("option");t.value=e,t.innerHTML=e,i.appendChild(t)})),i.value=St,i.addEventListener("change",(()=>{St=i.value,ln(e)}));let o=document.createElement("div");o.classList.add("insta-monkey-header-container","insta-monkey-unobtained"),e.appendChild(o),Object.entries({"Tower Type":"white","Tier 1 Chance":"insta-tier-text-1","Tier 2 Chance":"insta-tier-text-2","Tier 3 Chance":"insta-tier-text-3","Tier 4 Chance":"insta-tier-text-4","Tier 5 Chance":"insta-tier-text-5","Total Chance":"white"}).forEach((([e,t])=>{let a=document.createElement("div");a.classList.add("insta-monkey-header-container","insta-monkey-unobtained"),o.appendChild(a);let n=document.createElement("p");n.classList.add("insta-monkey-small-name-text","black-outline",t),n.innerHTML=e,a.appendChild(n)}));let r=ze.collection.crateRewards.instaMonkey[It].tierChance;a.forEach((a=>{let n=document.createElement("div");n.classList.add("insta-monkey-list-container","insta-monkey-unobtained"),e.appendChild(n);let l=document.createElement("img");l.classList.add("insta-monkey-list-img"),l.src="NoFeatured"==a?"./Assets/UI/InstaRandomTier1.webp":ve(a,"000"),n.appendChild(l);let d=document.createElement("p");d.classList.add("insta-monkey-small-name-text","black-outline"),d.innerHTML="NoFeatured"==a?"No Featured Selected":Re(a),n.appendChild(d);let s=document.createElement("div");s.classList.add("insta-monkey-list-chance-container"),n.appendChild(s),t[a].forEach(((e,t)=>{let a=document.createElement("div");a.classList.add("insta-monkey-chance-div"),s.appendChild(a);let n=document.createElement("p");if(n.classList.add("insta-monkey-chance-text-list","black-outline"),n.innerHTML=(100*e).toFixed(2)+"%",r.hasOwnProperty(t+1)&&0==e){let e=document.createElement("img");e.classList.add("insta-monkey-completed-tick"),e.src="./Assets/UI/TickGreenIcon.webp",a.appendChild(e)}else 0==e&&n.classList.add("insta-monkey-chance-zero");a.appendChild(n)}));let i=document.createElement("div");i.classList.add("insta-monkey-chance-div"),s.appendChild(i);let o=t[a].reduce(((e,t)=>e+t),0),c=document.createElement("p");c.classList.add("insta-monkey-chance-text-list","black-outline"),c.innerHTML=(100*o).toFixed(2)+"%",0==o&&c.classList.add("insta-monkey-chance-zero"),i.appendChild(c)}))}function dn(){let e=document.getElementById("progress-content");e.innerHTML="";let t=document.createElement("div");t.classList.add("achievements-progress-container"),e.appendChild(t);let a=document.createElement("div");a.classList.add("achievements-header-bar"),t.appendChild(a);let n=document.createElement("div");n.classList.add("maps-progress-views"),a.appendChild(n);let l=document.createElement("div");l.classList.add("map-progress-filter-difficulty"),n.appendChild(l);let d=document.createElement("p");d.classList.add("maps-progress-coop-toggle-text","black-outline"),d.innerHTML="Filter:",l.appendChild(d);let s=document.createElement("select");s.classList.add("map-progress-filter-difficulty-select");["None","Knowledge Points","Insta Monkeys","Hidden Achievements"].forEach((e=>{let t=document.createElement("option");t.value=e,t.innerHTML=e,s.appendChild(t)})),l.appendChild(s);let i=document.createElement("div");i.classList.add("maps-progress-filter"),a.appendChild(i);let o=document.createElement("div");o.classList.add("map-progress-filter-difficulty"),i.appendChild(o);let r=document.createElement("p");r.classList.add("maps-progress-coop-toggle-text","black-outline"),r.innerHTML="Display:",o.appendChild(r);let c=document.createElement("select");c.classList.add("map-progress-filter-difficulty-select"),c.addEventListener("change",(()=>{rn(c.value)}));["All","Locked","Unlocked"].forEach((e=>{let t=document.createElement("option");t.value=e,t.innerHTML=e,c.appendChild(t)})),o.appendChild(c);let p=document.createElement("div");p.id="achievements-container",p.classList.add("achievements-container"),e.appendChild(p),s.addEventListener("change",(()=>{cn(s.value)})),rn("All"),cn("None"),sn()}function sn(){let e=document.getElementById("achievements-container");e.innerHTML="";let t=ze.achievementGameOrder;switch(pt){case"Locked":t=t.filter((e=>!n.achievementsClaimed.includes(ce[Fe[e].name]||Fe[e].name)));break;case"Unlocked":t=t.filter((e=>n.achievementsClaimed.includes(ce[Fe[e].name]||Fe[e].name)));break;case"All":t=t.sort(((e,t)=>n.achievementsClaimed.includes(ce[Fe[e].name]||Fe[e].name)-n.achievementsClaimed.includes(ce[Fe[t].name]||Fe[t].name)))}switch(mt){case"Monkey Money":t=t.filter((e=>Fe[e].model.loot.includes("MonkeyMoney"))),t=t.sort(((e,t)=>Object.values(ll(Fe[e].model.loot)).find((e=>"MonkeyMoney"==e.type)).amount-Object.values(ll(Fe[t].model.loot)).find((e=>"MonkeyMoney"==e.type)).amount));break;case"Knowledge Points":t=t.filter((e=>Fe[e].model.loot.includes("KnowledgePoints")));break;case"Insta Monkeys":t=t.filter((e=>Fe[e].model.loot.includes("InstaMonkey")));break;case"Hidden Achievements":t=t.filter((e=>Fe[e].model.hidden))}if(0==t.length){let t=document.createElement("p");t.classList.add("no-data-found","black-outline"),t.innerHTML="No Data Found.",t.style.width="100%",e.appendChild(t)}let a=document.createDocumentFragment();for(let e of t){let t=Fe[e],l=n.achievementsClaimed.includes(ce[t.name]||t.name),d=document.createElement("div");d.classList.add("achievement-div"),a.appendChild(d);let s=document.createElement("div");s.classList.add("achievement-top-div"),d.appendChild(s);let i=document.createElement("div");i.classList.add("achievement-icon-div"),s.appendChild(i);let o=document.createElement("img");o.classList.add("achievement-icon-img"),o.src=Be(t.model.achievementIcon,!l&&t.model.hidden),i.appendChild(o);let r=document.createElement("div");r.classList.add("achievement-text-div"),s.appendChild(r);let c=document.createElement("p");c.classList.add("achievement-name-text","black-outline"),c.innerHTML=l?Re(`Achievement ${t.model.achievementId} Name`):t.model.hidden?"???":Re(`Achievement ${t.model.achievementId} Name`),r.appendChild(c);let p=document.createElement("p");p.classList.add("achievement-desc-text");let m=l?Re(`Achievement ${t.model.achievementId} Description`):t.model.hidden?"???":Re(`Achievement ${t.model.achievementId} Description`);p.innerHTML=-1!=m.indexOf("{0}")?m.replace("{0}"," "+t.model.achievementGoal.toLocaleString()):m,r.appendChild(p);let u=document.createElement("div");u.classList.add("achievement-bottom-div"),d.appendChild(u);let h=document.createElement("div");h.classList.add("achievement-rewards-div"),u.appendChild(h);for(let[e,a]of Object.entries(ll(t.model.loot))){let e=document.createElement("div");e.classList.add("achievement-reward-div"),h.appendChild(e);let t=document.createElement("img");t.classList.add("achievement-reward-img"),t.src=Ae(a),e.appendChild(t);let n=document.createElement("p");n.classList.add("achievement-reward-text","black-outline");let l="";switch(a.type){case"InstaMonkey":l=a.tiers.split("").join("-");break;case"Knowledge":l="+ "+a.amount.toLocaleString();break;case"Power":case"RandomInstaMonkey":l="X "+a.amount.toLocaleString();break;default:l=a.amount?a.amount.toLocaleString():""}n.innerHTML=l,e.appendChild(n)}if(l){let e=document.createElement("img");e.classList.add("achievement-completed-check"),e.src="./Assets/UI/TickGreenIcon.webp",u.appendChild(e)}}e.appendChild(a)}function on(){let e=document.getElementById("progress-content");e.innerHTML="";let t=document.createElement("div");t.classList.add("extras-progress-container"),e.appendChild(t);let a=[["Big Bloons","BigBloonsMode"],["Small Bloons","SmallBloonsMode"],["Big Monkey Towers","BigTowersMode"],["Small Monkey Towers","SmallTowersMode"],["Small Bosses","SmallBossesMode"]];for(let[e,n]of a){let a=null==Xe[e],l=document.createElement("div");l.classList.add("extra-progress-div"),t.appendChild(l);let d=document.createElement("img");d.classList.add("extra-progress-img"),d.src=a?"./Assets/AchievementIcon/HiddenIcon.webp":`./Assets/UI/${n}Icon.webp`,l.appendChild(d);let s=document.createElement("p");if(s.classList.add("extra-progress-text","black-outline"),s.innerHTML=a?"???":Re(n),l.appendChild(s),!a){let e=document.createElement("img");e.classList.add("extra-progress-tick"),e.src="./Assets/UI/TickGreenIcon.webp",l.appendChild(e)}}}function rn(e){pt=e,sn()}function cn(e){mt=e,sn()}function pn(){let e=document.getElementById("events-content");e.innerHTML="";let t=document.createElement("div");t.classList.add("progress-page"),e.appendChild(t);let a=document.createElement("div");a.classList.add("selectors-div"),t.appendChild(a);Object.entries({Races:{img:"EventRaceBtn",text:"Race Events",bgimg:"EventBannerSmallRaces"},Bosses:{img:"BossesBtn",text:"Boss Events",bgimg:"EventBannerSmallBossChallenge"},Odyssey:{img:"OdysseyEventBtn",text:"Odyssey Events (Coming Soon)",bgimg:"EventBannerSmallOdyssey"},ContestedTerritory:{img:"ContestedTerritoryEventBtn",text:"Contested Territory",bgimg:"EventBannerSmallCT"},DailyChallenges:{img:"DailyChallengeBtn",text:"Daily Challenges",bgcolor:"radial-gradient(circle, transparent 50%, rgba(0,0,0,1) 100%),linear-gradient(45deg, rgb(70,148,213), rgb(70,148,213))"},AdvancedDailyChallenges:{img:"DailyChallengeBtn",text:"Advanced Daily Challenges",bgcolor:"radial-gradient(circle, transparent 50%, rgba(0,0,0,1) 100%),linear-gradient(45deg, rgb(234,99,52), rgb(234,99,52))"},CoopDailyChallenges:{img:"DailyChallengeBtn",text:"Coop Challenges",bgcolor:"radial-gradient(circle, transparent 50%, rgba(0,0,0,1) 100%),linear-gradient(45deg, rgb(255,150,0), rgb(255,150,0))"}}).forEach((([e,t])=>{let n=document.createElement("div");n.classList.add("events-selector-div"),t.bgcolor?n.style.background=t.bgcolor:n.style.backgroundImage=`url(../Assets/EventBanner/${t.bgimg}.webp)`,n.addEventListener("click",(()=>{mn(e)})),a.appendChild(n);let l=document.createElement("img");l.classList.add("selector-img"),l.src=`../Assets/UI/${t.img}.webp`,n.appendChild(l);let d=document.createElement("p");d.classList.add("event-selector-text","black-outline"),d.innerHTML=t.text,n.appendChild(d);let s=document.createElement("img");s.classList.add("selector-go-img"),"Odyssey"==e&&s.classList.add("hero-selector-div-disabled"),s.src="../Assets/UI/ContinueBtn.webp",n.appendChild(s)}))}function mn(e){switch(gl(),ht&&clearInterval(ht),e){case"Races":Yt(),q();break;case"Bosses":Yt(),Y();break;case"Odyssey":break;case"ContestedTerritory":Yt(),Z();break;case"DailyChallenges":Yt(),Ln("DailyChallenges");break;case"AdvancedDailyChallenges":Yt(),Ln("AdvancedDailyChallenges");break;case"CoopDailyChallenges":Yt(),Ln("CoopDailyChallenges")}}function un(){let e=document.getElementById("events-content");e.innerHTML="",Object.values(i).forEach(((t,a)=>{let n=document.createElement("div");n.classList.add("race-div"),e.appendChild(n);let l=document.createElement("div");l.classList.add("race-map-div","silver-border"),n.appendChild(l);let d=document.createElement("img");d.classList.add("race-map-img"),d.src="./Assets/MapIcon/MapLoadingImage.webp",l.appendChild(d);let s=document.createElement("div");s.classList.add("race-challenge-icons"),l.appendChild(s);let o=document.createElement("p");o.classList.add("race-map-rounds","black-outline"),l.appendChild(o);let r=document.createElement("div");r.classList.add("race-info-div"),n.appendChild(r);let c=document.createElement("div");c.classList.add("race-info-top-div"),r.appendChild(c);let p=document.createElement("div");p.classList.add("race-info-middle-div"),r.appendChild(p);let m=document.createElement("div");m.classList.add("race-info-bottom-div"),r.appendChild(m);let u=document.createElement("p");u.classList.add("race-info-name","black-outline"),u.innerHTML=t.name,c.appendChild(u);let h=document.createElement("p");h.id=`${a}-race-time-left`,h.classList.add("race-time-left","black-outline"),h.innerHTML="Finished",c.appendChild(h),new Date<new Date(t.start)?h.innerHTML="Coming Soon!":new Date(t.end)>new Date&&(pl(new Date(t.end),h.id),ht=setInterval((()=>pl(new Date(t.end),h.id)),1e3));let g=document.createElement("p");g.classList.add("race-info-dates","black-outline"),g.innerHTML=`${new Date(t.start).toLocaleDateString()} - ${new Date(t.end).toLocaleDateString()}`,p.appendChild(g);let L=document.createElement("p");L.classList.add("race-info-total-scores","black-outline"),L.innerHTML=`Total Scores: ${0==t.totalScores?"No Data":t.totalScores.toLocaleString()}`,p.appendChild(L);let b=document.createElement("div");b.classList.add("race-info-rules","start-button","hero-selector-div-disabled","black-outline"),b.innerHTML="Details",b.addEventListener("click",(()=>{"string"!=typeof i[a].metadata&&(Yt(),yn("events",t.metadata,"Race"))})),m.appendChild(b);let y=document.createElement("div");y.classList.add("race-info-leaderboard","where-button","black-outline"),y.innerHTML="Leaderboard",y.addEventListener("click",(()=>{En("events",t,"Race")})),m.appendChild(y),new IntersectionObserver(((e,n)=>{e.forEach((async e=>{if(e.isIntersecting&&(await K(a),"string"!=typeof i[a].metadata)){n.unobserve(e.target),b.classList.remove("hero-selector-div-disabled"),d.src=Object.keys(ze.mapsInOrder).includes(t.metadata.map)?Me(t.metadata.map):t.metadata.mapURL;let a=vn(t.metadata),l=Cn(t.metadata);for(let e of Object.values(a)){let t=document.createElement("img");t.classList.add("challenge-modifier-icon-event"),t.src=`./Assets/ChallengeRulesIcon/${e.icon}.webp`,s.appendChild(t)}for(let e of l){if("No Round 100 Reward"==e)continue;if("Paragon Limit"==e)continue;let t=document.createElement("img");t.classList.add("challenge-rule-icon-event"),t.src=`./Assets/ChallengeRulesIcon/${gt[e]}.webp`,s.appendChild(t)}o.innerHTML=`Rounds ${t.metadata.startRound}/${t.metadata.endRound}`}}))})).observe(l)}))}function hn(e){let t=document.getElementById("events-content");t.innerHTML="";let a=document.createElement("div");a.classList.add("switch-banner"),a.style.backgroundImage=`url(../Assets/UI/${Lt?"":"Elite"}Ribbon.webp)`,t.appendChild(a);let n=document.createElement("div");n.classList.add("switch-boss-div"),a.appendChild(n);let l=["Bloonarius","Lych","Vortex","Dreadbloon","Phayze","Blastapopoulos"];for(let e of l){let t=document.createElement("img");t.classList.add("switch-boss-img"),t.src=`./Assets/BossIcon/${e}Portrait${Lt?"":"Elite"}.webp`,n.appendChild(t)}let d=document.createElement("p");d.classList.add("switch-text","black-outline"),d.innerHTML=`Switch to ${Lt?"Standard":"Elite"}  Bosses`,a.appendChild(d),a.addEventListener("click",(()=>{Lt=!Lt,ht&&clearInterval(ht),hn(Lt)})),Object.values(g).forEach(((a,n)=>{let l=a.bossType.toLowerCase().replace(/\b\w/g,(e=>e.toUpperCase())),d=a.name.replace(/\D/g,""),s=`${e?"Elite":""} ${l} ${d}`,i={name:l,elite:e,eventNumber:d,scoringType:a.scoringType,index:n},o=document.createElement("div");o.classList.add("race-div"),o.style.backgroundImage=`url(../Assets/EventBanner/EventBannerSmall${l}.webp)`,t.appendChild(o);let r=document.createElement("div");r.classList.add("race-map-div","boss-border"),o.appendChild(r);let c=document.createElement("img");c.classList.add("race-map-img"),c.src="./Assets/MapIcon/MapLoadingImage.webp",r.appendChild(c);let p=document.createElement("img");p.classList.add("boss-map-boss-icon"),p.src=`./Assets/BossIcon/${l}Portrait${e?"Elite":""}.webp`,r.appendChild(p);let m=document.createElement("div");m.classList.add("race-challenge-icons"),r.appendChild(m);let u=document.createElement("p");u.classList.add("race-map-rounds"),r.appendChild(u);let h=document.createElement("div");h.classList.add("race-info-div","boss-info-div"),o.appendChild(h);let L=document.createElement("div");L.classList.add("race-info-top-div"),h.appendChild(L);let b=document.createElement("div");b.classList.add("race-info-middle-div"),h.appendChild(b);let y=document.createElement("div");y.classList.add("race-info-bottom-div"),h.appendChild(y);let v=document.createElement("p");v.classList.add("race-info-name","black-outline"),v.innerHTML=s,L.appendChild(v);let C=document.createElement("p");C.id=`${n}-boss-time-left`,C.classList.add("race-time-left","black-outline"),C.innerHTML="Finished",L.appendChild(C),new Date<new Date(a.start)?C.innerHTML="Coming Soon!":new Date(a.end)>new Date&&(pl(new Date(a.end),C.id),ht=setInterval((()=>pl(new Date(a.end),C.id)),1e3));let E=document.createElement("p");E.classList.add("race-info-dates","black-outline"),E.innerHTML=`${new Date(a.start).toLocaleDateString()} - ${new Date(a.end).toLocaleDateString()}`,b.appendChild(E);let w=document.createElement("p");w.classList.add("race-info-total-scores","black-outline"),w.innerHTML=`Total Scores: ${0==(e?a.totalScores_elite:a.totalScores_standard)?"No Data":(e?a.totalScores_elite:a.totalScores_standard).toLocaleString()}`,b.appendChild(w);let k=document.createElement("div");k.classList.add("race-info-rules","start-button","hero-selector-div-disabled",e?"btn-rotate-boss-elite":"btn-rotate-boss","black-outline"),k.innerHTML="Details",k.addEventListener("click",(()=>{"string"!=typeof g[n][e?"metadataElite":"metadataStandard"]&&(Yt(),yn("events",e?a.metadataElite:a.metadataStandard,"Boss",i))})),y.appendChild(k);let f=document.createElement("div");f.classList.add("race-info-leaderboard","start-button",e?"btn-rotate-boss-elite":"btn-rotate-boss","black-outline"),f.innerHTML="Leaderboard",f.addEventListener("click",(()=>{En("events",a,e?"BossElite":"Boss")})),y.appendChild(f),new IntersectionObserver(((t,l)=>{t.forEach((async t=>{if(t.isIntersecting&&(await J(n,e),"string"!=typeof g[n][e?"metadataElite":"metadataStandard"])){k.classList.remove("hero-selector-div-disabled");let n=document.createElement("img");switch(n.classList.add("challenge-modifier-icon-event"),a.scoringType){case"LeastCash":n.src="./Assets/ChallengeRulesIcon/LeastCashIcon.webp",m.appendChild(n);break;case"LeastTiers":n.src="./Assets/ChallengeRulesIcon/LeastTiersIcon.webp",m.appendChild(n)}l.unobserve(t.target);let d=vn(e?a.metadataElite:a.metadataStandard),s=Cn(e?a.metadataElite:a.metadataStandard);for(let e of Object.values(d)){let t=document.createElement("img");t.classList.add("challenge-modifier-icon-event"),t.src=`./Assets/ChallengeRulesIcon/${e.icon}.webp`,m.appendChild(t)}for(let e of s){if("No Round 100 Reward"==e)continue;let t=document.createElement("img");t.classList.add("challenge-rule-icon-event"),t.src=`./Assets/ChallengeRulesIcon/${gt[e]}.webp`,m.appendChild(t)}c.src=Object.keys(ze.mapsInOrder).includes(e?a.metadataElite.map:a.metadataStandard.map)?Me(e?a.metadataElite.map:a.metadataStandard.map):e?a.metadataElite.mapURL:a.metadataStandard.mapURL}}))})).observe(r)}))}function gn(){let e=document.getElementById("events-content");e.innerHTML="",document.getElementById("loading").style.transform="scale(0)",Object.values(L).forEach(((t,a)=>{let n=document.createElement("div");n.classList.add("race-div","ct-div"),n.style.backgroundImage="url(../Assets/ProfileBanner/TeamsBanner8.webp)",e.appendChild(n);let l=document.createElement("div");l.classList.add("ct-info-div"),n.appendChild(l);let d=document.createElement("div");d.classList.add("ct-info-top-div"),l.appendChild(d);let s=document.createElement("div");s.classList.add("ct-info-bottom-div"),l.appendChild(s);let i=document.createElement("p");i.classList.add("race-info-name","black-outline"),i.innerHTML="Contested Territory",d.appendChild(i);let o=document.createElement("p");o.id=`${a}-ct-time-left`,o.classList.add("race-time-left","black-outline"),o.innerHTML="Finished",d.appendChild(o),new Date<new Date(t.start)?o.innerHTML="Coming Soon!":new Date(t.end)>new Date&&(pl(new Date(t.end),o.id),ht=setInterval((()=>pl(new Date(t.end),o.id)),1e3));let r=document.createElement("div");r.classList.add("ct-info-left-div"),s.appendChild(r);let c=document.createElement("p");c.classList.add("race-info-dates","ct-info-dates","black-outline"),c.innerHTML=`${new Date(t.start).toLocaleDateString()} - ${new Date(t.end).toLocaleDateString()}`,r.appendChild(c);let p=document.createElement("div");p.classList.add("race-info-rules","start-button","currency-trophies-div","black-outline"),p.innerHTML="Relic Reveal",p.addEventListener("click",(()=>{Yt(),Bn("events",t.tiles,`${new Date(t.start).toLocaleDateString()} - ${new Date(t.end).toLocaleDateString()}`)})),r.appendChild(p);let m=document.createElement("div");m.classList.add("ct-leaderboards-div"),s.appendChild(m);let u=document.createElement("p");u.classList.add("ct-leaderboards-header","black-outline"),u.innerHTML="Leaderboards",m.appendChild(u);let h=document.createElement("div");h.classList.add("ct-leaderboards-btns"),m.appendChild(h);let g=document.createElement("div");g.classList.add("race-info-leaderboard","ct-info-leaderboard","start-button","blue-btn","black-outline"),g.innerHTML="Players",g.addEventListener("click",(()=>{En("events",t,"CTPlayer")})),h.appendChild(g);let L=document.createElement("div");L.classList.add("race-info-leaderboard","ct-info-leaderboard","start-button","blue-btn","black-outline"),L.innerHTML="Teams",L.addEventListener("click",(()=>{En("events",t,"CTTeam")})),h.appendChild(L);let b=document.createElement("div");b.classList.add("race-info-middle-div","ct-info-middle-div"),m.appendChild(b);let y=document.createElement("p");y.classList.add("race-info-total-scores","black-outline"),y.innerHTML=`Total Scores: ${0==t.totalScores_player?"No Data":t.totalScores_player.toLocaleString()}`,b.appendChild(y);let v=document.createElement("p");v.classList.add("race-info-total-scores","black-outline"),v.innerHTML=`Total Scores: ${0==t.totalScores_team?"No Data":t.totalScores_team.toLocaleString()}`,b.appendChild(v)}))}async function Ln(e){let t=document.getElementById("events-content");t.innerHTML="",await Q();let a=Object.values(b).filter((t=>{switch(e){case"DailyChallenges":return t.name.startsWith("Standard");case"AdvancedDailyChallenges":return t.name.startsWith("Advanced");case"CoopDailyChallenges":return t.name.startsWith("coop")}})),n=new Date;"CoopDailyChallenges"==e&&(a=a.filter((e=>new Date(e.createdAt)<n)),a=a.sort(((e,t)=>new Date(t.createdAt)-new Date(e.createdAt))));let l=0;if(Object.values(a).forEach(((e,t)=>{let a=e.name.match(/^(Standard|Advanced|coop)(?: (\d+))?: (.*)$/),n="";a&&(n=a[2]||null,null!=n&&n>l&&(l=n))})),"DailyChallenges"==e||"AdvancedDailyChallenges"==e){let a=document.createElement("div");a.classList.add("race-div","event-select-challenge-div"),t.appendChild(a);let n=document.createElement("p");n.classList.add("challenge-select-info-name","black-outline"),n.innerHTML=("DailyChallenges"==e?"Standard":"Advanced")+" Challenges",a.appendChild(n);let d=document.createElement("p");d.classList.add("challenge-info-desc"),d.innerHTML=`Select a challenge by entering a date or ID below. IDs can be no less than 1000, and the date cannot be earlier than ${"DailyChallenges"==e?new Date(Date.UTC(2021,4,7)).toISOString().split("T")[0]:new Date(Date.UTC(2021,4,20)).toISOString().split("T")[0]} for ${"DailyChallenges"==e?"Standard":"Advanced"} challenges.`,a.appendChild(d);let s=document.createElement("div");s.classList.add("challenge-selectors"),a.appendChild(s);let i=document.createElement("div");i.classList.add("challenge-selector-date"),s.appendChild(i);let o=document.createElement("p");o.classList.add("challenge-selector-date-text","black-outline"),o.innerHTML="Date",i.appendChild(o);let r=document.createElement("input");r.classList.add("challenge-selector-date-input"),r.type="date";let c=se(ie(l,"AdvancedDailyChallenges"==e));r.value=new Date(c[0],c[1]-1,c[2]).toISOString().split("T")[0],r.addEventListener("change",(()=>{new Date(r.value)>new Date&&(r.value=(new Date).toISOString().split("T")[0]),new Date(r.value)<new Date("DailyChallenges"==e?"2021-05-07":"2021-05-20")&&(r.value="DailyChallenges"==e?"2021-05-07":"2021-05-20")})),i.appendChild(r);let p=document.createElement("img");p.classList.add("challenge-selector-date-img"),p.src="../Assets/UI/ContinueBtn.webp",p.addEventListener("click",(async()=>{Yt(),yn("events",await ee(oe(r.value,"AdvancedDailyChallenges"==e)),e)})),i.appendChild(p);let m=document.createElement("p");m.classList.add("challenge-selector-or","black-outline"),m.innerHTML="OR",s.appendChild(m);let u=document.createElement("div");u.classList.add("challenge-selector-id"),s.appendChild(u);let h=document.createElement("p");h.classList.add("challenge-selector-id-text","black-outline"),h.innerHTML="Challenge ID",u.appendChild(h);let g=document.createElement("input");g.classList.add("challenge-selector-id-input"),g.type="number",g.min=1e3,g.max=l,g.value=l,g.addEventListener("change",(()=>{g.value<1e3&&(g.value=1e3),g.value>l&&(g.value=l)})),u.appendChild(g);let L=document.createElement("img");L.classList.add("challenge-selector-id-img"),L.src="../Assets/UI/ContinueBtn.webp",L.addEventListener("click",(async()=>{Yt(),yn("events",await ee(ie(g.value,"AdvancedDailyChallenges"==e)),e)})),u.appendChild(L)}Object.values(a).forEach(((a,n)=>{let d=a.name.match(/^(Standard|Advanced|coop)(?: (\d+))?: (.*)$/),s="",i="",o="";d&&(s=d[1]||null,i=d[2]||null,o=d[3]||null,null!=i&&i>l&&(l=i));let r=document.createElement("div");r.classList.add("race-div","event-challenge-div"),t.appendChild(r);let c=document.createElement("div");c.classList.add("race-map-div","silver-border"),r.appendChild(c);let p=document.createElement("img");p.classList.add("race-map-img"),p.src="./Assets/MapIcon/MapLoadingImage.webp",c.appendChild(p);let m=document.createElement("div");m.classList.add("race-challenge-icons"),c.appendChild(m);let u=document.createElement("p");u.classList.add("race-map-rounds","black-outline"),c.appendChild(u);let h=document.createElement("div");h.classList.add("race-info-div"),r.appendChild(h);let g=document.createElement("div");g.classList.add("challenge-info-top-div"),h.appendChild(g);let L=document.createElement("div");L.classList.add("challenge-info-left-right"),h.appendChild(L);let b=document.createElement("div");b.classList.add("challenge-info-middle-div"),L.appendChild(b);let y=document.createElement("div");y.classList.add("challenge-info-bottom-div"),L.appendChild(y);let v=document.createElement("p");v.classList.add("challenge-info-name","black-outline"),v.innerHTML="CoopDailyChallenges"==e?a.name.replace("coop - ",""):o,g.appendChild(v);let C=document.createElement("p");C.classList.add("challenge-date","black-outline");let E="CoopDailyChallenges"!=e&&se(ie(i,"AdvancedDailyChallenges"==e));C.innerHTML=`${"CoopDailyChallenges"==e?new Date(a.createdAt).toLocaleDateString():new Date(E[0],E[1]-1,E[2]).toLocaleDateString()}`,b.appendChild(C);let w=document.createElement("p");w.classList.add("challenge-date","black-outline"),w.innerHTML="CoopDailyChallenges"==e?"Coop":`${s} ${i}`,b.appendChild(w);let k=document.createElement("div");k.classList.add("challenge-info-rules","start-button","black-outline"),k.innerHTML="Details",k.addEventListener("click",(async()=>{Yt(),yn("events",await ee(a.id),e)})),b.appendChild(k);let f=["Attempts","Wins","Fails","Unique Players","Victorious Players"],T=document.createElement("div");T.classList.add("challenge-stats-div"),y.appendChild(T);for(let e of f){let t=document.createElement("div");t.classList.add("challenge-stat"),T.appendChild(t);let n=document.createElement("p");n.classList.add("challenge-stat-key"),n.innerHTML=e,t.appendChild(n);let l=document.createElement("p");l.id=`${a.id}-${e}`,l.classList.add("challenge-stat-value"),l.innerHTML="Loading...",t.appendChild(l)}new IntersectionObserver(((t,n)=>{t.forEach((async t=>{if(t.isIntersecting){let l=await ee(a.id);if(n.unobserve(t.target),null!=l){let t=vn(l),n=Cn(l);for(let e of Object.values(t)){let t=document.createElement("img");t.classList.add("challenge-modifier-icon-event"),t.src=`./Assets/ChallengeRulesIcon/${e.icon}.webp`,m.appendChild(t)}for(let t of n){if("No Round 100 Reward"==t&&"AdvancedDailyChallenges"!=e)continue;if("Paragon Limit"==t)continue;let a=document.createElement("img");a.classList.add("challenge-rule-icon-event"),a.src=`./Assets/ChallengeRulesIcon/${gt[t]}.webp`,m.appendChild(a)}p.src=Object.keys(ze.mapsInOrder).includes(l.map)?Me(l.map):l.mapURL,u.innerHTML=`Rounds ${l.startRound}/${l.endRound}`,f={Attempts:l.plays+l.restarts,Wins:l.wins,Fails:l.losses+l.restarts,"Unique Players":l.playsUnique,"Victorious Players":l.winsUnique};for(let[e,t]of Object.entries(f))document.getElementById(`${a.id}-${e}`).innerHTML=t.toLocaleString()}}}))})).observe(c)}))}function bn(e,t){let a={};return null==t&&("-1"!=e.leastCashUsed?a.scoringType="Least Cash":"-1"!=e.leastTiersUsed?a.scoringType="Least Tiers":a.scoringType=null,a["Random Seed"]=e.seed),a["Date Created"]=new Date(e.createdAt).toLocaleDateString(),a.ID=e.id,a.Creator=e.creator,a["Game Version"]=e.gameVersion,a.Stats={Plays:e.plays,Wins:e.wins,Losses:e.losses,Restarts:e.restarts,"Unique Plays":e.playsUnique,"Unique Wins":e.winsUnique,"Unique Losses":e.lossesUnique},a.Upvotes=e.upvotes,a["Player Completion Rate"]=0==e.playsUnique?"0%":e.winsUnique-e.playsUnique==0?"100%":`${(e.winsUnique/e.playsUnique*100).toFixed(2)}%`,a["Player Win Rate"]=0==e.playsUnique?"0%":`${(e.wins/(e.plays+e.restarts)*100).toFixed(2)}%`,a.statsValid=!1,"n/a"!=e.id&&(a.statsValid=!0),a}async function yn(e,t,a,n){if(null==t)return;document.getElementById("challenge-content").style.display="flex",document.getElementById("challenge-content").innerHTML="",document.getElementById(`${e}-content`).style.display="none",gl();let l=bn(t);if("Boss"==a&&"GameTime"!=n.scoringType)switch(n.scoringType){case"LeastCash":l.scoringType="Least Cash";break;case"LeastTiers":l.scoringType="Least Tiers"}let d=document.createElement("div");d.classList.add("challenge-model"),document.getElementById("challenge-content").appendChild(d);let s=document.createElement("div");s.classList.add("challenge-model-header"),d.appendChild(s);let i=document.createElement("div");i.classList.add("challenge-model-header-icons"),s.appendChild(i);let o=document.createElement("img");o.classList.add("challenge-model-header-difficulty"),i.appendChild(o);let r=document.createElement("div");r.classList.add("challenge-model-header-texts"),s.appendChild(r);let c=document.createElement("p");c.classList.add("challenge-model-header-name","black-outline"),c.innerHTML=t.name,r.appendChild(c);let p=document.createElement("p");p.classList.add("challenge-model-header-mode-diff","black-outline"),p.innerHTML=`${t.difficulty} - ${Re("Mode "+t.mode)} ${null==l.scoringType?"":` - ${l.scoringType}`}`,r.appendChild(p);let m=document.createElement("div");m.classList.add("challenge-header-right-container"),s.appendChild(m);let u=document.createElement("div");u.classList.add("challenge-header-right-top"),m.appendChild(u);let h=document.createElement("img");h.classList.add("modal-close"),h.src="./Assets/UI/CloseBtn.webp",h.addEventListener("click",(()=>{fn(e)})),u.appendChild(h);let L=document.createElement("div");L.classList.add("challenge-header-right-bottom"),m.appendChild(L);let b=document.createElement("div");b.classList.add("challenge-model-top"),d.appendChild(b);let y=document.createElement("img");y.classList.add("challenge-model-map-icon","boss-border"),y.src=Object.keys(ze.mapsInOrder).includes(t.map)?Me(t.map):t.mapURL,b.appendChild(y);let v=document.createElement("div");v.classList.add("challenge-model-settings"),b.appendChild(v);let C=document.createElement("div");C.classList.add("challenge-model-settings-left"),v.appendChild(C);let E=document.createElement("div");E.classList.add("challenge-model-settings-right"),v.appendChild(E);Object.entries({"Starting Cash":{icon:"CoinIcon",key:"startingCash"},"Start Round":{icon:"StartRoundIconSmall",key:"startRound"},"Starting Lives":{icon:"LivesIcon",key:"lives"},"End Round":{icon:"EndRoundIconSmall",key:"endRound"},"Max Lives":{icon:"LivesIcon",key:"maxLives"},"Max Monkeys":{icon:"MaxMonkeysIcon",key:"maxTowers"}}).forEach((([e,a],n)=>{let l=document.createElement("div");l.classList.add("challenge-setting"),n%2?E.appendChild(l):C.appendChild(l);let d=document.createElement("img");d.classList.add("challenge-setting-icon"),d.src=`./Assets/UI/${a.icon}.webp`,l.appendChild(d);let s=document.createElement("div");s.classList.add("challenge-setting-texts"),l.appendChild(s);let i=document.createElement("p");i.classList.add("challenge-setting-text","black-outline"),i.innerHTML=e+":",s.appendChild(i);let o=document.createElement("p");o.classList.add("challenge-setting-value","black-outline"),o.innerHTML=t[a.key],s.appendChild(o),"maxTowers"!=a.key||0!=t[a.key]&&9999!=t[a.key]||(o.innerHTML="Unlimited"),"maxLives"!=a.key&&"lives"!=a.key&&"startingCash"!=a.key&&"startRound"!=a.key&&"endRound"!=a.key||0!=t[a.key]||(o.innerHTML="Default")}));let w=document.createElement("div");w.classList.add("challenge-setting"),v.appendChild(w);let k=document.createElement("img");k.classList.add("challenge-setting-icon"),w.appendChild(k);let f=document.createElement("div");f.classList.add("challenge-setting-texts"),w.appendChild(f);let T=document.createElement("p");switch(T.classList.add("challenge-setting-text","black-outline"),f.appendChild(T),a){case"Race":o.src="./Assets/UI/EventRaceBtn.webp",T.innerHTML="Race Event",k.src="./Assets/UI/RaceIcon.webp",s.style.backgroundColor="#FFC300";break;case"Boss":o.src=`./Assets/BossIcon/${n.name}EventIcon.webp`,T.innerHTML=(n.elite?"Elite ":"")+"Boss Event",k.src=`./Assets/BossIcon/${n.name}Portrait${n.elite?"Elite":""}.webp`,c.innerHTML=`${n.elite?"Elite ":""}${n.name} ${n.eventNumber}`,s.style.background=n.elite?"linear-gradient(180deg, #401DB4, #A144E2)":"linear-gradient(180deg, #1882A5, #07A4CB)";let e=document.createElement("div");e.classList.add("start-button","black-outline",n.elite?"btn-rotate-boss":"btn-rotate-boss-elite"),e.innerHTML="Swap",e.addEventListener("click",(async()=>{n.elite=!n.elite,Yt(),"string"==typeof g[n.index][n.elite?"metadataElite":"metadataStandard"]&&await J(n.index,n.elite),yn("events",g[n.index][n.elite?"metadataElite":"metadataStandard"],a,n),Jt()})),m.appendChild(e);break;case"Odyssey":o.src="./Assets/UI/OdysseyEventBtn.webp";break;case"ContestedTerritory":o.src="./Assets/UI/ContestedTerritoryEventBtn.webp";break;case"DailyChallenges":T.innerHTML="Daily Challenge",k.src="./Assets/UI/ChallengesIcon.webp",o.src="./Assets/UI/DailyChallengeBtn.webp",s.style.backgroundColor="rgb(70,148,213)";break;case"AdvancedDailyChallenges":T.innerHTML="Advanced Daily",k.src="./Assets/UI/ChallengesIcon.webp",o.src="./Assets/UI/DailyChallengeBtn.webp",s.style.backgroundColor="rgb(234,99,52)";break;case"CoopDailyChallenges":T.innerHTML="Coop Challenge",k.src="./Assets/UI/ChallengesIcon.webp",o.src="./Assets/UI/DailyChallengeBtn.webp",s.style.backgroundColor="rgb(255,150,0)";break;case"Custom":T.innerHTML="Custom Challenge",k.src="./Assets/UI/CustomChallenge.webp",o.src="./Assets/UI/CreateChallengeIcon.webp";let l=document.createElement("p");l.classList.add("challenge-id","black-outline"),l.innerHTML=t.id,l.addEventListener("click",(e=>{e.preventDefault(),e.stopPropagation(),$n(t.id,l)})),L.appendChild(l);let d=document.createElement("img");d.classList.add("browser-copy-img"),d.src="../Assets/UI/CopyClipboardBtn.webp",d.addEventListener("click",(e=>{e.preventDefault(),e.stopPropagation(),$n(t.id,l)})),L.appendChild(d);let i=document.createElement("img");i.classList.add("browser-go-img"),i.src="../Assets/UI/GoBtnSmall.webp",i.addEventListener("click",(e=>{e.preventDefault(),e.stopPropagation(),sl(`https://join.btd6.com/Challenge/${t.id}`)})),L.appendChild(i)}if(null!=l.scoringType){let e="Boss"==a,n=document.createElement("div");n.classList.add("challenge-setting"),v.appendChild(n);let d=document.createElement("img");d.classList.add("challenge-setting-icon"),n.appendChild(d);let s=document.createElement("div");s.classList.add("challenge-setting-texts"),n.appendChild(s);let i=document.createElement("p");i.classList.add("challenge-setting-text","black-outline"),s.appendChild(i);let o=document.createElement("p");switch(o.classList.add("challenge-setting-value","black-outline"),o.innerHTML="ERROR",e||s.appendChild(o),l.scoringType){case"Least Cash":i.innerHTML=e?"Least Cash":"Least Cash:",d.src="./Assets/UI/LeastCashIconSmall.webp",o.innerHTML=t.leastCashUsed;break;case"Least Tiers":i.innerHTML=e?"Least Tiers":"Least Tiers:",d.src="./Assets/UI/LeastTiersIconSmall.webp",o.innerHTML=t.leastTiersUsed}}let M={},I={},H=!1,S={},x={};Object.entries(t._towers).forEach((([e,t])=>{0!=t.max?("ChosenPrimaryHero"===t.tower&&0!=t.max&&(H=!0),t.isHero?M[t.tower]=t:I[t.tower]=t):t.isHero?x[t.tower]=t:S[t.tower]=t}));let A=document.createElement("div");A.classList.add("challenge-towers-list"),d.appendChild(A);let P=document.createElement("div");P.classList.add("challenge-tower-selector-top"),A.appendChild(P);let D=document.createElement("p");D.classList.add("challenge-tower-selector-title","black-outline"),D.innerHTML="Monkeys Available:",P.appendChild(D);let $=document.createElement("div");$.classList.add("challenge-tower-selector-checkboxes"),P.appendChild($);let O=document.createElement("div");O.classList.add("maps-progress-coop-toggle"),$.appendChild(O);let R=document.createElement("p");R.classList.add("maps-progress-coop-toggle-text","black-outline"),R.innerHTML="Only Excluded & Limited: ",O.appendChild(R);let U=document.createElement("input");U.classList.add("maps-progress-coop-toggle-input"),U.type="checkbox",O.appendChild(U),U.addEventListener("change",(()=>{_.style.display="none"==_.style.display?"flex":"none",F.style.display="none"==F.style.display?"flex":"none",U.checked?D.innerHTML="Monkeys Limited:":D.innerHTML="Monkeys Available:"}));let G=document.createElement("div");G.classList.add("maps-progress-coop-toggle"),$.appendChild(G);let N=document.createElement("p");N.classList.add("maps-progress-coop-toggle-text","black-outline"),N.innerHTML="Hide Heroes: ",G.appendChild(N);let j=document.createElement("input");j.classList.add("maps-progress-coop-toggle-input"),j.type="checkbox",G.appendChild(j),j.addEventListener("change",(()=>{let e=document.getElementsByClassName("tower-selector-hero");for(let t of e)t.style.display="none"==t.style.display?"flex":"none"}));let F=document.createElement("div");F.classList.add("challenge-tower-selector"),A.appendChild(F);let _=document.createElement("div");if(_.style.display="none",_.classList.add("challenge-tower-selector"),A.appendChild(_),H){let e=document.createElement("div");e.classList.add("tower-selector-hero"),F.appendChild(e);let t=document.createElement("img");t.classList.add("hero-selector-img"),t.src="./Assets/UI/AllHeroesIcon.webp",e.appendChild(t)}else for(let[e,t]of Object.entries(ze.heroesInOrder)){if(!M[e])continue;let t=document.createElement("div");t.classList.add("tower-selector-hero");let a=document.createElement("img");a.classList.add("hero-selector-img"),a.src=ye(e,"000"),t.appendChild(a),F.appendChild(t)}for(let[e,t]of Object.entries(ze.towersInOrder)){if(!S[e])continue;let a=document.createElement("div");a.classList.add(`tower-selector-${t.toLowerCase()}`),_.appendChild(a);let n=document.createElement("img");n.classList.add("tower-selector-img"),n.src=ye(e,"000"),a.appendChild(n);let l=document.createElement("div");l.classList.add("max-count","towerTopLeft","towerExcluded"),a.appendChild(l)}for(let[e,t]of Object.entries(ze.towersInOrder)){if(!I[e])continue;let a=document.createElement("div");a.classList.add(`tower-selector-${t.toLowerCase()}`),F.appendChild(a);let n=document.createElement("img");n.classList.add("tower-selector-img"),n.src=ye(e,"000"),a.appendChild(n);let l=!1;if(0!=I[e].path1NumBlockedTiers||0!=I[e].path2NumBlockedTiers||0!=I[e].path3NumBlockedTiers){l=!0;let t=document.createElement("p");t.classList.add("tower-selector-tiers","black-outline"),t.innerHTML=`${-1==I[e].path1NumBlockedTiers?"0":5-I[e].path1NumBlockedTiers}-${-1==I[e].path2NumBlockedTiers?"0":5-I[e].path2NumBlockedTiers}-${-1==I[e].path3NumBlockedTiers?"0":5-I[e].path3NumBlockedTiers}`,a.appendChild(t)}else if(I[e].hasOwnProperty("restrictParagon")&&I[e].restrictParagon){let e=document.createElement("p");e.classList.add("tower-selector-tiers","black-outline"),e.innerHTML="5-5-5",a.appendChild(e)}if(-1!=I[e].max){l=!0;let t=document.createElement("div");t.classList.add("max-count","towerTopLeft"),a.appendChild(t);let n=document.createElement("p");n.classList.add("towerTopLeftText","black-outline"),n.innerHTML=`${I[e].max}`,t.appendChild(n)}l&&_.appendChild(a.cloneNode(!0))}if(!H)for(let[e,t]of Object.entries(ze.heroesInOrder)){if(!x[e])continue;let t=document.createElement("div");t.classList.add("tower-selector-hero");let a=document.createElement("img");a.classList.add("hero-selector-img"),a.src=ye(e,"000"),t.appendChild(a);let n=document.createElement("div");n.classList.add("max-count","towerTopLeft","towerExcluded"),t.appendChild(n),_.appendChild(t)}let q=!1;if(0==_.children.length){let e=document.createElement("p");e.classList.add("challenge-modifier-none"),e.style.width="100%",e.innerHTML="No Excluded or Limited Towers!",_.appendChild(e),q=!0}"Boss"!=a||q||(U.checked=!0,_.style.display="none"==_.style.display?"flex":"none",F.style.display="none"==F.style.display?"flex":"none",U.checked?D.innerHTML="Monkeys Limited:":D.innerHTML="Monkeys Available:");let K=document.createElement("div");K.classList.add("challenge-model-columns"),d.appendChild(K);let z=document.createElement("div");z.classList.add("challenge-model-left"),K.appendChild(z);let W=document.createElement("div");W.classList.add("challenge-model-right"),K.appendChild(W);let V=vn(t),Y=document.createElement("div");Y.classList.add("challenge-modifiers-div"),z.appendChild(Y);let Z=document.createElement("p");if(Z.classList.add("challenge-modifiers-header","black-outline"),Z.innerHTML="Modifiers",Object.entries(V).forEach((([e,t])=>{let a=document.createElement("div");a.classList.add("challenge-modifier"),Y.appendChild(a);let n=document.createElement("img");n.classList.add("challenge-modifier-icon"),n.src=`./Assets/ChallengeRulesIcon/${t.icon}.webp`,a.appendChild(n);let l=document.createElement("div");l.classList.add("challenge-modifier-texts"),a.appendChild(l);let d=document.createElement("p");d.classList.add("challenge-modifier-text","black-outline"),d.innerHTML=`${e}:`,l.appendChild(d);let s=document.createElement("p");s.classList.add("challenge-modifier-value","black-outline"),s.innerHTML=isNaN(t.value)?t.value:`${(100*t.value).toFixed(0)}%`,l.appendChild(s)})),0==Y.children.length){let e=document.createElement("p");e.classList.add("challenge-modifier-none"),e.innerHTML="Default",Y.appendChild(e)}Y.prepend(Z);let X=Cn(t),Q=document.createElement("p");Q.classList.add("challenge-rules-header","black-outline"),Q.innerHTML="Rules",W.appendChild(Q);let ee=document.createElement("div");if(ee.classList.add("challenge-rules-div"),W.appendChild(ee),X.forEach((e=>{if("No Round 100 Reward"==e&&"AdvancedDailyChallenges"!=a)return;if("Paragon Limit"==e&&0==t.maxParagons&&"Boss"!=a)return;let n=document.createElement("div");n.classList.add("challenge-rule"),ee.appendChild(n);let l=document.createElement("img");l.classList.add("challenge-modifier-icon"),l.src=`./Assets/ChallengeRulesIcon/${gt[e]}.webp`,n.appendChild(l);let d=document.createElement("div");d.classList.add("challenge-rule-text-div"),n.appendChild(d);let s=document.createElement("p");if(s.classList.add("challenge-rule-text","black-outline"),s.innerHTML=e,d.appendChild(s),"Custom Rounds"==e&&"Boss"==a){let e=null;if(t.roundSets.includes("bloonarius")&&(e="BloonariusRoundSet"),t.roundSets.includes("lych")&&(e="LychRoundSet"),t.roundSets.includes("vortex")&&(e="VortexRoundSet"),t.roundSets.includes("dreadbloon")&&(e="DreadbloonRoundSet"),t.roundSets.includes("phayze")&&(e="PhayzeRoundSet"),t.roundSets.includes("blastapopoulos")&&(e="BlastapopoulosRoundSet"),null!=e){let t=document.createElement("div");t.classList.add("challenge-rule-subtext","start-button","black-outline"),t.innerHTML="Open",d.appendChild(t),t.addEventListener("click",(()=>{Fn("challenge",e)}))}}let i=t.roundSets.filter((e=>"default"!==e&&"bloonarius"!==e&&"lych"!==e&&"vortex"!==e&&"dreadbloon"!==e&&"phayze"!==e));if("Custom Rounds"==e&&ze.skuRoundsets.includes(i[0])&&"AlternateBloonsRounds"!=t.mode){let e=document.createElement("div");e.classList.add("challenge-rule-subtext","start-button","black-outline"),e.innerHTML="Open",d.appendChild(e),e.addEventListener("click",(()=>{Fn("challenge",i[0])}))}if("Paragon Limit"==e){let e=document.createElement("p");e.classList.add("challenge-rule-value","black-outline"),e.innerHTML=t.maxParagons,d.appendChild(e)}})),0==ee.children.length){let e=document.createElement("p");e.classList.add("challenge-modifier-none"),e.innerHTML="Default",ee.appendChild(e)}if(W.prepend(Q),l.statsValid){let e=document.createElement("div");e.classList.add("challenge-model-stats-div"),e.style.display="none",d.appendChild(e);let t=document.createElement("p");t.classList.add("challenge-stats-header","black-outline"),t.innerHTML="Challenge Stats",e.appendChild(t);let a=document.createElement("div");a.classList.add("challenge-stats-left-right"),e.appendChild(a);let n=document.createElement("div");n.classList.add("challenge-stats-left"),a.appendChild(n);let s=document.createElement("p");s.classList.add("challenge-stats-x"),s.innerHTML="X",s.addEventListener("click",(()=>{e.style.display="none"})),e.appendChild(s);let i=document.createElement("div");if(i.classList.add("challenge-usv-div"),n.appendChild(i),0!=l.Upvotes){let e=document.createElement("div");e.classList.add("challenge-upvote-div"),i.appendChild(e);let t=document.createElement("img");t.classList.add("challenge-upvote-icon"),t.src="./Assets/UI/ChallengeThumbsUpIcon.webp",e.appendChild(t);let a=document.createElement("p");a.classList.add("challenge-upvote-value"),a.innerHTML=l.Upvotes,e.appendChild(a)}let o=document.createElement("div");o.classList.add("challenge-trophy-div"),i.appendChild(o);let r=document.createElement("img");r.classList.add("challenge-trophy-icon"),r.src="./Assets/UI/ChallengeTrophyIcon.webp",o.appendChild(r);let c=document.createElement("p");c.classList.add("challenge-trophy-value"),c.innerHTML=l["Player Completion Rate"],o.appendChild(c);let p=document.createElement("div");p.classList.add("challenge-skull-div"),i.appendChild(p);let m=document.createElement("img");m.classList.add("challenge-skull-icon"),m.src="./Assets/UI/DeathRateIcon.webp",p.appendChild(m);let h=document.createElement("p");if(h.classList.add("challenge-skull-value"),h.innerHTML=l["Player Win Rate"],p.appendChild(h),"n/a"!=l.Creator&&null!=l.Creator){let e=document.createElement("div");e.classList.add("challenge-creator"),n.appendChild(e);let t=document.createElement("div");t.classList.add("avatar"),e.appendChild(t);let a=50,d=document.createElement("img");d.classList.add("avatar-frame","noSelect"),d.style.width=`${a}px`,d.src="../Assets/UI/InstaTowersContainer.webp",t.appendChild(d);let s=document.createElement("img");s.classList.add("avatar-img","noSelect"),s.style.width=`${a}px`,s.src="../Assets/ProfileAvatar/ProfileAvatar01.webp",t.appendChild(s);let i=document.createElement("p");i.classList.add("challenge-creator-name","black-outline"),i.innerHTML=B?"Click to Load Creator":"Loading...",e.appendChild(i),e.addEventListener("click",(async()=>{i.innerHTML="Loading...";let t=await ae(l.Creator);null!=t?(i.innerHTML=t.displayName,s.src=De(t),e.style.backgroundImage=`linear-gradient(to right, transparent 80%, var(--profile-secondary) 100%),url(${$e(t)})`,e.removeEventListener("click",arguments.callee),e.addEventListener("click",(()=>{Mn("challenge",l.Creator)}))):i.innerHTML="Click to Load Creator"})),B||e.click()}["Date Created","Game Version","Random Seed"].forEach((e=>{if("Game Version"==e&&0==l[e])return;let t=document.createElement("div");t.classList.add("challenge-stat"),n.appendChild(t);let a=document.createElement("p");a.classList.add("challenge-stat-label"),a.innerHTML=`${e}: ${l[e]}`,t.appendChild(a)}));let g=document.createElement("div");g.classList.add("challenge-stats-right"),a.appendChild(g),Object.entries(l.Stats).forEach((([e,t])=>{let a=document.createElement("div");a.classList.add("challenge-stat"),g.appendChild(a);let n=document.createElement("p");n.classList.add("challenge-stat-label"),n.innerHTML=e,a.appendChild(n);let l=document.createElement("p");l.classList.add("challenge-model-stat-value"),l.innerHTML=t.toLocaleString(),a.appendChild(l)}));let L=document.createElement("img");L.classList.add("challenge-stats-btn"),L.src="./Assets/UI/InfoBtn.webp",L.addEventListener("click",(()=>{e.style.display="none"==e.style.display?"flex":"none"})),u.appendChild(L)}}function vn(e){let t={};return 1!=e._bloonModifiers.speedMultiplier&&(t["Bloon Speed"]={value:e._bloonModifiers.speedMultiplier,icon:e._bloonModifiers.speedMultiplier>1?"FasterBloonsIcon":"SlowerBloonsIcon"}),1!=e._bloonModifiers.moabSpeedMultiplier&&(t["MOAB Speed"]={value:e._bloonModifiers.moabSpeedMultiplier,icon:e._bloonModifiers.moabSpeedMultiplier>1?"FasterMoabIcon":"SlowerMoabIcon"}),e._bloonModifiers.hasOwnProperty("regrowRateMultiplier")&&1!=e._bloonModifiers.regrowRateMultiplier&&(t["Regrow Rate"]={value:e._bloonModifiers.regrowRateMultiplier,icon:e._bloonModifiers.regrowRateMultiplier>1?"RegrowRateIncreaseIcon":"RegrowRateDecreaseIcon"}),e.hasOwnProperty("abilityCooldownReductionMultiplier")&&1!=e.abilityCooldownReductionMultiplier&&(t["Ability Cooldown Rate"]={value:e.abilityCooldownReductionMultiplier,icon:e.abilityCooldownReductionMultiplier>1?"AbilityCooldownReductionIncreaseIcon":"AbilityCooldownReductionDecreaseIcon"}),1!=e.removeableCostMultiplier&&-1!=e.removeableCostMultiplier&&(t["Removeable Cost"]={value:0==e.removeableCostMultiplier?"Free":12==e.removeableCostMultiplier?"Disabled":e.removeableCostMultiplier,icon:e.removeableCostMultiplier>1?"RemovableCostIncreaseIcon":"RemovableCostDecreaseIcon"}),1!=e._bloonModifiers.healthMultipliers.bloons&&(t["Ceramic Health"]={value:e._bloonModifiers.healthMultipliers.bloons,icon:e._bloonModifiers.healthMultipliers.bloons>1?"CeramicIncreaseHPIcon.webp":"CeramicDecreaseHPIcon"}),1!=e._bloonModifiers.healthMultipliers.moabs&&(t["MOAB Health"]={value:e._bloonModifiers.healthMultipliers.moabs,icon:e._bloonModifiers.healthMultipliers.moabs>1?"MoabBoostIcon":"MoabDecreaseHPIcon"}),e._bloonModifiers.healthMultipliers.hasOwnProperty("boss")&&1!=e._bloonModifiers.healthMultipliers.boss&&(t["Boss Health"]={value:e._bloonModifiers.healthMultipliers.boss,icon:e._bloonModifiers.healthMultipliers.boss>1?"BossBoostIcon":"BossDecreaseHPIcon"}),e._bloonModifiers.hasOwnProperty("bossSpeedMultiplier")&&1!=e._bloonModifiers.bossSpeedMultiplier&&(t["Boss Speed"]={value:e._bloonModifiers.bossSpeedMultiplier,icon:e._bloonModifiers.bossSpeedMultiplier>1?"FasterBossIcon":"SlowerBossIcon"}),t}function Cn(e){let t=[];return e.disableMK&&t.push("Monkey Knowledge Disabled"),1==e.lives&&t.push("No Lives Lost"),e.disableSelling&&t.push("Selling Disabled"),e.disablePowers&&t.push("Powers Disabled"),e.noContinues&&t.push("No Continues"),e._bloonModifiers.allCamo&&t.push("All Camo"),e._bloonModifiers.allRegen&&t.push("All Regrow"),e.disableDoubleCash&&t.push("Double Cash Disabled"),t.push("No Round 100 Reward"),(e.roundSets.includes("default")&&e.roundSets.length>1||1==e.roundSets.length&&"default"!=e.roundSets[0])&&t.push("Custom Rounds"),10!=e.maxParagons&&t.push("Paragon Limit"),t}function En(e,t,a){switch(a){case"Boss":r!=t.leaderboard_standard_players_1&&(c=1),r=t.leaderboard_standard_players_1;break;case"BossElite":r!=t.leaderboard_elite_players_1&&(c=1),r=t.leaderboard_elite_players_1;break;case"CTPlayer":r!=t.leaderboard_player&&(c=1),r=t.leaderboard_player;break;case"CTTeam":r!=t.leaderboard_team&&(c=1),r=t.leaderboard_team;break;default:r!=t.leaderboard&&(c=1),r=t.leaderboard}let n=document.getElementById("leaderboard-content");n.style.display="flex",n.innerHTML="",document.getElementById(`${e}-content`).style.display="none";let l=document.createElement("div");l.classList.add("leaderboard-div"),n.appendChild(l);let d=document.createElement("div");d.classList.add("leaderboard-top"),l.appendChild(d);let s=document.createElement("div");s.classList.add("leaderboard-header"),d.appendChild(s);let i=document.createElement("div");i.classList.add("leaderboard-header-left"),s.appendChild(i);let o=document.createElement("img");o.classList.add("modal-close"),o.src="./Assets/UI/CloseBtn.webp",o.addEventListener("click",(()=>{n.style.display="none",document.getElementById(`${e}-content`).style.display="flex"})),i.appendChild(o);let m=document.createElement("div");m.classList.add(`leaderboard-header-middle-${a.toLowerCase()}`),s.appendChild(m);let h=document.createElement("div");h.classList.add(`leaderboard-header-${a.toLowerCase()}`),m.appendChild(h);let g=document.createElement("p");switch(g.classList.add("leaderboard-header-title-text"),h.appendChild(g),a){case"Race":g.classList.add("black-outline"),g.innerHTML="Race Leaderboard";break;case"Boss":g.classList.add("black-outline"),g.innerHTML="Boss Leaderboard";break;case"BossElite":g.classList.add("black-outline"),g.innerHTML="Elite Boss Leaderboard";break;case"CTPlayer":g.classList.add("ct-text"),g.innerHTML="Contested Territory <br> Player Leaderboard";break;case"CTTeam":g.classList.add("ct-text"),g.innerHTML="Contested Territory <br> Team Leaderboard"}let L=document.createElement("div");if(L.classList.add("leaderboard-header-right"),s.appendChild(L),"Boss"==a||"BossElite"==a){let e=document.createElement("p");e.classList.add("leaderboard-disclaimer","black-outline"),e.innerHTML="Note: Only singleplayer boss leaderboards are available on the API currently.",d.appendChild(e)}let b=document.createElement("div");b.id="leaderboard-column-labels",b.classList.add("leaderboard-column-labels"),d.appendChild(b);let y=document.createElement("div");y.id="leaderboard-entries",y.classList.add("leaderboard-entries"),l.appendChild(y);let v=document.createElement("div");v.classList.add("leaderboard-footer"),l.appendChild(v);let C=document.createElement("div");C.classList.add("leaderboard-footer-left"),v.appendChild(C);let E=document.createElement("img");E.classList.add("leaderboard-footer-refresh"),E.src="./Assets/UI/RefreshBtn.webp",E.addEventListener("click",(()=>{u||(wn(t),E.style.filter="grayscale(1) brightness(0.5)",setTimeout((()=>{E.style.filter="none",u=!1}),1e4),u=!0)})),C.appendChild(E);let w=document.createElement("div");w.classList.add("leaderboard-footer-middle"),v.appendChild(w);let k=document.createElement("img");k.classList.add("leaderboard-footer-page-left","black-outline"),k.src="./Assets/UI/NextArrowSmallYellow.webp",w.appendChild(k);let f=document.createElement("div");f.id="leaderboard-footer-page-number",f.classList.add("leaderboard-footer-page-number","black-outline"),f.innerHTML="Loading...",w.appendChild(f);let T=document.createElement("img");T.classList.add("leaderboard-footer-page-right","black-outline"),T.src="./Assets/UI/NextArrowSmallYellow.webp",k.addEventListener("click",(()=>{c--,f.innerHTML=`Page ${c} (#${c*p-(p-1)} - ${c*p})`,y.innerHTML="",il(y),wn(t)})),T.addEventListener("click",(()=>{c++,f.innerHTML=`Page ${c} (#${c*p-(p-1)} - ${c*p})`,y.innerHTML="",il(y),wn(t)})),w.appendChild(T);let M=document.createElement("div");M.classList.add("leaderboard-footer-right"),v.appendChild(M);let I=document.createElement("input");I.classList.add("leaderboard-footer-page-input"),I.type="number",I.min="1",I.max=1e3/p,I.value=`${c}`,I.addEventListener("change",(()=>{I.value<1&&(I.value=1),I.value>1e3/p&&(I.value=1e3/p)})),M.appendChild(I);let B=document.createElement("img");B.classList.add("leaderboard-go-img"),B.src="../Assets/UI/ContinueBtn.webp",B.addEventListener("click",(()=>{c=I.value,f.innerHTML=`Page ${c} (#${c*p-(p-1)} - ${c*p})`,y.innerHTML="",il(y),wn(t)})),M.appendChild(B),il(y),wn(t,a)}async function wn(e,t){await z();let a=null;switch(t){case"CTTeam":a="CTTeam";break;case"CTPlayer":a="CTPlayer"}if(e.hasOwnProperty("leaderboard")&&e.leaderboard.includes("races")&&(a="GameTime"),e.hasOwnProperty("bossType"))switch(e.scoringType){case"GameTime":a="GameTime";break;case"LeastCash":a="LeastCash";break;case"LeastTiers":a="LeastTiers"}kn(a);let n=document.getElementById("leaderboard-entries");if(n.innerHTML="",null!=o)o.forEach(((a,l)=>{let d={};a.hasOwnProperty("scoreParts")&&a.scoreParts.forEach(((e,t)=>{d[e.name]=e}));let s=document.createElement("div");s.classList.add("leaderboard-entry"),"CTTeam"!=t&&s.addEventListener("click",(()=>{Mn("leaderboard",a.profile)})),n.appendChild(s);let i=document.createElement("div");i.classList.add("leaderboard-entry-div"),s.appendChild(i);let o=document.createElement("p");o.classList.add("leaderboard-entry-rank","black-outline"),o.innerHTML=l+(c-1)*p+1,i.appendChild(o);let r=document.createElement("div");r.classList.add("leaderboard-entry-player"),i.appendChild(r);let m=null,u=null,g=null;"CTTeam"==t?(m=document.createElement("div"),m.classList.add("leaderboard-entry-icon-ct"),r.appendChild(m),u=document.createElement("img"),u.classList.add("leaderboard-entry-frame"),u.src="./Assets/UI/TeamFrame1.webp",m.appendChild(u),g=document.createElement("img"),g.classList.add("leaderboard-entry-emblem"),g.src="./Assets/UI/TeamIcon1.webp",m.appendChild(g)):(m=document.createElement("img"),m.classList.add("leaderboard-entry-icon"),m.src="./Assets/ProfileAvatar/ProfileAvatar01.webp",r.appendChild(m));let L=document.createElement("p");L.classList.add("leaderboard-entry-name","leaderboard-outline"),L.innerHTML=a.displayName,r.appendChild(L);let b=document.createElement("div");b.classList.add("leaderboard-entry-time-submit-div"),i.appendChild(b);let y=document.createElement("div");y.classList.add("leaderboard-entry-score"),i.appendChild(y);let v=document.createElement("img");v.classList.add("leaderboard-entry-score-icon"),v.src="./Assets/UI/StopWatch.webp",y.appendChild(v);let C=document.createElement("p");if(C.classList.add("leaderboard-entry-main-score","leaderboard-outline"),y.appendChild(C),e.hasOwnProperty("leaderboard")&&e.leaderboard.includes("races")){let t=new Date(e.start+d["Time after event start"].score),n=document.createElement("p");n.classList.add("leaderboard-entry-time-submitted","leaderboard-outline"),n.innerHTML=t.toLocaleString(),b.appendChild(n);let l=document.createElement("p");l.classList.add("leaderboard-entry-time-submitted-relative","leaderboard-outline"),l.innerHTML=ml(new Date,t),b.appendChild(l),C.innerHTML=rl(a.score)}if(e.hasOwnProperty("bossType"))switch(e.scoringType){case"GameTime":let t=new Date(e.start+d["Time after event start"].score),n=document.createElement("p");n.classList.add("leaderboard-entry-time-submitted","leaderboard-outline"),n.innerHTML=t.toLocaleString(),b.appendChild(n);let l=document.createElement("p");l.classList.add("leaderboard-entry-time-submitted-relative","leaderboard-outline"),l.innerHTML=ml(new Date,t),b.appendChild(l),C.innerHTML=rl(a.score);break;case"LeastCash":C.innerHTML=a.score.toLocaleString(),v.src="./Assets/UI/LeastCashIconSmall.webp",v.classList.add("leaderboard-entry-score-icon-large");let s=document.createElement("div");s.classList.add("leaderboard-entry-game-time"),i.appendChild(s);let o=document.createElement("img");o.classList.add("leaderboard-entry-score-icon"),o.src="./Assets/UI/StopWatch.webp",s.appendChild(o);let r=document.createElement("p");r.classList.add("leaderboard-entry-game-time-value","leaderboard-outline"),r.innerHTML=rl(d["Game Time"].score),s.appendChild(r);break;case"LeastTiers":C.innerHTML=a.score.toLocaleString(),v.src="./Assets/UI/LeastTiersIconSmall.webp",v.classList.add("leaderboard-entry-score-icon-large");let c=document.createElement("div");c.classList.add("leaderboard-entry-game-time"),i.appendChild(c);let p=document.createElement("img");p.classList.add("leaderboard-entry-score-icon"),p.src="./Assets/UI/StopWatch.webp",c.appendChild(p);let m=document.createElement("p");m.classList.add("leaderboard-entry-game-time-value","leaderboard-outline"),m.innerHTML=rl(d["Game Time"].score),c.appendChild(m),y.classList.add("leaderboard-entry-score-tiers")}if(e.hasOwnProperty("tiles")&&(v.src="./Assets/UI/CtPointsIconSmall.webp",v.classList.add("leaderboard-entry-score-icon-large"),C.innerHTML=a.score.toLocaleString(),r.classList.add("leaderboard-entry-team")),!B){new IntersectionObserver(((e,t)=>{e.forEach((async e=>{e.isIntersecting&&U((async()=>{try{let n=await ae(a.profile);null!=n&&(n.hasOwnProperty("owner")?(u.src=n.frameURL,g.src=n.iconURL,i.style.backgroundImage=`url(${$e(n)})`):(m.src=De(n),i.style.backgroundImage=`url(${$e(n)})`),t.unobserve(e.target))}catch(e){console.error("Error fetching user profile:",e)}}))}))})).observe(m)}if(null!=h[a.profile.split("/").pop()]){let e=h[a.profile.split("/").pop()];e.hasOwnProperty("owner")?(u.src=e.frameURL,g.src=e.iconURL,i.style.backgroundImage=`url(${$e(e)})`):(m.src=De(e),i.style.backgroundImage=`url(${$e(e)})`)}}));else{let e=document.createElement("p");e.classList.add("no-data-found","black-outline"),e.style.width="250px",e.innerHTML="No Data Found",n.appendChild(e)}}function kn(e){let t=document.getElementById("leaderboard-column-labels");t.innerHTML="";let a=document.createElement("p");a.classList.add("leaderboard-column-rank","black-outline"),a.innerHTML="Rank",t.appendChild(a);let n=document.createElement("p");switch(n.classList.add("leaderboard-column-name","black-outline"),n.innerHTML="Player",t.appendChild(n),e){case"GameTime":let e=document.createElement("p");e.classList.add("leaderboard-column-time-submitted","black-outline"),e.innerHTML="Time Submitted",t.appendChild(e);let a=document.createElement("p");a.classList.add("leaderboard-column-time-score","black-outline"),a.innerHTML="Game Time",t.appendChild(a);break;case"LeastCash":let l=document.createElement("p");l.classList.add("leaderboard-column-cash-spent","black-outline"),l.innerHTML="Cash Spent",t.appendChild(l);let d=document.createElement("p");d.classList.add("leaderboard-column-time-score","black-outline"),d.innerHTML="Game Time",t.appendChild(d);break;case"LeastTiers":let s=document.createElement("p");s.classList.add("leaderboard-column-tiers-used","black-outline"),s.innerHTML="Tiers Used",t.appendChild(s);let i=document.createElement("p");i.classList.add("leaderboard-column-time-score","black-outline"),i.innerHTML="Game Time",t.appendChild(i);break;case"CTTeam":n.innerHTML="Team";case"CTPlayer":let o=document.createElement("p");o.classList.add("leaderboard-column-ct-points","black-outline"),o.innerHTML="CT Points",t.appendChild(o)}}function fn(e){document.getElementById("challenge-content").style.display="none",document.getElementById(`${e}-content`).style.display="flex"}function Tn(e){document.getElementById("map-content").style.display="none",document.getElementById(`${e}-content`).style.display="flex"}async function Mn(e,t){if(null==(t=await ae(t)))return;gl(),document.getElementById(`${e}-content`).style.display="none";let a=document.getElementById("publicprofile-content");a.style.display="flex",a.innerHTML="";let n=document.createElement("div");n.classList.add("publicprofile-div"),a.appendChild(n);let l=document.createElement("img");l.classList.add("error-modal-close"),l.src="./Assets/UI/CloseBtn.webp",l.addEventListener("click",(()=>{In(e)})),n.appendChild(l);let d=document.createElement("div");d.classList.add("profile-header","profile-banner"),d.style.backgroundImage=`linear-gradient(to bottom, transparent 50%, var(--profile-primary) 70%),url('${$e(t)}')`,n.appendChild(d),d.appendChild(ca(100,De(t)));let s=document.createElement("div");s.classList.add("profile-top-bottom"),d.appendChild(s);let i=document.createElement("div");i.classList.add("profile-top-public"),s.appendChild(i);let o=document.createElement("p");o.classList.add("profile-name","black-outline"),o.innerHTML=t.displayName,i.appendChild(o);let r=document.createElement("div");r.classList.add("rank-star-public"),i.appendChild(r);let c=document.createElement("img");c.classList.add("rank-img"),c.src="../Assets/UI/LvlHolder.webp",r.appendChild(c);let p=document.createElement("p");if(p.classList.add("rank-text","black-outline"),p.innerHTML=t.rank,r.appendChild(p),t.veteranRank>0){let e=document.createElement("div");e.classList.add("rank-star-public"),i.appendChild(e);let a=document.createElement("img");a.classList.add("rank-img"),a.src="../Assets/UI/LvlHolderVeteran.webp",e.appendChild(a);let n=document.createElement("p");n.classList.add("rank-text","black-outline"),n.innerHTML=t.veteranRank,e.appendChild(n)}let m=document.createElement("div");m.classList.add("profile-followers"),i.appendChild(m);let u=document.createElement("p");u.classList.add("followers-label","black-outline"),u.innerHTML="Followers",m.appendChild(u);let h=document.createElement("p");h.classList.add("followers-count"),h.innerHTML=t.followers.toLocaleString(),m.appendChild(h);let g=document.createElement("div");g.classList.add("below-profile-header"),n.appendChild(g);let L=document.createElement("div");L.classList.add("left-column-div"),g.appendChild(L);let b=document.createElement("div");b.classList.add("left-column-header"),L.appendChild(b);let y=document.createElement("p");y.classList.add("column-header-text","black-outline"),y.innerHTML="Medals",b.appendChild(y);let v={},C={};for(let[e,a]of Object.entries(he))v["Medal"+a]=t._medalsSinglePlayer[e]||0,C["MedalCoop"+a]=t._medalsMultiplayer[e]||0;v={...v,...C},v.PhayzeEliteBadge=t.bossBadgesElite.Phayze||0,v.PhayzeBadge=t.bossBadgesNormal.Phayze||0,v.DreadbloonEliteBadge=t.bossBadgesElite.Dreadbloon||0,v.DreadbloonBadge=t.bossBadgesNormal.Dreadbloon||0,v.VortexEliteBadge=t.bossBadgesElite.Vortex||0,v.VortexBadge=t.bossBadgesNormal.Vortex||0,v.LychEliteBadge=t.bossBadgesElite.Lych||0,v.LychBadge=t.bossBadgesNormal.Lych||0,v.BloonariusEliteBadge=t.bossBadgesElite.Bloonarius||0,v.BloonariusBadge=t.bossBadgesNormal.Bloonarius||0,v.MedalEventBronzeMedal=t._medalsRace.Bronze||0,v.MedalEventSilverMedal=t._medalsRace.Silver||0,v.MedalEventGoldSilverMedal=t._medalsRace.GoldSilver||0,v.MedalEventDoubleGoldMedal=t._medalsRace.DoubleGold||0,v.MedalEventGoldDiamondMedal=t._medalsRace.GoldDiamond||0,v.MedalEventDiamondMedal=t._medalsRace.Diamond||0,v.MedalEventRedDiamondMedal=t._medalsRace.RedDiamond||0,v.MedalEventBlackDiamondMedal=t._medalsRace.BlackDiamond||0,v.OdysseyStarIcon=t.gameplay.totalOdysseyStars||0,v.BossMedalEventBronzeMedal=t._medalsBoss.Bronze||0,v.BossMedalEventSilverMedal=t._medalsBoss.Silver||0,v.BossMedalEventDoubleSilverMedal=t._medalsBoss.DoubleSilver||0,v.BossMedalEventGoldSilverMedal=t._medalsBoss.GoldSilver||0,v.BossMedalEventDoubleGoldMedal=t._medalsBoss.DoubleGold||0,v.BossMedalEventGoldDiamondMedal=t._medalsBoss.GoldDiamond||0,v.BossMedalEventDiamondMedal=t._medalsBoss.Diamond||0,v.BossMedalEventRedDiamondMedal=t._medalsBoss.RedDiamond||0,v.BossMedalEventBlackDiamondMedal=t._medalsBoss.BlackDiamond||0,v.EliteBossMedalEventBronzeMedal=t._medalsBossElite.Bronze||0,v.EliteBossMedalEventSilverMedal=t._medalsBossElite.Silver||0,v.EliteBossMedalEventDoubleSilverMedal=t._medalsBossElite.DoubleSilver||0,v.EliteBossMedalEventGoldSilverMedal=t._medalsBossElite.GoldSilver||0,v.EliteBossMedalEventDoubleGoldMedal=t._medalsBossElite.DoubleGold||0,v.EliteBossMedalEventGoldDiamondMedal=t._medalsBossElite.GoldDiamond||0,v.EliteBossMedalEventDiamondMedal=t._medalsBossElite.Diamond||0,v.EliteBossMedalEventRedDiamondMedal=t._medalsBossElite.RedDiamond||0,v.EliteBossMedalEventBlackDiamondMedal=t._medalsBossElite.BlackDiamond||0,v.CtLocalPlayerBronzeMedal=t._medalsCTLocal.Bronze||0,v.CtLocalPlayerSilverMedal=t._medalsCTLocal.Silver||0,v.CtLocalPlayerDoubleGoldMedal=t._medalsCTLocal.DoubleGold||0,v.CtLocalPlayerGoldDiamondMedal=t._medalsCTLocal.GoldDiamond||0,v.CtLocalPlayerDiamondMedal=t._medalsCTLocal.Diamond||0,v.CtLocalPlayerRedDiamondMedal=t._medalsCTLocal.RedDiamond||0,v.CtLocalPlayerBlackDiamondMedal=t._medalsCTLocal.BlackDiamond||0,v.CtGlobalPlayerBronzeMedal=t._medalsCTGlobal.Bronze||0,v.CtGlobalPlayerSilverMedal=t._medalsCTGlobal.Silver||0,v.CtGlobalPlayerDoubleSilverMedal=t._medalsCTGlobal.DoubleSilver||0,v.CtGlobalPlayerGoldSilverMedal=t._medalsCTGlobal.GoldSilver||0,v.CtGlobalPlayerDoubleGoldMedal=t._medalsCTGlobal.DoubleGold||0,v.CtGlobalPlayerGoldDiamondMedal=t._medalsCTGlobal.GoldDiamond||0,v.CtGlobalPlayerDiamondMedal=t._medalsCTGlobal.Diamond||0,v.CtGlobalPlayerRedDiamondMedal=t._medalsCTGlobal.RedDiamond||0,v.CtGlobalPlayerBlackDiamondMedal=t._medalsCTGlobal.BlackDiamond||0;let E=document.createElement("div");E.classList.add("currency-medals-div"),L.appendChild(E);let w=document.createElement("div");w.classList.add("medals-div"),E.appendChild(w);for(let[e,t]of Object.entries(v)){if(0===t)continue;let a=document.createElement("div");a.classList.add("medal-div"),a.title=ze.medalLabels[e],w.appendChild(a);let n=document.createElement("img");n.classList.add("medal-img"),n.src=Se(e),n.style.display="none",n.addEventListener("load",(()=>{n.width<n.height?n.style.width=`${hl(3,70,256,0,n.width)}px`:n.style.height=`${hl(3,70,256,0,n.height)}px`,n.style.removeProperty("display")})),a.appendChild(n);let l=document.createElement("p");l.classList.add("medal-text","black-outline"),l.innerHTML=t.toLocaleString(),a.appendChild(l)}let k=document.createElement("div");k.classList.add("top-heroes-monkeys-div"),L.appendChild(k);let f=document.createElement("div");f.classList.add("top-heroes-div"),k.appendChild(f);let T=document.createElement("div");T.classList.add("top-heroes-top-div"),f.appendChild(T);let M=document.createElement("div");M.classList.add("top-heroes-top-ribbon-div"),T.appendChild(M);let I=document.createElement("p");I.classList.add("top-heroes-text","black-outline"),I.innerHTML="Top Heroes",M.appendChild(I);let B=document.createElement("div");B.classList.add("maps-progress-coop-toggle"),T.appendChild(B);let H=document.createElement("p");H.classList.add("maps-progress-coop-toggle-text","black-outline"),H.innerHTML="Show All: ",B.appendChild(H);let S=document.createElement("input");S.classList.add("maps-progress-coop-toggle-input"),S.type="checkbox",B.appendChild(S);let x=document.createElement("div");x.classList.add("top-heroes-list"),f.appendChild(x);let A=document.createElement("div");A.classList.add("top-3-heroes-div"),x.appendChild(A);let P=document.createElement("div");P.classList.add("other-heroes-div"),P.style.display="none",x.appendChild(P),S.addEventListener("change",(()=>{S.checked?P.style.display="flex":P.style.display="none"}));let D=0,$=Object.keys(ze.heroesInOrder);for(let[e,a]of Object.entries(t.heroesPlaced).sort(((e,t)=>t[1]-e[1]))){if(0===a)continue;if(!$.includes(e))continue;let t=document.createElement("div");t.classList.add("hero-div"),D<3?A.appendChild(t):P.appendChild(t);let n=document.createElement("img");n.classList.add("hero-img"),n.src=we(e,1),n.style.display="none",n.addEventListener("load",(()=>{n.width<n.height?n.style.width=`${hl(3,150,1920,0,n.width)}px`:n.style.height=`${hl(3,150,1920,0,n.height)}px`,n.style.removeProperty("display")})),t.appendChild(n);let l=document.createElement("p");l.classList.add("hero-text","black-outline"),l.innerHTML=a.toLocaleString(),t.appendChild(l),D++}let O=document.createElement("div");O.classList.add("top-heroes-div"),k.appendChild(O);let R=document.createElement("div");R.classList.add("top-heroes-top-div"),O.appendChild(R);let U=document.createElement("div");U.classList.add("top-heroes-top-ribbon-div"),R.appendChild(U);let G=document.createElement("p");G.classList.add("top-heroes-text","black-outline"),G.innerHTML="Top Towers",U.appendChild(G);let N=document.createElement("div");N.classList.add("maps-progress-coop-toggle"),R.appendChild(N);let j=document.createElement("p");j.classList.add("maps-progress-coop-toggle-text","black-outline"),j.innerHTML="Show All: ",N.appendChild(j);let F=document.createElement("input");F.classList.add("maps-progress-coop-toggle-input"),F.type="checkbox",N.appendChild(F);let _=document.createElement("div");_.classList.add("top-heroes-list"),O.appendChild(_);let q=document.createElement("div");q.classList.add("top-3-heroes-div"),_.appendChild(q);let K=document.createElement("div");K.classList.add("other-heroes-div"),K.style.display="none",_.appendChild(K),F.addEventListener("change",(()=>{F.checked?K.style.display="flex":K.style.display="none"})),D=0;let z=Object.keys(ze.towersInOrder);for(let[e,a]of Object.entries(t.towersPlaced).sort(((e,t)=>t[1]-e[1]))){if(0===a)continue;if(!z.includes(e))continue;let t=document.createElement("div");t.classList.add("hero-div"),D<3?q.appendChild(t):K.appendChild(t);let n=document.createElement("img");n.classList.add("hero-img"),n.src=ye(e,"000"),t.appendChild(n);let l=document.createElement("p");l.classList.add("hero-text","black-outline"),l.innerHTML=a.toLocaleString(),t.appendChild(l),D++}let W=document.createElement("div");W.classList.add("right-column-div"),g.appendChild(W);let V=document.createElement("div");V.classList.add("overview-right-column-header"),W.appendChild(V);let Y=document.createElement("p");Y.classList.add("column-header-text","black-outline"),Y.innerHTML="Overall Stats",V.appendChild(Y);let J={};J["Games Played"]=t.gameplay.gameCount,J["Games Won"]=t.gameplay.gamesWon,J["Highest Round (All Time)"]=t.gameplay.highestRound,J["Highest Round (CHIMPS)"]=t.gameplay.highestRoundCHIMPS,J["Highest Round (Deflation)"]=t.gameplay.highestRoundDeflation,J["Monkeys Placed"]=t.gameplay.monkeysPlaced,J["Total Pop Count"]=t.bloonsPopped.bloonsPopped,J["Total Co-Op Pop Count"]=t.bloonsPopped.coopBloonsPopped,J["Camo Bloons Popped"]=t.bloonsPopped.camosPopped,J["Lead Bloons Popped"]=t.bloonsPopped.leadsPopped,J["Purple Bloons Popped"]=t.bloonsPopped.purplesPopped,J["Regrow Bloons Popped"]=t.bloonsPopped.regrowsPopped,J["Ceramic Bloons Popped"]=t.bloonsPopped.ceramicsPopped,J["MOABs Popped"]=t.bloonsPopped.moabsPopped,J["BFBs Popped"]=t.bloonsPopped.bfbsPopped,J["ZOMGs Popped"]=t.bloonsPopped.zomgsPopped,J["DDTs Popped"]=t.bloonsPopped.ddtsPopped,J["BADs Popped"]=t.bloonsPopped.badsPopped,J["Bloons Leaked"]=t.bloonsPopped.bloonsLeaked,J["Cash Generated"]=t.gameplay.cashEarned,J["Cash Gifted"]=t.gameplay.coopCashGiven,J["Abilities Used"]=t.gameplay.abilitiesUsed,J["Powers Used"]=t.gameplay.powersUsed,J["Insta Monkeys Used"]=t.gameplay.instaMonkeysUsed,J["Daily Reward Chests Opened"]=t.gameplay.dailyRewards,J["Challenges Completed"]=t.gameplay.challengesCompleted,J.Achievements=`${t.achievements}/150`,J["Odysseys Completed"]=t.gameplay.totalOdysseysCompleted,J["Lifetime Trophies"]=t.gameplay.totalTrophiesEarned,J["Necro Bloons Reanimated"]=t.bloonsPopped.necroBloonsReanimated,J["Transforming Tonics Used"]=t.bloonsPopped.transformingTonicsUsed,J["Most Experienced Monkey"]=Re(t.mostExperiencedMonkey),J["Insta Monkey Collection"]=`${t.gameplay.instaMonkeyCollection}/${ze.totalInstaMonkeys}`,J["Collection Chests Opened"]=t.gameplay.collectionChestsOpened,J["Golden Bloons Popped"]=t.bloonsPopped.goldenBloonsPopped,J["Monkey Teams Wins"]=t.gameplay.monkeyTeamsWins,J["Bosses Popped"]=t.bloonsPopped.bossesPopped,J["Damage Done To Bosses"]=t.gameplay.damageDoneToBosses;let Z=document.createElement("div");Z.classList.add("profile-stats"),W.appendChild(Z);for(let[e,t]of Object.entries(J)){let a=document.createElement("div");a.classList.add("stat"),Z.appendChild(a);let n=document.createElement("p");n.classList.add("stat-name"),n.innerHTML=e,a.appendChild(n);let l=document.createElement("p");l.classList.add("stat-value"),l.innerHTML=t.toLocaleString(),a.appendChild(l)}}function In(e){document.getElementById("publicprofile-content").style.display="none",document.getElementById(`${e}-content`).style.display="flex"}async function Bn(e,t,a){let n=await X(t);if(null==n)return;document.getElementById(`${e}-content`).style.display="none";let l=document.getElementById("relics-content");l.style.display="flex",l.innerHTML="";let d=document.createElement("div");d.classList.add("relic-container"),l.appendChild(d),gl();let s=document.createElement("div");s.classList.add("relic-header"),d.appendChild(s);let i=document.createElement("div");i.classList.add("relic-header-views"),s.appendChild(i);let o=document.createElement("div");o.classList.add("maps-progress-view","black-outline","stats-tab-yellow"),o.innerHTML="List",i.appendChild(o);let r=document.createElement("div");r.classList.add("maps-progress-view","black-outline"),r.innerHTML="Tile",i.appendChild(r),o.addEventListener("click",(()=>{o.classList.add("stats-tab-yellow"),r.classList.remove("stats-tab-yellow"),document.querySelectorAll(".relic-text-div").forEach((e=>{e.classList.contains("relic-tile-view")&&e.classList.remove("relic-tile-view")}))})),r.addEventListener("click",(()=>{r.classList.add("stats-tab-yellow"),o.classList.remove("stats-tab-yellow"),document.querySelectorAll(".relic-text-div").forEach((e=>{e.classList.contains("relic-tile-view")||e.classList.add("relic-tile-view")}))}));let c=document.createElement("p");c.classList.add("relic-header-title","black-outline"),c.innerHTML=`Contested Territory<br>${a}`,s.appendChild(c);let p=document.createElement("div");p.classList.add("relic-header-right"),s.appendChild(p);let m=document.createElement("img");m.classList.add("modal-close"),m.src="./Assets/UI/CloseBtn.webp",m.addEventListener("click",(()=>{l.style.display="none",document.getElementById(`${e}-content`).style.display="flex"})),p.appendChild(m);let u=n.tiles.filter((e=>e.type.includes("Relic")));u.sort(((e,t)=>e.id.localeCompare(t.id)));let h=document.createElement("div");h.classList.add("relics-div"),d.appendChild(h),u.forEach((e=>{let t=e.type.split(" ")[2],a=document.createElement("div");switch(a.classList.add("relic-div"),h.appendChild(a),e.id.charAt(0)){case"A":a.style.backgroundColor="#9C55E4";break;case"B":a.style.backgroundColor="#E978AA";break;case"C":a.style.backgroundColor="#00DD6B";break;case"D":a.style.backgroundColor="#04A6F3";break;case"E":a.style.backgroundColor="#F7D302";break;case"F":a.style.backgroundColor="#F4413F";break;case"M":a.style.backgroundColor="#B9E546"}let n=document.createElement("p");n.classList.add("relic-id"),n.innerHTML=e.id,a.appendChild(n);let l=document.createElement("img");l.classList.add("relic-icon"),l.src=`./Assets/RelicIcon/${t}.webp`,a.appendChild(l);let d=document.createElement("div");d.classList.add("relic-text-div"),a.appendChild(d);let s=document.createElement("p");s.classList.add("relic-name","black-outline"),s.innerHTML=Re(`Relic${t}`),d.appendChild(s);let i=document.createElement("p");i.classList.add("relic-description"),i.innerHTML=Re(`Relic${t}Description`),d.appendChild(i)}))}function Hn(){let e=document.getElementById("explore-content");e.innerHTML="";let t=document.createElement("div");t.classList.add("progress-page"),e.appendChild(t);let a=document.createElement("div");a.classList.add("selectors-div"),t.appendChild(a);["Challenge Browser","Map Browser"].forEach((t=>{let n=document.createElement("div");n.classList.add("selector-div"),n.addEventListener("click",(()=>{e.style.display="none",document.getElementById("browser-content").style.display="flex",Sn(t)})),a.appendChild(n);let l=document.createElement("img");switch(l.classList.add("selector-img"),n.appendChild(l),t){case"Challenge Browser":l.src="../Assets/UI/PatchNotesMonkeyIcon.webp",n.classList.add("blueprint-bg");break;case"Map Browser":l.src="../Assets/UI/MapEditorBtn.webp",n.classList.add("map-model-bg","map-browser-selector")}let d=document.createElement("p");d.classList.add("selector-text","black-outline"),d.innerHTML=t,n.appendChild(d);let s=document.createElement("img");s.classList.add("selector-go-img"),s.src="../Assets/UI/ContinueBtn.webp",n.appendChild(s)}));["Enter Challenge ID","Enter Map ID"].forEach((e=>{let t=document.createElement("div");t.classList.add("selector-div"),a.appendChild(t);let n=document.createElement("img");n.classList.add("selector-img"),t.appendChild(n);let l=document.createElement("div");l.classList.add("enter-code-middle-div"),t.appendChild(l);let d=document.createElement("p");d.classList.add("selector-text","selector-text-code","black-outline"),d.innerHTML=e,l.appendChild(d);let s=document.createElement("input");s.classList.add("selector-input"),s.addEventListener("click",(e=>{e.preventDefault(),e.stopPropagation()})),l.appendChild(s);let i=document.createElement("img");switch(i.classList.add("selector-go-img"),i.src="../Assets/UI/ContinueBtn.webp",t.appendChild(i),e){case"Enter Challenge ID":n.src="../Assets/UI/EnterCodeIcon.webp",t.classList.add("blueprint-bg"),s.value="ZMGVLCF",i.addEventListener("click",(async()=>{Yt();let e=s.value.trim();e.length>6&&yn("explore",await ee(e),"Custom")}));break;case"Enter Map ID":n.src="../Assets/UI/EnterCodeIcon.webp",t.classList.add("map-model-bg","map-browser-selector"),s.value="ZMYXDVU",i.addEventListener("click",(async()=>{Yt();let e=s.value.trim();e.length>6&&Rn("explore",await ne(e))}))}}))}function Sn(e){switch(gl(),bt="Grid",e){case"Challenge Browser":C="https://data.ninjakiwi.com/btd6/challenges/filter/";break;case"Map Browser":C="https://data.ninjakiwi.com/btd6/maps/filter/"}xn(e)}function xn(e){let t=document.getElementById("browser-content");t.innerHTML="";let a=document.createElement("div");a.classList.add("browser-div"),t.appendChild(a);let n=document.createElement("div");n.classList.add("maps-progress-header-bar","browser-header-bar","border-top-only"),a.appendChild(n);let l=document.createElement("div");l.classList.add("map-progress-header-top"),n.appendChild(l);let d=document.createElement("p");d.classList.add("browser-header-title","black-outline"),d.innerHTML=e,l.appendChild(d);let s=document.createElement("p");s.classList.add("browser-header-desc"),s.innerHTML="This is not a replacement for the in-game browser, this exists to show what's available on the API.<br>Only 100 entries (4 pages) are available on the API. You can enter a specific ID at the bottom right.",l.appendChild(s);let i=document.createElement("div");i.classList.add("map-progress-header-bottom"),n.appendChild(i);let o=document.createElement("div");o.classList.add("maps-progress-views"),i.appendChild(o);let r=document.createElement("p");r.classList.add("maps-progress-coop-toggle-text","black-outline"),r.innerHTML="Display Type:",o.appendChild(r);let c=document.createElement("div");c.classList.add("maps-progress-filter"),n.appendChild(c);let p=document.createElement("div");p.classList.add("map-progress-filter-difficulty"),c.appendChild(p);let m=document.createElement("p");m.classList.add("maps-progress-coop-toggle-text","black-outline"),m.innerHTML="Category Type:",p.appendChild(m);let h=document.createElement("select");h.classList.add("map-progress-filter-difficulty-select"),h.addEventListener("change",(()=>{An(e,h.value)})),p.appendChild(h);let g=document.createElement("div");g.id="browser-entries",a.appendChild(g);let L=document.createElement("div");L.classList.add("browser-footer"),a.appendChild(L);let b=document.createElement("div");b.classList.add("leaderboard-footer-left","browser-footer-left"),L.appendChild(b);let y=document.createElement("img");y.classList.add("leaderboard-footer-refresh"),y.src="./Assets/UI/RefreshBtn.webp",y.addEventListener("click",(()=>{u||(f=!0,Pn(e),y.style.filter="grayscale(1) brightness(0.5)",setTimeout((()=>{y.style.filter="none",u=!1}),1e4),u=!0)})),b.appendChild(y);let v=document.createElement("div");v.classList.add("leaderboard-footer-middle","browser-footer-middle"),L.appendChild(v);let C=document.createElement("img");C.classList.add("leaderboard-footer-page-left","black-outline"),C.src="./Assets/UI/NextArrowSmallYellow.webp",v.appendChild(C);let w=document.createElement("div");w.id="browser-footer-page-number",w.classList.add("leaderboard-footer-page-number","black-outline"),w.innerHTML="Loading...",v.appendChild(w);let k=document.createElement("img");k.classList.add("leaderboard-footer-page-right","black-outline"),k.src="./Assets/UI/NextArrowSmallYellow.webp",C.addEventListener("click",(()=>{E<=1||u||(E--,w.innerHTML=`Page ${E} of 4`,g.innerHTML="",il(g),Pn(e),k.style.filter="grayscale(1) brightness(0.5)",C.style.filter="grayscale(1) brightness(0.5)",setTimeout((()=>{k.style.filter="none",C.style.filter="none",u=!1}),5e3),u=!0)})),k.addEventListener("click",(()=>{E>=4||u||(E++,w.innerHTML=`Page ${E} of 4`,g.innerHTML="",il(g),Pn(e),k.style.filter="grayscale(1) brightness(0.5)",C.style.filter="grayscale(1) brightness(0.5)",setTimeout((()=>{k.style.filter="none",C.style.filter="none",u=!1}),5e3),u=!0)})),v.appendChild(k);let T=document.createElement("div");T.classList.add("leaderboard-footer-right","browser-footer-right"),L.appendChild(T);let M=document.createElement("p");M.classList.add("leaderboard-footer-goto","black-outline"),M.innerHTML="ID:",T.appendChild(M);let I=document.createElement("input");I.classList.add("leaderboard-footer-page-input","browser-footer-input"),I.type="text",I.value="Map Browser"==e?"ZMYXDVU":"ZMGVLCF",T.appendChild(I);let B=document.createElement("img");switch(B.classList.add("leaderboard-go-img"),B.src="../Assets/UI/ContinueBtn.webp",B.addEventListener("click",(async()=>{Yt(),"Map Browser"==e?Rn("browser",await ne(I.value.trim())):yn("browser",await ee(I.value.trim()),"Custom")})),T.appendChild(B),e){case"Challenge Browser":let t=document.createElement("div");t.classList.add("maps-progress-view","stats-tab-yellow","black-outline"),t.innerHTML="Grid",o.appendChild(t);let a=document.createElement("div");a.classList.add("maps-progress-view","black-outline"),a.innerHTML="List",o.appendChild(a),t.addEventListener("click",(()=>{bt="Grid",t.classList.add("stats-tab-yellow"),a.classList.remove("stats-tab-yellow"),Pn(e)})),a.addEventListener("click",(()=>{bt="List",a.classList.add("stats-tab-yellow"),t.classList.remove("stats-tab-yellow"),Pn(e)})),["Featured","Newest"].forEach((e=>{let t=document.createElement("option");t.value=e,t.innerHTML=e,h.appendChild(t)})),An(e,"Featured");break;case"Map Browser":let n=document.createElement("div");n.classList.add("maps-progress-view","stats-tab-yellow","black-outline"),n.innerHTML="Grid",o.appendChild(n);let l=document.createElement("div");l.classList.add("maps-progress-view","black-outline"),l.innerHTML="Gallery",o.appendChild(l),n.addEventListener("click",(()=>{bt="Grid",n.classList.add("stats-tab-yellow"),l.classList.remove("stats-tab-yellow"),Pn(e)})),l.addEventListener("click",(()=>{bt="Gallery",l.classList.add("stats-tab-yellow"),n.classList.remove("stats-tab-yellow"),Pn(e)})),["Most Liked","Trending","Newest"].forEach((e=>{let t=document.createElement("option");t.value=e,t.innerHTML=e,h.appendChild(t)})),An(e,"Most Liked")}g.classList.add("challenge-card-entries"),il(g)}function An(e,t){switch(t){case"Newest":k="newest";break;case"Featured":case"Trending":k="trending";break;case"Most Liked":k="mostLiked"}E=1,Yt(),document.getElementById("browser-entries").innerHTML="",Pn(e)}async function Pn(e){await te();let t=document.getElementById("browser-entries");if(t.innerHTML="",null!=v)switch(e){case"Challenge Browser":Dn(t);break;case"Map Browser":On(t)}else{let e=document.createElement("p");e.classList.add("no-data-found","black-outline"),e.style.width="250px",e.innerHTML="No Data Found",t.appendChild(e)}}function Dn(e){v.forEach((async(t,a)=>{let n=document.createElement("div");switch(n.addEventListener("click",(async()=>{Yt(),yn("browser",await ee(t.id),"Custom")})),e.appendChild(n),bt){case"Grid":n.classList.add("challenge-entry");let e=document.createElement("div");e.classList.add("challenge-top"),n.appendChild(e);let a=document.createElement("p");a.classList.add("challenge-name","black-outline"),a.innerHTML=t.name,t.name.length>30&&(a.style.fontSize="18px"),e.appendChild(a);let l=document.createElement("div");l.classList.add("challenge-middle"),n.appendChild(l);let d=document.createElement("div");d.classList.add("challenge-left"),l.appendChild(d);let s=document.createElement("div");s.classList.add("race-map-div","silver-border"),d.appendChild(s);let i=document.createElement("img");i.classList.add("race-map-img"),i.src="./Assets/MapIcon/MapLoadingImage.webp",s.appendChild(i);let o=document.createElement("div");o.classList.add("race-challenge-icons"),s.appendChild(o);let r=document.createElement("p");r.classList.add("race-map-rounds","black-outline"),s.appendChild(r);let c=document.createElement("div");c.classList.add("browser-usv-div"),l.appendChild(c);let p=document.createElement("div");p.classList.add("challenge-upvote-div"),c.appendChild(p);let m=document.createElement("img");m.classList.add("browser-upvote-icon"),m.src="./Assets/UI/ChallengeThumbsUpIcon.webp",p.appendChild(m);let u=document.createElement("p");u.classList.add("browser-upvote-value"),u.innerHTML=0,p.appendChild(u);let h=document.createElement("div");h.classList.add("challenge-trophy-div"),c.appendChild(h);let g=document.createElement("img");g.classList.add("browser-trophy-icon"),g.src="./Assets/UI/ChallengeTrophyIcon.webp",h.appendChild(g);let L=document.createElement("p");L.classList.add("browser-trophy-value"),L.innerHTML=0,h.appendChild(L);let b=document.createElement("div");b.classList.add("challenge-skull-div"),c.appendChild(b);let y=document.createElement("img");y.classList.add("browser-skull-icon"),y.src="./Assets/UI/DeathRateIcon.webp",b.appendChild(y);let v=document.createElement("p");v.classList.add("browser-skull-value"),v.innerHTML=0,b.appendChild(v);let C=document.createElement("div");C.classList.add("challenge-bottom"),n.appendChild(C);let E=document.createElement("div");E.classList.add("challenge-creator"),C.appendChild(E);let w=document.createElement("div");w.classList.add("avatar"),E.appendChild(w);let k=50,f=document.createElement("img");f.classList.add("avatar-frame","noSelect"),f.style.width=`${k}px`,f.src="../Assets/UI/InstaTowersContainer.webp",w.appendChild(f);let T=document.createElement("img");T.classList.add("avatar-img","noSelect"),T.style.width=`${k}px`,T.src="../Assets/ProfileAvatar/ProfileAvatar01.webp",w.appendChild(T);let M=document.createElement("p");M.classList.add("browser-creator-name","black-outline"),M.innerHTML=B?"Click to Load Creator":"Loading...",E.appendChild(M);let I=document.createElement("div");I.classList.add("challenge-id-and-play"),C.appendChild(I);let H=document.createElement("p");H.classList.add("browser-id","black-outline"),H.innerHTML=t.id,H.addEventListener("click",(e=>{e.preventDefault(),e.stopPropagation(),$n(t.id,H)})),I.appendChild(H);let S=document.createElement("img");S.classList.add("browser-copy-img"),S.src="../Assets/UI/CopyClipboardBtn.webp",S.addEventListener("click",(e=>{e.preventDefault(),e.stopPropagation(),$n(t.id,H)})),I.appendChild(S);let x=document.createElement("img");x.classList.add("browser-go-img"),x.src="../Assets/UI/GoBtnSmall.webp",x.addEventListener("click",(e=>{e.preventDefault(),e.stopPropagation(),sl(`https://join.btd6.com/Challenge/${t.id}`)})),I.appendChild(x),new IntersectionObserver(((e,a)=>{e.forEach((async e=>{if(e.isIntersecting){a.unobserve(e.target);let n=await ee(t.id);if(null==n)return;i.src=Object.keys(ze.mapsInOrder).includes(n.map)?Me(n.map):n.mapURL;let l=vn(n),d=Cn(n);for(let e of Object.values(l)){let t=document.createElement("img");t.classList.add("challenge-modifier-icon-event"),t.src=`./Assets/ChallengeRulesIcon/${e.icon}.webp`,o.appendChild(t)}for(let e of d){if("No Round 100 Reward"==e)continue;if("Paragon Limit"==e)continue;let t=document.createElement("img");t.classList.add("challenge-rule-icon-event"),t.src=`./Assets/ChallengeRulesIcon/${gt[e]}.webp`,o.appendChild(t)}r.innerHTML=`Rounds ${0==n.startRound?ze.startRound[n.difficulty]:n.startRound}/${0==n.endRound?ze.endRound[n.difficulty]:n.endRound}`,u.innerHTML=n.upvotes.toLocaleString(),L.innerHTML=0==n.playsUnique||n.winsUnique-n.playsUnique==0?"0%":`${(n.winsUnique/n.playsUnique*100).toFixed(2)}%`,v.innerHTML=0==n.playsUnique?"0%":`${(n.wins/(n.plays+n.restarts)*100).toFixed(2)}%`,E.addEventListener("click",(async e=>{e.preventDefault(),e.stopPropagation(),M.innerHTML="Loading...";let t=await ae(n.creator);null!=t?(M.innerHTML=t.displayName,t.displayName.length>13&&(M.style.fontSize="17px"),T.src=De(t),C.style.backgroundImage=`linear-gradient(to right, transparent 80%, var(--profile-secondary) 100%),url(${$e(t)})`,E.removeEventListener("click",arguments.callee),E.addEventListener("click",(()=>Mn("browser",n.creator)))):M.innerHTML="Click to Load Creator"})),B||E.click()}}))})).observe(n);break;case"List":n.classList.add("browser-list-entry");let A=document.createElement("img");A.classList.add("browser-list-map-img"),A.src="./Assets/MapIcon/MapLoadingImage.webp",n.appendChild(A);let P=document.createElement("div");P.classList.add("browser-top-bottom"),n.appendChild(P);let D=document.createElement("div");D.classList.add("browser-list-entry-top"),P.appendChild(D);let $=document.createElement("div");$.classList.add("browser-list-entry-bottom"),P.appendChild($);let O=document.createElement("p");O.classList.add("challenge-name","browser-list-name","black-outline"),O.innerHTML=t.name,t.name.length>30&&(O.style.fontSize="18px"),D.appendChild(O);let R=document.createElement("div");R.classList.add("challenge-creator","browser-challenge-creator"),D.appendChild(R);let U=document.createElement("div");U.classList.add("avatar"),R.appendChild(U);let G=45,N=document.createElement("img");N.classList.add("avatar-frame","noSelect"),N.style.width=`${G}px`,N.src="../Assets/UI/InstaTowersContainer.webp",U.appendChild(N);let j=document.createElement("img");j.classList.add("avatar-img","noSelect"),j.style.width=`${G}px`,j.src="../Assets/ProfileAvatar/ProfileAvatar01.webp",U.appendChild(j);let F=document.createElement("p");F.classList.add("browser-creator-name","black-outline"),F.innerHTML=B?"Click to Load Creator":"Loading...",R.appendChild(F);let _=document.createElement("div");_.classList.add("browser-usv-list-div"),$.appendChild(_);let q=document.createElement("div");q.classList.add("challenge-upvote-div"),_.appendChild(q);let K=document.createElement("img");K.classList.add("browser-upvote-icon"),K.src="./Assets/UI/ChallengeThumbsUpIcon.webp",q.appendChild(K);let z=document.createElement("p");z.classList.add("browser-upvote-value"),z.innerHTML=0,q.appendChild(z);let W=document.createElement("div");W.classList.add("challenge-trophy-div"),_.appendChild(W);let V=document.createElement("img");V.classList.add("browser-trophy-icon"),V.src="./Assets/UI/ChallengeTrophyIcon.webp",W.appendChild(V);let Y=document.createElement("p");Y.classList.add("browser-trophy-value"),Y.innerHTML=0,W.appendChild(Y);let J=document.createElement("div");J.classList.add("challenge-skull-div"),_.appendChild(J);let Z=document.createElement("img");Z.classList.add("browser-skull-icon"),Z.src="./Assets/UI/DeathRateIcon.webp",J.appendChild(Z);let X=document.createElement("p");X.classList.add("browser-skull-value"),X.innerHTML=0,J.appendChild(X);let Q=document.createElement("div");Q.classList.add("challenge-id-and-play"),$.appendChild(Q);let te=document.createElement("p");te.classList.add("browser-id","black-outline"),te.innerHTML=t.id,te.addEventListener("click",(e=>{e.preventDefault(),e.stopPropagation(),$n(t.id,te)})),Q.appendChild(te);let ne=document.createElement("img");ne.classList.add("browser-copy-img"),ne.src="../Assets/UI/CopyClipboardBtn.webp",ne.addEventListener("click",(e=>{e.preventDefault(),e.stopPropagation(),$n(t.id,te)})),Q.appendChild(ne);let le=document.createElement("img");le.classList.add("browser-go-img"),le.src="../Assets/UI/GoBtnSmall.webp",le.addEventListener("click",(e=>{e.preventDefault(),e.stopPropagation(),sl(`https://join.btd6.com/Challenge/${t.id}`)})),Q.appendChild(le);let de=new IntersectionObserver(((e,a)=>{e.forEach((async e=>{if(e.isIntersecting){a.unobserve(e.target);let n=await ee(t.id);if(null==n)return;A.src=Object.keys(ze.mapsInOrder).includes(n.map)?Me(n.map):n.mapURL,z.innerHTML=n.upvotes.toLocaleString(),Y.innerHTML=0==n.playsUnique||n.winsUnique-n.playsUnique==0?"0%":`${(n.winsUnique/n.playsUnique*100).toFixed(2)}%`,X.innerHTML=0==n.playsUnique?"0%":`${(n.wins/(n.plays+n.restarts)*100).toFixed(2)}%`,R.addEventListener("click",(async e=>{e.preventDefault(),e.stopPropagation(),F.innerHTML="Loading...";let t=await ae(n.creator);null!=t?(F.innerHTML=t.displayName,t.displayName.length>13&&(F.style.fontSize="17px"),j.src=De(t),R.style.backgroundImage=`linear-gradient(to right, transparent 80%, var(--profile-primary) 100%),url(${$e(t)})`,R.removeEventListener("click",arguments.callee),R.addEventListener("click",(()=>Mn("browser",n.creator)))):F.innerHTML="Click to Load Creator"})),B||R.click()}}))}));de.observe(n)}}))}function $n(e,t){navigator.clipboard.writeText(e).then((function(){console.log("Copying to clipboard was successful!"),t.innerHTML="Copied!",setTimeout((()=>{t.innerHTML=e}),2e3)}),(function(t){console.log("Could not copy text: ",t),yl(`Failed to copy text "${e}" to clipboard. ${t}`)}))}function On(e){v.forEach(((t,a)=>{let n=document.createElement("div");switch(n.addEventListener("click",(async()=>{Yt(),Rn("browser",await ne(t.id))})),e.appendChild(n),bt){case"Grid":n.classList.add("challenge-entry","map-browser-bg");let e=document.createElement("div");e.classList.add("challenge-top"),n.appendChild(e);let a=document.createElement("p");a.classList.add("challenge-name","black-outline"),a.innerHTML=t.name,t.name.length>30&&(a.style.fontSize="18px"),t.name.length>35&&(a.style.fontSize="17px"),e.appendChild(a);let l=document.createElement("div");l.classList.add("challenge-middle"),n.appendChild(l);let d=document.createElement("div");d.classList.add("challenge-left"),l.appendChild(d);let s=document.createElement("div");s.classList.add("race-map-div","silver-border"),d.appendChild(s);let i=document.createElement("img");i.classList.add("race-map-img"),i.src=Oe(t.id),i.onerror=function(){this.onerror=null,this.src="./Assets/MapIcon/MapLoadingImage.webp"},s.appendChild(i);let o=document.createElement("div");o.classList.add("browser-usv-div"),l.appendChild(o);let r=document.createElement("div");r.classList.add("challenge-upvote-div"),o.appendChild(r);let c=document.createElement("img");c.classList.add("browser-upvote-icon"),c.src="./Assets/UI/ChallengeThumbsUpIcon.webp",r.appendChild(c);let p=document.createElement("p");p.classList.add("browser-upvote-value"),p.innerHTML=0,r.appendChild(p);let m=document.createElement("div");m.classList.add("challenge-trophy-div"),o.appendChild(m);let u=document.createElement("img");u.classList.add("browser-trophy-icon"),u.src="./Assets/UI/ChallengeTrophyIcon.webp",m.appendChild(u);let h=document.createElement("p");h.classList.add("browser-trophy-value"),h.innerHTML=0,m.appendChild(h);let g=document.createElement("div");g.classList.add("challenge-skull-div"),o.appendChild(g);let L=document.createElement("img");L.classList.add("browser-skull-icon"),L.src="./Assets/UI/DeathRateIcon.webp",g.appendChild(L);let b=document.createElement("p");b.classList.add("browser-skull-value"),b.innerHTML=0,g.appendChild(b);let y=document.createElement("div");y.classList.add("challenge-bottom"),n.appendChild(y);let v=document.createElement("div");v.classList.add("challenge-creator"),y.appendChild(v);let C=document.createElement("div");C.classList.add("avatar"),v.appendChild(C);let E=50,w=document.createElement("img");w.classList.add("avatar-frame","noSelect"),w.style.width=`${E}px`,w.src="../Assets/UI/InstaTowersContainer.webp",C.appendChild(w);let k=document.createElement("img");k.classList.add("avatar-img","noSelect"),k.style.width=`${E}px`,k.src="../Assets/ProfileAvatar/ProfileAvatar01.webp",C.appendChild(k);let f=document.createElement("p");f.classList.add("browser-creator-name","black-outline"),f.innerHTML=B?"Click to Load Creator":"Loading...",v.appendChild(f);let T=document.createElement("div");T.classList.add("challenge-id-and-play"),y.appendChild(T);let M=document.createElement("p");M.classList.add("browser-id","black-outline"),M.innerHTML=t.id,M.addEventListener("click",(e=>{e.preventDefault(),e.stopPropagation(),$n(t.id,M)})),T.appendChild(M);let I=document.createElement("img");I.classList.add("browser-copy-img"),I.src="../Assets/UI/CopyClipboardBtn.webp",I.addEventListener("click",(e=>{e.preventDefault(),e.stopPropagation(),$n(t.id,M)})),T.appendChild(I);let H=document.createElement("img");H.classList.add("browser-go-img"),H.src="../Assets/UI/GoBtnSmall.webp",H.addEventListener("click",(e=>{e.preventDefault(),e.stopPropagation(),sl(`https://join.btd6.com/Map/${t.id}`)})),T.appendChild(H),new IntersectionObserver(((e,a)=>{e.forEach((async e=>{if(e.isIntersecting){a.unobserve(e.target);let n=await ne(t.id);if(null==n)return;p.innerHTML=n.upvotes.toLocaleString(),h.innerHTML=0==n.playsUnique||n.winsUnique-n.playsUnique==0?"0%":`${(n.winsUnique/n.playsUnique*100).toFixed(2)}%`,b.innerHTML=0==n.playsUnique?"0%":`${(n.wins/(n.plays+n.restarts)*100).toFixed(2)}%`,v.addEventListener("click",(async e=>{e.preventDefault(),e.stopPropagation(),f.innerHTML="Loading...";let t=await ae(n.creator);null!=t?(f.innerHTML=t.displayName,t.displayName.length>13&&(f.style.fontSize="17px"),k.src=De(t),y.style.backgroundImage=`linear-gradient(to right, transparent 80%, var(--profile-secondary) 100%),url(${$e(t)})`,v.removeEventListener("click",arguments.callee),v.addEventListener("click",(()=>Mn("browser",n.creator)))):f.innerHTML="Click to Load Creator"})),B||v.click()}}))})).observe(n);break;case"Gallery":let S=document.createElement("div");S.classList.add("race-map-div","silver-border"),n.appendChild(S);let x=document.createElement("p");x.classList.add("browser-id","gallery-id","black-outline"),x.innerHTML=t.id,x.addEventListener("click",(e=>{e.preventDefault(),e.stopPropagation(),$n(t.id,x)})),S.appendChild(x);let A=document.createElement("img");A.classList.add("race-map-img"),A.src=Oe(t.id),A.onerror=function(){this.onerror=null,this.src="./Assets/MapIcon/MapLoadingImage.webp"},S.appendChild(A)}new IntersectionObserver(((e,t)=>{e.forEach((async e=>{e.isIntersecting&&t.unobserve(e.target)}))})).observe(n)}))}async function Rn(e,t){if(null==t)return;gl();let a=document.getElementById("map-content");a.style.display="flex",a.innerHTML="",document.getElementById(`${e}-content`).style.display="none";let n=bn(t),l=document.createElement("div");l.classList.add("challenge-model"),a.appendChild(l);let d=document.createElement("div");d.classList.add("challenge-model-header"),l.appendChild(d);let s=document.createElement("div");s.classList.add("challenge-model-header-icons"),d.appendChild(s);let i=document.createElement("img");i.classList.add("challenge-model-header-difficulty"),i.src="./Assets/UI/EditMapIcon.webp",s.appendChild(i);let o=document.createElement("div");o.classList.add("challenge-model-header-texts"),d.appendChild(o);let r=document.createElement("p");r.classList.add("challenge-model-header-name","black-outline"),r.innerHTML=t.name,o.appendChild(r);let c=document.createElement("div");c.classList.add("challenge-header-right-container"),d.appendChild(c);let p=document.createElement("div");p.classList.add("challenge-header-right-top"),c.appendChild(p);let m=document.createElement("img");m.classList.add("modal-close"),m.src="./Assets/UI/CloseBtn.webp",m.addEventListener("click",(()=>{Tn(e)})),p.appendChild(m);let u=document.createElement("div");u.classList.add("challenge-header-right-bottom"),c.appendChild(u);let h=document.createElement("p");h.classList.add("challenge-id","black-outline"),h.innerHTML=t.id,h.addEventListener("click",(e=>{e.preventDefault(),e.stopPropagation(),$n(t.id,h)})),u.appendChild(h);let g=document.createElement("img");g.classList.add("browser-copy-img"),g.src="../Assets/UI/CopyClipboardBtn.webp",g.addEventListener("click",(e=>{e.preventDefault(),e.stopPropagation(),$n(t.id,h)})),u.appendChild(g);let L=document.createElement("img");L.classList.add("browser-go-img"),L.src="../Assets/UI/GoBtnSmall.webp",L.addEventListener("click",(e=>{e.preventDefault(),e.stopPropagation(),sl(`https://join.btd6.com/Map/${t.id}`)})),u.appendChild(L);let b=document.createElement("div");b.classList.add("map-model-top","map-model-bg"),l.appendChild(b);let y=document.createElement("img");if(y.classList.add("map-model-img","boss-border"),y.src=Object.keys(ze.mapsInOrder).includes(t.map)?Me(t.map):t.mapURL,b.appendChild(y),n.statsValid){let e=document.createElement("div");e.classList.add("map-model-stats-div"),b.appendChild(e);let t=document.createElement("p");t.classList.add("challenge-stats-header","black-outline"),t.innerHTML="Challenge Stats",e.appendChild(t);let a=document.createElement("div");a.classList.add("challenge-stats-left-right"),e.appendChild(a);let l=document.createElement("div");l.classList.add("challenge-stats-left"),a.appendChild(l);let d=document.createElement("div");if(d.classList.add("challenge-usv-div"),l.appendChild(d),0!=n.Upvotes){let e=document.createElement("div");e.classList.add("challenge-upvote-div"),d.appendChild(e);let t=document.createElement("img");t.classList.add("challenge-upvote-icon"),t.src="./Assets/UI/ChallengeThumbsUpIcon.webp",e.appendChild(t);let a=document.createElement("p");a.classList.add("challenge-upvote-value"),a.innerHTML=n.Upvotes,e.appendChild(a)}let s=document.createElement("div");s.classList.add("challenge-trophy-div"),d.appendChild(s);let i=document.createElement("img");i.classList.add("challenge-trophy-icon"),i.src="./Assets/UI/ChallengeTrophyIcon.webp",s.appendChild(i);let o=document.createElement("p");o.classList.add("challenge-trophy-value"),o.innerHTML=n["Player Completion Rate"],s.appendChild(o);let r=document.createElement("div");r.classList.add("challenge-skull-div"),d.appendChild(r);let c=document.createElement("img");c.classList.add("challenge-skull-icon"),c.src="./Assets/UI/DeathRateIcon.webp",r.appendChild(c);let p=document.createElement("p");if(p.classList.add("challenge-skull-value"),p.innerHTML=n["Player Win Rate"],r.appendChild(p),"n/a"!=n.Creator&&null!=n.Creator){let e=document.createElement("div");e.classList.add("challenge-creator"),l.appendChild(e);let t=document.createElement("div");t.classList.add("avatar"),e.appendChild(t);let a=50,d=document.createElement("img");d.classList.add("avatar-frame","noSelect"),d.style.width=`${a}px`,d.src="../Assets/UI/InstaTowersContainer.webp",t.appendChild(d);let s=document.createElement("img");s.classList.add("avatar-img","noSelect"),s.style.width=`${a}px`,s.src="../Assets/ProfileAvatar/ProfileAvatar01.webp",t.appendChild(s);let i=document.createElement("p");i.classList.add("challenge-creator-name","black-outline"),i.innerHTML=B?"Click to Load Creator":"Loading...",e.appendChild(i),e.addEventListener("click",(async()=>{i.innerHTML="Loading...";let t=await ae(n.Creator);null!=t?(i.innerHTML=t.displayName,s.src=De(t),e.style.backgroundImage=`linear-gradient(to right, transparent 80%, var(--profile-secondary) 100%),url(${$e(t)})`,e.removeEventListener("click",arguments.callee),e.addEventListener("click",(()=>{Mn("map",n.Creator)}))):i.innerHTML="Click to Load Creator"})),B||e.click()}["Date Created","Game Version"].forEach((e=>{if("Game Version"==e&&0==n[e])return;let t=document.createElement("div");t.classList.add("challenge-stat"),l.appendChild(t);let a=document.createElement("p");a.classList.add("challenge-stat-label"),a.innerHTML=`${e}: ${n[e]}`,t.appendChild(a)}));let m=document.createElement("div");m.classList.add("challenge-stats-right"),a.appendChild(m),Object.entries(n.Stats).forEach((([e,t])=>{let a=document.createElement("div");a.classList.add("challenge-stat"),m.appendChild(a);let n=document.createElement("p");n.classList.add("challenge-stat-label"),n.innerHTML=e,a.appendChild(n);let l=document.createElement("p");l.classList.add("challenge-model-stat-value"),l.innerHTML=t.toLocaleString(),a.appendChild(l)}))}}function Un(){let e=document.getElementById("extras-content");e.innerHTML="";let t=document.createElement("div");t.classList.add("progress-page"),e.appendChild(t);let a=document.createElement("div");a.classList.add("selectors-div"),t.appendChild(a);let n=["Custom Round Sets","Collection Event Odds","Settings","Send Feedback","Use Code 'HalfHydra' <br>in the BTD6 Shop!"];$t||(n=n.filter((e=>"Collection Event Odds"!=e))),n.forEach((t=>{let n=document.createElement("div");n.classList.add("selector-div","blueprint-bg"),n.addEventListener("click",(()=>{e.style.display="none",document.getElementById("extras-content").style.display="flex",Gn(t)})),a.appendChild(n);let l=document.createElement("img");switch(l.classList.add("selector-img"),n.appendChild(l),t){case"Custom Round Sets":l.src="../Assets/ChallengeRulesIcon/CustomRoundIcon.webp";break;case"Collection Event Odds":l.src="../Assets/UI/CollectingEventTotemBtn.webp";break;case"Monkey Money Helper":default:l.src="../Assets/UI/WoodenRoundButton.webp";break;case"Send Feedback":l.src="../Assets/UI/FeedbackBtn.webp";break;case"Settings":l.src="../Assets/UI/OptionsBtn.webp";break;case"Use Code 'HalfHydra' <br>in the BTD6 Shop!":l.src="../Assets/UI/CreatorSupportBtn.webp"}let d=document.createElement("p");d.classList.add("selector-text","black-outline"),d.innerHTML=t,n.appendChild(d);let s=document.createElement("img");s.classList.add("selector-go-img"),s.src="../Assets/UI/ContinueBtn.webp",n.appendChild(s)}))}function Gn(e){switch(gl(),e){case"Custom Round Sets":jn();break;case"Collection Event Odds":da("progress"),rt="collection",ua("InstaMonkeys");break;case"Send Feedback":window.open("https://forms.gle/Tg1PuRNj2ftojMde6","_blank");break;case"Use Code 'HalfHydra' <br>in the BTD6 Shop!":Nn("CreatorSupport");break;case"Settings":Xn()}}function Nn(e){let t=document.getElementById("extras-content");t.innerHTML="";let a=document.createElement("div");a.classList.add("article-page"),t.appendChild(a);let n=document.createElement("div");a.appendChild(n);({CreatorSupport:[{type:"text",class:"site-info-header black-outline",content:"How to enter a creator code:"},{type:"panels",content:{1:{name:"Step 1",desc:"On the main menu after pressing start, navigate to the shop",img:"CS1"},2:{name:"Step 2",desc:"Press the creator support button on the bottom left",img:"CS2"},3:{name:"Step 3",desc:'Enter code "HalfHydra" (or any other creators code) and press submit. When purchasing anything in the store, a cut will go to the creator chosen.',img:"CS3"}}},{type:"text",class:"oak-instructions-text",content:"Creator support is a program offered by Ninja Kiwi that allows players to give a cut of the purchases you make in game to the creator who's code you've entered in the Bloons TD 6 shop. You can support me and my site by using the code \"HalfHydra\""}]})[e].forEach((e=>{switch(e.type){case"text":let t=document.createElement("p");e.class&&(t.className=e.class),t.innerHTML=e.content,n.appendChild(t);break;case"img":let a=document.createElement("img");e.class&&(a.className=e.class),a.src=`../Assets/UI/${e.content}`,n.appendChild(a);break;case"panels":let l=e.content,d=document.createElement("div");d.classList.add("insta-monkey-guide-container"),n.appendChild(d),Object.keys(l).forEach((e=>{let t=document.createElement("div");t.classList.add("insta-monkey-guide-method"),d.appendChild(t);let a=document.createElement("p");a.classList.add("insta-monkey-guide-method-text","black-outline"),a.innerHTML=l[e].name,t.appendChild(a);let n=document.createElement("p");n.classList.add("insta-monkey-guide-method-desc"),n.innerHTML=l[e].desc,t.appendChild(n);let s=document.createElement("img");s.classList.add("insta-monkey-guide-method-img"),s.src=`./Assets/UI/${l[e].img}.webp`,t.appendChild(s)}))}}))}function jn(){let e=document.getElementById("extras-content");e.innerHTML="";let t=document.createElement("div");t.classList.add("progress-page"),e.appendChild(t);let a=document.createElement("div");a.classList.add("selectors-div"),t.appendChild(a);let n={},l={};Object.entries(ze.limitedTimeEvents).forEach((([e,t])=>{t.end>Date.now()?n[e]=t:l[e]=t})),Object.entries(n).forEach((([e,t])=>{let n=document.createElement("div");n.classList.add("roundset-selector-div"),n.addEventListener("click",(()=>{Yt(),Fn("extras",t.roundset)})),a.appendChild(n);let l=document.createElement("img");switch(l.classList.add("roundset-selector-img"),n.appendChild(l),t.type){case"Race":l.src="../Assets/UI/EventRaceBtn.webp",n.classList.add("race-roundset");break;case"Odyssey":l.src="../Assets/UI/OdysseyEventBtn.webp",n.classList.add("odyssey-roundset");break;case"Boss":l.src=`../Assets/BossIcon/${t.boss[0].toUpperCase()+t.boss.slice(1)}EventIcon.webp`,n.classList.add("boss-roundset")}let d=document.createElement("div");d.classList.add("roundset-selector-text-div"),n.appendChild(d);let s=document.createElement("p");s.classList.add("selector-text","black-outline"),s.innerHTML=`${t.type} Event - ${e}`,d.appendChild(s);let i=document.createElement("p");i.id="time-left-"+e,i.classList.add("selector-text","black-outline"),d.appendChild(i),new Date<new Date(t.start)?i.innerHTML="Coming Soon!":new Date(t.end)>new Date&&(pl(new Date(t.end),i.id),ht=setInterval((()=>pl(new Date(t.end),i.id)),1e3));let o=document.createElement("img");o.classList.add("selector-go-img"),o.src="../Assets/UI/ContinueBtn.webp",n.appendChild(o)}));let d=Object.fromEntries(Object.entries(ze.roundSets).filter((([e,t])=>"quest"!=t.type))),s=Object.fromEntries(Object.entries(ze.roundSets).filter((([e,t])=>"quest"===t.type)));Object.entries(d).forEach((([e,t])=>{let n=document.createElement("div");n.classList.add("roundset-selector-div"),"boss"==t.type?n.classList.add("veteran-container"):n.classList.add("wood-container"),n.addEventListener("click",(()=>{Yt(),Fn("extras",e)})),a.appendChild(n);let l=document.createElement("img");l.classList.add("roundset-selector-img"),l.src=`../Assets/UI/${t.icon}.webp`,n.appendChild(l);let d=document.createElement("p");d.classList.add("selector-text","black-outline"),d.innerHTML=t.name,n.appendChild(d);let s=document.createElement("img");s.classList.add("selector-go-img"),s.src="../Assets/UI/ContinueBtn.webp",n.appendChild(s)}));let i=document.createElement("p");i.classList.add("other-roundsets-selector-text","black-outline"),i.innerHTML="Quest Custom Rounds",a.appendChild(i);let o=document.createElement("div");o.classList.add("other-roundsets-selector-div"),a.appendChild(o),Object.entries(s).forEach((([e,t])=>{let a=document.createElement("div");a.classList.add("other-roundset-selector-div"),a.addEventListener("click",(()=>{Fn("extras",e)})),o.appendChild(a);let n=document.createElement("p");n.classList.add("other-roundset-selector-text","black-outline");let l=e.match(/(Part|Stage)(\d+)/i);null!=l&&(n.innerHTML=`${l[1]} ${l[2]}`,a.appendChild(n));let d=document.createElement("img");d.classList.add("other-roundset-selector-img"),d.src=`../Assets/QuestIcon/${t.icon}.webp`,a.appendChild(d)}));let r=document.createElement("div");r.classList.add("known-previous-events-div"),a.appendChild(r);let c=document.createElement("p");c.classList.add("other-roundsets-selector-text","black-outline"),c.innerHTML="Known Previous Events",r.appendChild(c),Object.entries(l).forEach((([e,t])=>{let n=document.createElement("div");n.classList.add("roundset-selector-div"),n.addEventListener("click",(()=>{Yt(),Fn("extras",t.roundset)})),a.appendChild(n);let l=document.createElement("img");switch(l.classList.add("roundset-selector-img"),n.appendChild(l),t.type){case"Race":l.src="../Assets/UI/EventRaceBtn.webp",n.classList.add("race-roundset");break;case"Odyssey":l.src="../Assets/UI/OdysseyEventBtn.webp",n.classList.add("odyssey-roundset");break;case"Boss":l.src=`../Assets/BossIcon/${t.boss[0].toUpperCase()+t.boss.slice(1)}EventIcon.webp`,n.style.backgroundImage=`url(../Assets/EventBanner/EventBannerSmall${t.boss[0].toUpperCase()+t.boss.slice(1)}.webp)`,n.classList.add("boss-roundset")}let d=document.createElement("div");d.classList.add("roundset-selector-text-div"),n.appendChild(d);let s=document.createElement("p");s.classList.add("selector-text","black-outline"),s.innerHTML=`${t.type} Event - ${e}`,d.appendChild(s);let i=document.createElement("p");i.id="time-left-"+e,i.classList.add("selector-text","black-outline"),d.appendChild(i),new Date<new Date(t.start)?i.innerHTML="Coming Soon!":new Date(t.end)>new Date?(pl(new Date(t.end),i.id),ht=setInterval((()=>pl(new Date(t.end),i.id)),1e3)):i.innerHTML=`${new Date(t.start).toLocaleDateString()} - ${new Date(t.end).toLocaleDateString()}`;let o=document.createElement("img");o.classList.add("selector-go-img"),o.src="../Assets/UI/ContinueBtn.webp",n.appendChild(o)}));let p=document.createElement("div");p.classList.add("sku-roundset-selector-div"),a.appendChild(p);let m=document.createElement("p");m.classList.add("other-roundsets-selector-text","black-outline"),m.innerHTML="Other Custom Rounds",p.appendChild(m);let u=document.createElement("p");u.classList.add("sku-roundset-selector-desc"),u.innerHTML="These mostly old roundsets will have only been used in one-off events such as Odysseys, Races, or Bosses and may not have ended up being used for their intended purpose despite their name. Take these roundsets with a grain of salt. I'm including them on the viewer for completeness sake.",p.appendChild(u);let h=document.createElement("div");h.classList.add("sku-roundsets-selector-div"),p.appendChild(h),ze.skuRoundsets.forEach((e=>{let t=document.createElement("div");t.classList.add("sku-roundset-selector-div"),t.addEventListener("click",(()=>{Fn("extras",e)})),h.appendChild(t);let a=document.createElement("p");a.classList.add("sku-roundset-selector-text","black-outline"),a.innerHTML=e,t.appendChild(a)}))}async function Fn(e,t){let a=document.getElementById("roundset-content");a.style.display="flex",a.innerHTML="",document.getElementById(`${e}-content`).style.display="none",gl();let n=await fetch(`./data/${t}.json`).then((e=>e.json())),l="unknown";ze.roundSets[t]&&(l=ze.roundSets[t].type),vt=_n(n);let d=document.createElement("div");d.classList.add("roundset-header-bar"),a.appendChild(d);let s=document.createElement("div");s.classList.add("roundset-header-title"),d.appendChild(s);let i=document.createElement("div");i.classList.add("roundset-header-left"),s.appendChild(i);let o=document.createElement("p");o.classList.add("roundset-header-text","black-outline"),o.innerHTML=ze.roundSets[t]?ze.roundSets[t].name:t,s.appendChild(o);let r=document.createElement("div");r.classList.add("roundset-header-right"),s.appendChild(r);let c=document.createElement("img");c.classList.add("modal-close"),c.src="./Assets/UI/CloseBtn.webp",c.addEventListener("click",(()=>{a.style.display="none",document.getElementById(`${e}-content`).style.display="flex"})),r.appendChild(c);let p=document.createElement("div");p.classList.add("roundset-header-bar-bottom"),d.appendChild(p);let m=document.createElement("div");m.classList.add("maps-progress-views"),p.appendChild(m);let u=document.createElement("p");u.classList.add("maps-progress-coop-toggle-text","maps-progress-view-list","black-outline"),u.innerHTML="Display Type:",m.appendChild(u);let h=document.createElement("div");h.classList.add("maps-progress-view","stats-tab-yellow","black-outline"),h.innerHTML="Simple",m.appendChild(h);let g=document.createElement("div");g.classList.add("maps-progress-view","black-outline"),g.innerHTML="Detailed",m.appendChild(g);let L=document.createElement("div");L.classList.add("maps-progress-view","black-outline"),L.innerHTML="Preview",m.appendChild(L);let b=document.createElement("div");b.classList.add("maps-progress-filter"),p.appendChild(b);let y=document.createElement("div");y.classList.add("map-progress-filter-difficulty");let v=document.createElement("p");v.classList.add("maps-progress-coop-toggle-text","black-outline"),y.appendChild(v);let C=document.createElement("input");C.id="roundset-modified-checkbox",C.classList.add("maps-progress-coop-toggle-input"),C.type="checkbox",y.appendChild(C),"boss"==l?(ft=[],vt.rounds.forEach(((e,t)=>{e.hasOwnProperty("modified")&&ft.push(e.roundNumber)})),C.checked=!0,b.appendChild(y),v.innerHTML="Only Modified:",Ue="modified",kt=C):"quest"==l?(ft=[],vt.rounds.forEach(((e,a)=>{e.roundNumber>ze.roundSets[t].endRound||ft.push(e.roundNumber)})),v.innerHTML="Hide Unused:",Ue="unused",Tt=ze.roundSets[t].endRound,b.appendChild(y),C.checked=!0,kt=C):kt=null;let E=document.createElement("div");E.classList.add("maps-progress-coop-toggle"),b.appendChild(E);let w=document.createElement("p");w.classList.add("maps-progress-coop-toggle-text","black-outline"),w.innerHTML="Reverse:",E.appendChild(w);let k=document.createElement("input");k.id="roundset-reverse-checkbox",k.classList.add("maps-progress-coop-toggle-input"),k.type="checkbox",E.appendChild(k);let f=document.createElement("div");f.id="rounds-content",f.classList.add("rounds-content"),a.appendChild(f),h.addEventListener("click",(()=>{h.classList.add("stats-tab-yellow"),g.classList.remove("stats-tab-yellow"),L.classList.remove("stats-tab-yellow"),yt="Simple",qn(yt,k.checked,C.checked)})),g.addEventListener("click",(()=>{g.classList.add("stats-tab-yellow"),h.classList.remove("stats-tab-yellow"),L.classList.remove("stats-tab-yellow"),yt="Topper",qn(yt,k.checked,C.checked)})),L.addEventListener("click",(()=>{L.classList.add("stats-tab-yellow"),h.classList.remove("stats-tab-yellow"),g.classList.remove("stats-tab-yellow"),yt="Preview",qn(yt,k.checked,C.checked)})),k.addEventListener("change",(()=>{zn(k.checked)})),C.addEventListener("change",(()=>{Kn(C.checked)})),Ct=0,yt="Simple",qn(yt,k.checked,C.checked),Kn(C.checked)}function _n(e,t){return null!=t&&t.rounds.forEach(((t,a)=>{let n=e.rounds.findIndex((e=>e.roundNumber==t.roundNumber));t.addToRound?-1!=n&&(e.rounds[n].bloonGroups=e.rounds[n].bloonGroups.concat(t.bloonGroups),e.rounds[n].addToRound=!0):-1!=n&&(e.rounds[n]=t)})),e}async function qn(e,t,a){let n=document.getElementById("rounds-content");n.innerHTML="";let l=!0,d=[];vt.rounds.forEach(((e,t)=>{d.push(e.roundNumber)}));for(let e=0;e<d.length;e++)if(d[e]!=e+1){l=!1;break}switch(e){case"Simple":Jn();let e=!1;vt.rounds.forEach((async(t,a)=>{let l=document.createElement("div");l.id=`round-${t.roundNumber}`,l.classList.add("round-div"),e&&l.classList.add("round-div-alt");let d=document.createElement("p");d.classList.add("round-number","black-outline"),d.innerHTML=t.roundNumber,l.appendChild(d);let s=document.createElement("div");s.id=`round-${t.roundNumber}-groups`,s.classList.add("round-bloon-groups"),l.appendChild(s);let i=document.createDocumentFragment();t.bloonGroups.sort(((e,t)=>e.start-t.start)).forEach(((e,t)=>{let a=document.createElement("div");a.classList.add("bloon-group-div");let n=document.createElement("p");n.classList.add("bloon-group-number","black-outline"),n.innerHTML="x"+e.count,a.appendChild(n);let l=document.createElement("img");l.classList.add("bloon-group-bloon"),l.src=`../Assets/BloonIcon/${e.bloon}.webp`,l.loading="lazy",a.appendChild(l),i.appendChild(a)})),s.appendChild(i),n.appendChild(l),e=!e})),document.getElementById("roundset-reverse-checkbox").checked&&zn(),null!=kt&&kt.checked&&Kn(!0);break;case"Topper":Jn();let a=document.createElement("div");a.classList.add("rounds-detailed-div"),n.appendChild(a),il(a),setTimeout((()=>{let e=document.createDocumentFragment(),n=document.createElement("div");n.classList.add("disclaimer-div"),e.appendChild(n);let d=document.createElement("p");d.classList.add("disclaimer"),d.innerHTML="This layout is based on Topper's website:",n.appendChild(d);let s=document.createElement("a");s.classList.add("disclaimer-link"),s.href="https://topper64.co.uk/nk/btd6/rounds/",s.target="_blank",s.innerHTML="Topper's Round Information",n.appendChild(s);vt.rounds.forEach((async(a,n)=>{let d=document.createElement("div");d.id=`round-${a.roundNumber}`,d.classList.add("round-div-detailed"),t&&d.classList.add("round-div-reverse");let s=document.createElement("div");s.classList.add("rounds-div-header"),d.appendChild(s);let i=document.createElement("p");i.classList.add("round-number","round-number-detailed","black-outline"),i.innerHTML=`Round ${a.roundNumber}`,s.appendChild(i);let o=document.createElement("div");o.classList.add("income-div"),s.appendChild(o);let r=document.createElement("img");r.classList.add("income-img"),r.src="../Assets/UI/CoinIcon.webp",o.appendChild(r);let c=document.createElement("div");c.classList.add("income-text-div"),o.appendChild(c);let p=document.createElement("p");p.classList.add("round-income","black-outline"),p.innerHTML=`Income: ${a.income.toLocaleString()}`,c.appendChild(p);let m=document.createElement("p");m.classList.add("round-income-total","black-outline"),m.innerHTML=`Total: ${a.incomeSum.toLocaleString()}`,l&&c.appendChild(m);let u=document.createElement("div");u.classList.add("rbe-div"),s.appendChild(u);let h=document.createElement("img");h.classList.add("rbe-img"),h.src="../Assets/BloonIcon/Red.webp",u.appendChild(h);let g=document.createElement("div");g.classList.add("rbe-text-div"),u.appendChild(g);let L=document.createElement("p");L.classList.add("round-rbe","black-outline"),L.innerHTML=`RBE: ${a.rbe.toLocaleString()}`,g.appendChild(L);let b=document.createElement("p");b.classList.add("round-rbe-total","black-outline"),b.innerHTML=`Total: ${a.rbeSum.toLocaleString()}`,l&&g.appendChild(b);let y=a.bloonGroups.length?Math.max(...a.bloonGroups.map((e=>e.end))):0,v=document.createElement("p");v.classList.add("round-duration","black-outline"),v.innerHTML=`Duration: ${y.toFixed(2)}s`,s.appendChild(v);let C=document.createElement("div");C.classList.add("timeline-div"),d.appendChild(C),a.bloonGroups.forEach(((e,t)=>{let a=document.createElement("div");a.classList.add("bloon-group-div-detailed"),C.appendChild(a);let n=document.createElement("div");n.classList.add("left-div"),a.appendChild(n);let l=document.createElement("img");l.classList.add("bloon-image"),l.src=`../Assets/BloonIcon/${e.bloon}.webp`,n.appendChild(l);let d=document.createElement("p");d.classList.add("bloon-count","black-outline"),d.innerHTML="x"+e.count,n.appendChild(d);let s=document.createElement("div");s.classList.add("timeline-right-div"),a.appendChild(s);let i=document.createElement("div");i.classList.add("bloon-bar"),s.appendChild(i);let o=document.createElement("div");o.classList.add("bloon-bar-fill"),o.style.background=Cl[e.bloon.replace("Camo","").replace("Regrow","").replace("Fortified","")].color,e.bloon.includes("Rainbow")||(o.style.border=`4px solid ${Cl[e.bloon.replace("Camo","").replace("Regrow","").replace("Fortified","")].border}`);let r=(e.end-e.start)/y*100,c=e.start/y*100;r<5&&(r=5),c+r>100&&(c=100-r),o.style.width=`${r}%`,o.style.left=`${c}%`,i.appendChild(o)})),e.appendChild(d)})),a.innerHTML="",a.appendChild(e),document.getElementById("roundset-reverse-checkbox").checked&&zn(),null!=kt&&kt.checked&&Kn(!0)}),0);break;case"Preview":Jn();let d=document.createElement("div");d.classList.add("preview-container-div"),n.appendChild(d);let s=document.createElement("div");s.classList.add("preview-div"),d.appendChild(s);let i=document.createElement("div");i.classList.add("preview-header"),s.appendChild(i);let o=document.createElement("p");o.id="round-number-preview",o.classList.add("round-number","round-number-preview","black-outline"),o.innerHTML=`Round ${vt.rounds[Ct].roundNumber}`,i.appendChild(o);let r=document.createElement("input");r.id="select-round-num-preview",r.classList.add("select-round-num"),r.type="number",r.min=1,r.max=vt.rounds.length,r.value=Ct+1,r.addEventListener("change",(()=>{r.value<1&&(r.value=1),r.value>vt.rounds.length&&(r.value=vt.rounds.length),o.innerHTML=`Round ${vt.rounds[Ct].roundNumber}`,Ct=r.value-1,Wn()})),i.appendChild(r);let c=document.createElement("div");c.classList.add("preview-right-div"),i.appendChild(c);let p=document.createElement("img");p.classList.add("clear-button"),p.src="../Assets/UI/DestroyBloonsBtn.webp",p.addEventListener("click",(()=>{Yn()})),c.appendChild(p);let m=document.createElement("img");m.classList.add("play-normal-button"),m.src="../Assets/UI/GoBtnSmall.webp",m.addEventListener("click",(()=>{vl=1,o.innerHTML=`Round ${vt.rounds[Ct].roundNumber}`,Yn(),xl(vt.rounds[Ct])})),c.appendChild(m);let u=document.createElement("img");u.classList.add("play-fast-button"),u.src="../Assets/UI/FastForwardBtn.webp",u.addEventListener("click",(()=>{vl=3,o.innerHTML=`Round ${vt.rounds[Ct].roundNumber}`,Yn(),xl(vt.rounds[Ct])})),c.appendChild(u),sa=document.createElement("canvas"),sa.classList.add("roundset-canvas"),sa.width=800,sa.height=300,s.appendChild(sa);let h=document.createElement("div");h.classList.add("preview-footer-div"),s.appendChild(h);let g=document.createElement("div");g.classList.add("difficulty-div"),h.appendChild(g);let L=document.createElement("div");L.classList.add("maps-progress-view","stats-tab-yellow","black-outline"),L.innerHTML="Easy",g.appendChild(L);let b=document.createElement("div");b.classList.add("maps-progress-view","black-outline"),b.innerHTML="Medium",g.appendChild(b);let y=document.createElement("div");y.classList.add("maps-progress-view","black-outline"),y.innerHTML="Hard",g.appendChild(y),L.addEventListener("click",(()=>{Il=1,L.classList.add("stats-tab-yellow"),b.classList.remove("stats-tab-yellow"),y.classList.remove("stats-tab-yellow")})),b.addEventListener("click",(()=>{Il=1.1,L.classList.remove("stats-tab-yellow"),b.classList.add("stats-tab-yellow"),y.classList.remove("stats-tab-yellow")})),y.addEventListener("click",(()=>{Il=1.26,L.classList.remove("stats-tab-yellow"),b.classList.remove("stats-tab-yellow"),y.classList.add("stats-tab-yellow")}));let v=document.createElement("div");v.classList.add("next-prev-div"),h.appendChild(v);let C=document.createElement("div");C.classList.add("maps-progress-view","black-outline"),C.innerHTML="Previous",C.addEventListener("click",(()=>{null!=kt&&kt.checked?(Et--,Et<0&&(Et=ft.length-1),Ct=ft[Et]-1):(Ct--,Ct<0&&(Ct=vt.rounds.length-1)),r.value=Ct+1,Yn(),Wn()})),v.appendChild(C);let E=document.createElement("div");E.classList.add("maps-progress-view","black-outline"),E.innerHTML="Next",E.addEventListener("click",(()=>{null!=kt&&kt.checked?(Et++,Et>=ft.length&&(Et=0),Ct=ft[Et]-1):(Ct++,Ct>=vt.rounds.length&&(Ct=0)),r.value=Ct+1,Yn(),Wn()})),v.appendChild(E);let w=document.createElement("div");w.id="preview-round-info-div",w.classList.add("round-info-div"),s.appendChild(w),ia=sa.getContext("2d");let k=performance.now();wt=!0,requestAnimationFrame((function e(){if(!wt)return;const t=performance.now(),a=(t-k)/1e3;k=t,Hl(a),Sl(),requestAnimationFrame(e)})),null!=kt&&kt.checked&&Kn(!0),Wn(),document.getElementById("roundset-reverse-checkbox").checked&&zn()}}function Kn(e){switch(yt){case"Simple":let t=!1;vt.rounds.forEach((async(a,n)=>{let l=document.getElementById(`round-${a.roundNumber}`);e&&"modified"===Ue&&!a.hasOwnProperty("modified")||e&&"unused"===Ue&&a.roundNumber>Tt?l.style.display="none":(l.style.display="flex",t?l.classList.add("round-div-alt"):Array.from(l.classList).includes("round-div-alt")&&l.classList.remove("round-div-alt"),t=!t)}));break;case"Topper":vt.rounds.forEach((async(t,a)=>{let n=document.getElementById(`round-${t.roundNumber}`);e&&"modified"===Ue&&!t.hasOwnProperty("modified")||e&&"unused"===Ue&&t.roundNumber>Tt?n.style.display="none":n.style.display="flex"}));break;case"Preview":switch(Ue){case"modified":e?(Et=0,Ct=ft[0]-1,document.getElementById("round-number-preview").innerHTML=`Round ${ft[0]}`,document.getElementById("select-round-num-preview").value=ft[0],Wn()):(Ct=0,document.getElementById("round-number-preview").innerHTML=`Round ${Ct+1}`,document.getElementById("select-round-num-preview").value=Ct+1,Wn());break;case"unused":e?Tt<Ct+1&&(Ct=0,document.getElementById("round-number-preview").innerHTML=`Round ${Ct+1}`,document.getElementById("select-round-num-preview").value=Ct+1,Wn()):(Ct=0,document.getElementById("round-number-preview").innerHTML=`Round ${Ct+1}`,document.getElementById("select-round-num-preview").value=Ct+1,Wn())}}}function zn(){switch(yt){case"Simple":vt.rounds.forEach(((e,t)=>{let a=document.getElementById(`round-${e.roundNumber}-groups`);Array.from(a.children).reverse().forEach((e=>a.appendChild(e)))}));break;case"Topper":let e=document.getElementsByClassName("timeline-div");for(let t of e)t.classList.toggle("timeline-div-reverse");let t=document.getElementsByClassName("timeline-right-div");for(let e of t)e.classList.toggle("flip-horizontal");break;case"Preview":document.getElementById("preview-timeline-div").classList.toggle("timeline-div-reverse");let a=document.getElementsByClassName("preview-timeline-right-div");for(let e of a)e.classList.toggle("flip-horizontal")}Yn()}function Wn(){let e=document.getElementById("preview-round-info-div");e.innerHTML="";let t=vt.rounds[Ct];Mt=[];let a=document.createElement("div");a.classList.add("round-div-detailed"),e.appendChild(a);let n=document.createElement("div");n.classList.add("rounds-div-header"),a.appendChild(n);let l=document.createElement("p");l.classList.add("round-number","round-number-detailed","black-outline"),l.innerHTML=`Round ${t.roundNumber}`,n.appendChild(l);let d=document.createElement("div");d.classList.add("income-div"),n.appendChild(d);let s=document.createElement("img");s.classList.add("income-img"),s.src="../Assets/UI/CoinIcon.webp",d.appendChild(s);let i=document.createElement("div");i.classList.add("income-text-div"),d.appendChild(i);let o=document.createElement("p");o.classList.add("round-income","black-outline"),o.innerHTML=`Income: ${t.income.toLocaleString()}`,i.appendChild(o);let r=document.createElement("p");r.classList.add("round-income-total","black-outline"),r.innerHTML=`Total: ${t.incomeSum.toLocaleString()}`,i.appendChild(r);let c=document.createElement("div");c.classList.add("rbe-div"),n.appendChild(c);let p=document.createElement("img");p.classList.add("rbe-img"),p.src="../Assets/BloonIcon/Red.webp",c.appendChild(p);let m=document.createElement("div");m.classList.add("rbe-text-div"),c.appendChild(m);let u=document.createElement("p");u.classList.add("round-rbe","black-outline"),u.innerHTML=`RBE: ${t.rbe.toLocaleString()}`,m.appendChild(u);let h=document.createElement("p");h.classList.add("round-rbe-total","black-outline"),h.innerHTML=`Total: ${t.rbeSum.toLocaleString()}`,m.appendChild(h);let g=t.bloonGroups.length?Math.max(...t.bloonGroups.map((e=>e.end))):0,L=document.createElement("p");L.classList.add("round-duration","black-outline"),L.innerHTML=`Duration: ${g.toFixed(2)}s`,n.appendChild(L);let b=document.createElement("div");b.id="preview-timeline-div",b.classList.add("timeline-div"),a.appendChild(b);t.bloonGroups.forEach(((e,t)=>{let a=document.createElement("div");a.classList.add("bloon-group-div-detailed"),a.addEventListener("click",(()=>{Mt.includes(t)?(a.style.filter="",Mt.splice(Mt.indexOf(t),1)):(Mt.push(t),a.style.filter="brightness(0.5)")})),b.appendChild(a);let n=document.createElement("div");n.classList.add("left-div"),a.appendChild(n);let l=document.createElement("img");l.classList.add("bloon-image"),l.src=`../Assets/BloonIcon/${e.bloon}.webp`,n.appendChild(l);let d=document.createElement("p");d.classList.add("bloon-count","black-outline"),d.innerHTML="x"+e.count,n.appendChild(d);let s=document.createElement("div");s.classList.add("timeline-right-div","preview-timeline-right-div"),a.appendChild(s);let i=document.createElement("div");i.classList.add("bloon-bar"),s.appendChild(i);let o=document.createElement("div");o.classList.add("bloon-bar-fill"),o.style.background=Cl[e.bloon.replace("Camo","").replace("Regrow","").replace("Fortified","")].color,e.bloon.includes("Rainbow")||(o.style.border=`4px solid ${Cl[e.bloon.replace("Camo","").replace("Regrow","").replace("Fortified","")].border}`);let r=(e.end-e.start)/g*100,c=e.start/g*100;r<5&&(r=5),c+r>100&&(c=100-r),o.style.width=`${r}%`,o.style.left=`${c}%`,i.appendChild(o)})),document.getElementById("roundset-reverse-checkbox").checked&&zn()}function Vn(e){let t=document.getElementById("preview-timeline-div"),a=document.createElement("div");a.id="preview-playhead",a.classList.add("playhead"),t.appendChild(a),a.style.animation=`playhead ${e}s linear`,a.addEventListener("animationend",(function(){a.remove()}))}function Yn(){document.getElementById("preview-playhead")&&document.getElementById("preview-playhead").remove(),Ml=null,Tl.length=0}function Jn(){wt=!1,Yn()}function Zn(){let e=document.createElement("div");e.classList.add("switch");let t=document.createElement("input");t.type="checkbox",t.checked=!0,e.appendChild(t);let a=document.createElement("span");return a.classList.add("slider","round"),e.appendChild(a),e}function Xn(){let e=document.getElementById("extras-content");e.innerHTML="";let t={ProfileLoading:{name:"Load Profiles Automatically",description:"When switched on, user profiles on leaderboards and the content browser will load and display user cosmetics. Otherwise user profiles will need to be clicked to be loaded. This option may cause you to be rate limited much faster (you will need to wait a few minutes before loading any new content from the Ninja Kiwi API on the site if you reach a threshold).",input:"toggle"},UseNamedMonkeys:{name:"Use Named Monkeys Nicknames",description:"When switched on, the site will use the nicknames you've set for towers instead of the tower names.",input:"toggle"},TeamsStoreItems:{name:"Show Teams Store Items in Progress Tab",description:"When switched on, the progress tab will show collected team store items. I don't have a way to test this so it may not work.",input:"toggle"}},a=document.createElement("div");a.classList.add("article-page"),e.appendChild(a);let n=document.createElement("p");n.classList.add("hero-progress-header-text","settings-text"),n.innerHTML="Settings",a.appendChild(n);let l=document.createElement("div");l.classList.add("settings-options-container"),a.appendChild(l);for(let e in t){let a=document.createElement("div");a.classList.add("setting-div"),l.appendChild(a);let n=document.createElement("p");n.classList.add("insta-monkey-guide-method-text","black-outline"),n.innerHTML=t[e].name,a.appendChild(n);let d=document.createElement("div");d.classList.add("setting-info-div"),a.appendChild(d);let s=document.createElement("p");s.classList.add("insta-monkey-guide-method-desc","setting-desc"),s.innerHTML=t[e].description,d.appendChild(s);let i=document.createElement("label");i.classList.add("setting-input-label"),d.appendChild(i);let o=document.createElement("input");if(o.classList.add("setting-input"),i.appendChild(o),"toggle"===t[e].input){let e=document.createElement("span");e.classList.add("toggle-img","slider"),e.src="../Assets/UI/BlueBtnCircleSmall.webp",i.appendChild(e),o.type="checkbox",i.classList.add("switch")}switch(e){case"ProfileLoading":o.checked=!B,o.addEventListener("change",(()=>{B=!o.checked,bl()}));break;case"UseNamedMonkeys":o.checked=tt,o.addEventListener("change",(()=>{tt=!tt,bl()}));break;case"TeamsStoreItems":o.checked=Dt,o.addEventListener("change",(()=>{Dt=!Dt,bl()}))}}}function Qn(){let e=document.getElementById("progress-content");e.innerHTML="";let t=document.createElement("div");t.classList.add("trophy-store-progress-container"),e.appendChild(t);let a=document.createElement("div");a.classList.add("trophy-store-header-bar"),t.appendChild(a);let n=document.createElement("div");n.classList.add("achievements-header-bar"),a.appendChild(n);let l=document.createElement("div");a.appendChild(l);let d=document.createElement("div");d.classList.add("sub-filter-container"),d.style.display="none",l.appendChild(d);let s=document.createElement("div");s.classList.add("maps-progress-views"),n.appendChild(s);let i=document.createElement("div");i.classList.add("map-progress-filter-difficulty"),s.appendChild(i);let o=document.createElement("p");o.classList.add("maps-progress-coop-toggle-text","black-outline"),o.innerHTML="Filter:",i.appendChild(o);let r=document.createElement("select");r.classList.add("map-progress-filter-difficulty-select");["All","Heroes","Monkeys","Bloons","Coop","Game & UI"].forEach((e=>{let t=document.createElement("option");t.value="Game & UI"===e?"GameUI":e,t.innerHTML=e,r.appendChild(t)})),i.appendChild(r);let c=document.createElement("p");c.classList.add("trophy-store-item-counter","black-outline"),c.innerHTML="0/0",n.appendChild(c),r.addEventListener("change",(()=>{var e;At="All","All"!==r.value?(e=r.value,d.innerHTML="",d.style.display="flex",Pt[e].forEach((e=>{let t=document.createElement("div");t.classList.add("maps-progress-view","sub-filter","black-outline"),"All"===e&&t.classList.add("stats-tab-yellow"),t.innerHTML=Re(`Filter${e}`),t.addEventListener("click",(()=>{At=e,Array.from(d.children).forEach((e=>{e===t?e.classList.add("stats-tab-yellow"):e.classList.remove("stats-tab-yellow")})),el(r.value,h.value,c)})),d.appendChild(t)}))):d.style.display="none",el(r.value,h.value,c)}));let p=document.createElement("div");p.classList.add("maps-progress-filter"),n.appendChild(p);let m=document.createElement("div");m.classList.add("map-progress-filter-difficulty"),p.appendChild(m);let u=document.createElement("p");u.classList.add("maps-progress-coop-toggle-text","black-outline"),u.innerHTML="Display:",m.appendChild(u);let h=document.createElement("select");h.classList.add("map-progress-filter-difficulty-select"),h.addEventListener("change",(()=>{el(r.value,h.value,c)}));["All","Owned","Unowned","Hidden"].forEach((e=>{let t=document.createElement("option");t.value=e,t.innerHTML=e,h.appendChild(t)})),m.appendChild(h);let g=document.createElement("div");g.id="trophy-store-items-container",g.classList.add("trophy-store-items-container"),t.appendChild(g),el("All","All",c)}function el(e,t,a){let l=document.getElementById("trophy-store-items-container");l.innerHTML="";let d=JSON.parse(JSON.stringify(qe));for(let e of ze.unreleasedContent.trophyStoreItems)delete d[e];switch("All"!==e&&(d=Object.fromEntries(Object.entries(d).filter((([t,a])=>a.storeFilter===e)))),"All"!==At&&(d=Object.fromEntries(Object.entries(d).filter((([e,t])=>t.subFilter===At)))),t){case"All":break;case"Unowned":d=Object.fromEntries(Object.entries(d).filter((([e,t])=>!n.trophyStoreItems.hasOwnProperty(e)||!n.trophyStoreItems[e])));break;case"Owned":d=Object.fromEntries(Object.entries(d).filter((([e,t])=>n.trophyStoreItems.hasOwnProperty(e)&&n.trophyStoreItems[e])));break;case"Hidden":d=Object.fromEntries(Object.entries(d).filter((([e,t])=>t.hidden))),d=Object.fromEntries(Object.entries(d).sort((([e,t],[a,l])=>!n.trophyStoreItems.hasOwnProperty(e)||!n.trophyStoreItems[e]||n.trophyStoreItems.hasOwnProperty(a)&&n.trophyStoreItems[a]?n.trophyStoreItems.hasOwnProperty(e)&&n.trophyStoreItems[e]||!n.trophyStoreItems.hasOwnProperty(a)||!n.trophyStoreItems[a]?0:-1:1)))}switch(t){case"Unowned":case"Owned":a.innerHTML=`${Object.keys(d).length} Items`;break;default:a.innerHTML=`${Object.keys(d).filter((e=>n.trophyStoreItems.hasOwnProperty(e)&&n.trophyStoreItems[e])).length}/${Object.keys(d).length} Owned`}0==Object.keys(d).length&&(a.innerHTML="No Items Match");for(let[e,t]of Object.entries(d)){let a=document.createElement("div");a.classList.add("trophy-store-item-div"),l.appendChild(a);let d=document.createElement("img");d.classList.add("trophy-store-item-img","trophy-store-item-div"),d.src="Avatar"===t.itemType?`../Assets/ProfileAvatar/${t.icon}.webp`:`../Assets/TrophyStoreIcon/${t.icon}.webp`,a.appendChild(d),d.loading="lazy",a.addEventListener("click",(()=>{tl(e)}));let s=document.createElement("p");if(s.classList.add("trophy-store-item-text"),s.innerHTML=Re(`${e}ShortName`),a.appendChild(s),"TextEmotes"===t.subFilter){let t=document.createElement("p");t.classList.add("trophy-store-item-text-emote","black-outline"),t.innerHTML=Re("CoopEmoteAnimationHappyHolidays"===e?`${e}ShortName`:`${e}Word`),a.appendChild(t)}if(n.trophyStoreItems.hasOwnProperty(e)&&n.trophyStoreItems[e]){let e=document.createElement("p");e.classList.add("trophy-store-collected-text","black-outline"),e.innerHTML="Owned",a.appendChild(e),d.style.borderImageSource="url(../Assets/UI/TrophyBGPanelBlue.webp)"}let i=document.createElement("img");i.classList.add("trophy-store-item-type-icon"),i.src=`../Assets/UI/Trophy${t.storeFilter}Icon.webp`,a.appendChild(i)}}function tl(e){let t=qe[e],a=document.createElement("div");a.classList.add("error-modal-overlay"),document.body.appendChild(a);let l=document.createElement("div");l.classList.add("collection-modal"),a.appendChild(l);let d=document.createElement("div");d.classList.add("collection-modal-header"),l.appendChild(d);let s=document.createElement("div");s.classList.add("collection-header-modal-left"),d.appendChild(s);let i=document.createElement("p");i.classList.add("collection-modal-header-text","black-outline"),i.innerHTML=Re(`${e}ShortName`),d.appendChild(i);let o=document.createElement("img");o.classList.add("collection-modal-close"),o.src="./Assets/UI/CloseBtn.webp",o.addEventListener("click",(()=>{a.remove()})),d.appendChild(o);let r=document.createElement("div");r.classList.add("item-img-and-details"),l.appendChild(r);let c=document.createElement("div");c.classList.add("modal-trophy-div"),r.appendChild(c);let p=document.createElement("img");if(p.classList.add("trophy-store-item-img","trophy-store-item-div","modal-trophy-item"),p.src="Avatar"===t.itemType?`../Assets/ProfileAvatar/${t.icon}.webp`:`../Assets/TrophyStoreIcon/${t.icon}.webp`,c.appendChild(p),"TextEmotes"===t.subFilter){let t=document.createElement("p");t.classList.add("trophy-store-item-text-emote-popout","black-outline"),t.innerHTML=Re("CoopEmoteAnimationHappyHolidays"===e?`${e}ShortName`:`${e}Word`),c.appendChild(t)}n.trophyStoreItems.hasOwnProperty(e)&&n.trophyStoreItems[e]&&(p.style.borderImageSource="url(../Assets/UI/TrophyBGPanelBlue.webp)");let m=document.createElement("div");m.classList.add("item-details-div"),r.appendChild(m);let u=document.createElement("p");u.classList.add("trophy-store-item-full-name","black-outline"),u.innerHTML=Re(`${e}Name`),m.appendChild(u);let h=document.createElement("p");h.classList.add("trophy-store-item-description"),h.innerHTML=Re(`${e}Description`),m.appendChild(h);let g=document.createElement("p");if(g.classList.add("trophy-store-item-obtain-method"),m.appendChild(g),t.hasOwnProperty("obtainMethod"))switch(t.obtainMethod){case"Quest":g.innerHTML="Obtained by completing a quest";break;case"Limited":g.innerHTML="Obtained during a limited time event";break;case"Rogue":g.innerHTML="Obtained by unlocking a feat in Rogue Legends";break;case"Nexus":g.innerHTML="Obtained by purchasing anything in the store with a Nexus Creator Code applied";break;case"Purchase":g.innerHTML="Obtained by purchasing the associated bundle in the store"}t.hidden&&!t.hasOwnProperty("obtainMethod")&&(g.innerHTML="This item is hidden and may show up in the featured tab during the related seasonal rotation.")}function al(){let e=document.getElementById("progress-content");e.innerHTML="";let t=document.createElement("div");t.classList.add("powers-progress-container"),e.appendChild(t);let a=JSON.parse(JSON.stringify(Ke));for(let e of ze.unreleasedContent.teamsStoreItems)delete a[e];for(let[e,l]of Object.entries(a)){if(l.isDefault)continue;let a=document.createElement("div");a.classList.add("trophy-store-item-div"),t.appendChild(a),a.addEventListener("click",(()=>{nl(e)}));let d=document.createElement("img");d.classList.add("trophy-store-item-img","trophy-store-item-div","teams-store-unowned"),d.src="Avatar"===l.itemType?`../Assets/ProfileAvatar/${l.icon}.webp`:`../Assets/TeamsStoreIcon/${l.icon}.webp`,a.appendChild(d);let s=document.createElement("p");if(s.classList.add("trophy-store-item-text"),s.innerHTML=Re(`${e}ShortName`),a.appendChild(s),n.trophyStoreItems.hasOwnProperty(e)&&n.trophyStoreItems[e]){let e=document.createElement("p");e.classList.add("trophy-store-collected-text","black-outline"),e.innerHTML="Owned",a.appendChild(e),d.classList.add("teams-store-owned")}}}function nl(e){let t=Ke[e],a=document.createElement("div");a.classList.add("error-modal-overlay"),document.body.appendChild(a);let l=document.createElement("div");l.classList.add("collection-modal"),a.appendChild(l);let d=document.createElement("div");d.classList.add("collection-modal-header"),l.appendChild(d);let s=document.createElement("div");s.classList.add("collection-header-modal-left"),d.appendChild(s);let i=document.createElement("p");i.classList.add("collection-modal-header-text","black-outline"),i.innerHTML=Re(`${e}ShortName`),d.appendChild(i);let o=document.createElement("img");o.classList.add("collection-modal-close"),o.src="./Assets/UI/CloseBtn.webp",o.addEventListener("click",(()=>{a.remove()})),d.appendChild(o);let r=document.createElement("div");r.classList.add("item-img-and-details"),r.style.backgroundImage="url(../Assets/UI/TeamStoreTiledBg.webp)",l.appendChild(r);let c=document.createElement("div");c.classList.add("modal-trophy-div"),r.appendChild(c);let p=document.createElement("img");p.classList.add("trophy-store-item-img","trophy-store-item-div","modal-trophy-item","teams-store-unowned"),p.src=`../Assets/TeamsStoreIcon/${t.icon}.webp`,c.appendChild(p),n.trophyStoreItems.hasOwnProperty(e)&&n.trophyStoreItems[e]&&p.classList.add("teams-store-owned");let m=document.createElement("div");m.classList.add("item-details-div"),r.appendChild(m);let u=document.createElement("p");u.classList.add("trophy-store-item-full-name","black-outline"),u.innerHTML=Re(`${e}Name`),m.appendChild(u);let h=document.createElement("p");h.classList.add("trophy-store-item-description"),h.innerHTML=Re(`${e}Description`),m.appendChild(h);let g=document.createElement("p");if(g.classList.add("trophy-store-item-obtain-method"),m.appendChild(g),t.hasOwnProperty("obtainMethod"))switch(t.obtainMethod){case"Quest":g.innerHTML="Obtained by completing a quest";break;case"Limited":g.innerHTML="Obtained during a limited time event";break;case"Rogue":g.innerHTML="Obtained by unlocking a feat in Rogue Legends";break;case"Nexus":g.innerHTML="Obtained by purchasing anything in the store with a Nexus Creator Code applied";break;case"Purchase":g.innerHTML="Obtained by purchasing the associated bundle in the store"}t.hidden&&!t.hasOwnProperty("obtainMethod")&&(g.innerHTML="This item is hidden and may show up in the featured tab during the related seasonal rotation.")}function ll(e){let t={},a=e.split("#"),n=0;for(let e of a){t[n]={};let a=e.split(":"),l=a[0];if(!["MonkeyMoney","Power","InstaMonkey","KnowledgePoints","RandomInstaMonkey","Trophy"].includes(l)){t[n].type="Other",t[n].value=l,n++;continue}let d=a[1].split(",");switch(l){case"MonkeyMoney":t[n].type="MonkeyMoney",t[n].amount=parseInt(d[0]);break;case"Power":t[n].type="Power",t[n].power=d[0],t[n].amount=parseInt(d[1]),null==d[1]&&(t[n].amount=1);break;case"InstaMonkey":t[n].type="InstaMonkey",t[n].tower=d[0],t[n].tiers=d[1];break;case"KnowledgePoints":t[n].type="KnowledgePoints",t[n].amount=parseInt(d[0]);break;case"RandomInstaMonkey":t[n].type="RandomInstaMonkey",t[n].tier=d[0],t[n].amount=parseInt(d[1]);break;case"Trophy":t[n].type="Trophy",t[n].trophy=d[0]}n++}return t}function dl(e){window.location.href=e}function sl(e){window.open(e,"_blank")}function il(e){let t=document.getElementsByClassName("loading-icon")[0].cloneNode(!0);t.classList.add("loading-icon-leaderboard"),t.style.height="unset",e.appendChild(t)}function ol(e){return[Math.floor(e/3600),Math.floor(e%3600/60),Math.floor(e%60)].map((e=>e<10?"0"+e:e)).join(":")}function rl(e){let t=Math.floor(e/1e3),a=e%1e3,n=Math.floor(t/3600);t%=3600;let l=Math.floor(t/60),d=t%60;l=l.toString().padStart(2,"0"),d=d.toString().padStart(2,"0"),a=a.toString().padStart(3,"0");let s=`${l}:${d}.${a}`;return n>0&&(n=n.toString().padStart(2,"0"),s=`${n}:${s}`),s}function cl(e){return(e-new Date)/1e3}function pl(e,t){const a=cl(e),n=document.getElementById(t);if(a>172800){const e=Math.ceil(a/86400);n.textContent=`${e} days left`}else n.textContent=a<0?"Finished":ol(a)}function ml(e,t){const a=[{name:"year",ms:31536e6},{name:"month",ms:2592e6},{name:"day",ms:864e5},{name:"hour",ms:36e5},{name:"minute",ms:6e4},{name:"second",ms:1e3}],n=e-t;for(const e of a){if(n<e.ms)continue;let t=Math.round(n/e.ms);return`${t} ${e.name}${t>1?"s":""} ago`}}function ul(e){null!=e?document.body.style.backgroundColor=`rgb(${255*e[0]},${255*e[1]},${255*e[2]})`:document.body.style.removeProperty("background-color")}function hl(e,t,a,n,l){switch(e){case 1:return a*(n/l);case 2:return t*(l/n);case 3:return l*(t/a);case 4:return n*(a/t)}}function gl(){document.body.scrollTop=0,document.documentElement.scrollTop=0}function Ll(){let e=JSON.parse(localStorage.getItem("BTD6OAKSettings"));e&&(B=e.ProfileLoading,tt=e.UseNamedMonkeys,Dt=e.TeamsStoreItems)}function bl(){let e={ProfileLoading:B,UseNamedMonkeys:tt,TeamsStoreItems:Dt};localStorage.setItem("BTD6OAKSettings",JSON.stringify(e))}function yl(e,t,a){if(T&&!a)return;let n=document.createElement("div");n.classList.add("error-modal-overlay"),document.body.appendChild(n);let l=document.createElement("div");l.id="error-modal",l.classList.add("error-modal"),n.appendChild(l);let d=document.createElement("div");d.id="error-modal-header",d.classList.add("error-modal-header"),l.appendChild(d);let s=document.createElement("img");s.id="error-modal-header-img",s.classList.add("error-modal-header-img"),s.src="./Assets/UI/BadConnectionBtn.webp",d.appendChild(s);let i=document.createElement("p");i.classList.add("error-modal-header-text","black-outline"),i.innerHTML="Error",d.appendChild(i);let o=document.createElement("div");o.classList.add("error-modal-dummy"),d.appendChild(o);let r=document.createElement("div");r.id="error-modal-content",r.classList.add("error-modal-content"),r.innerHTML=""+e,l.appendChild(r);let c=document.createElement("div");if(c.classList.add("error-modal-content"),"Invalid user ID / Player Does not play this game"===e)c.innerHTML="Please try again or create a new Open Access Key.",l.appendChild(c);if("ratelimit"==t){let e=document.createElement("div");e.classList.add("error-toggle-div"),l.appendChild(e);let t=document.createElement("p");t.classList.add("maps-progress-coop-toggle-text","black-outline"),t.innerHTML="Manually Load Profiles: ",e.appendChild(t);let a=document.createElement("input");a.classList.add("maps-progress-coop-toggle-input"),a.type="checkbox",a.checked=B,a.addEventListener("change",(()=>{B=!!a.checked})),e.appendChild(a)}let p=document.createElement("div");p.classList.add("error-modal-ok-button-div"),l.appendChild(p);let m=document.createElement("div");m.classList.add("start-button","modal-ok-button","black-outline"),m.innerHTML="OK",m.addEventListener("click",(()=>{T=!1,document.body.removeChild(n)})),p.appendChild(m);let u=document.createElement("img");u.classList.add("error-modal-close"),u.src="./Assets/UI/CloseBtn.webp",u.addEventListener("click",(()=>{T=!1,document.body.removeChild(n)})),r.appendChild(u),T=!0}let vl=1,Cl={Red:{name:"Red",rbe:1,speed:25,layer:1,scale:.8,color:"#ED0F0F",border:"#690000"},Blue:{name:"Blue",rbe:2,speed:35,layer:2,scale:.85,color:"#2797E0",border:"#004772"},Green:{name:"Green",rbe:3,speed:45,layer:3,scale:.9,color:"#77A80F",border:"#3D5400"},Yellow:{name:"Yellow",rbe:4,speed:80,layer:4,scale:.95,color:"#FFD50F",border:"#8E620C"},Pink:{name:"Pink",rbe:5,speed:87.5,layer:5,scale:1,color:"#F15060",border:"#A92626"},Black:{name:"Black",rbe:11,speed:45,layer:6,scale:.58,color:"#161616",border:"#414141"},Purple:{name:"Purple",rbe:11,speed:75,layer:7,scale:.95,color:"#9326E0",border:"#00E4FF"},White:{name:"White",rbe:12,speed:50,layer:6,scale:.58,color:"#D7D7D7",border:"#727272"},Lead:{name:"Lead",rbe:23,speed:25,layer:7,scale:.95,color:"#7E7E7E",border:"#2F2F2F"},Zebra:{name:"Zebra",rbe:23,speed:45,layer:7,scale:.9,color:"repeating-linear-gradient(145deg, #040404, #040404 10px, #ffffff 10px, #ffffff 20px)",border:"#5A5A5A"},Rainbow:{name:"Rainbow",rbe:47,speed:55,layer:8,scale:1,color:"linear-gradient(180deg, rgba(228,26,26,1) 0%, rgba(255,159,0,1) 16%, rgba(255,224,0,1) 33%, rgba(125,181,4,1) 48%, rgba(83,176,222,1) 66%, rgba(226,74,226,1) 84%, rgba(132,21,132,1) 100%)",border:"transparent"},Ceramic:{name:"Ceramic",rbe:47,speed:62.5,layer:9,scale:1,color:"#BE6C1D",border:"#61370B"},Moab:{name:"Moab",rbe:616,speed:25,layer:10,color:"#2AC2FF",border:"#FFFFFF"},Bfb:{name:"Bfb",rbe:3164,speed:6.25,layer:11,color:"#C00505",border:"#FFFFFF"},Zomg:{name:"Zomg",rbe:16656,speed:4.5,layer:12,color:"#575757",border:"#B7F700"},Ddt:{name:"Ddt",rbe:3164,speed:66,layer:12,color:"#3C3C3C",border:"#A5A5A5"},Bad:{name:"Bad",rbe:16464,speed:4.5,layer:13,color:"#AB02AC",border:"#500151"}},El=new Image;El.src="../Assets/BloonIcon/preview_bloons_spritesheet.webp";let wl={CeramicCamo:{x:1153,y:0,width:129,height:163},CeramicFortified:{x:993,y:547,width:140,height:163},CeramicFortifiedCamo:{x:993,y:711,width:140,height:163},CeramicRegrow:{x:0,y:782,width:176,height:162},CeramicRegrowCamo:{x:177,y:782,width:176,height:162},CeramicRegrowFortified:{x:629,y:0,width:186,height:162},CeramicRegrowFortifiedCamo:{x:629,y:163,width:186,height:162},Black:{x:1283,y:790,width:78,height:97},BlackCamo:{x:1283,y:888,width:78,height:97},BlackRegrow:{x:833,y:945,width:105,height:97},BlackRegrowCamo:{x:708,y:782,width:105,height:97},Blue:{x:1283,y:148,width:110,height:139},BlueCamo:{x:1283,y:288,width:110,height:139},BlueRegrow:{x:408,y:641,width:150,height:138},BlueRegrowCamo:{x:993,y:146,width:150,height:138},Ceramic:{x:1153,y:164,width:129,height:163},LeadFortifiedCamo:{x:993,y:875,width:133,height:156},LeadRegrow:{x:816,y:326,width:168,height:154},LeadRegrowCamo:{x:816,y:481,width:168,height:154},LeadRegrowFortified:{x:629,y:326,width:178,height:154},LeadRegrowFortifiedCamo:{x:629,y:481,width:178,height:154},Green:{x:878,y:1100,width:116,height:147},GreenCamo:{x:995,y:1100,width:116,height:147},GreenRegrow:{x:468,y:474,width:159,height:145},GreenRegrowCamo:{x:629,y:636,width:159,height:145},Lead:{x:134,y:1100,width:123,height:156},LeadCamo:{x:258,y:1100,width:123,height:156},LeadFortified:{x:0,y:1100,width:133,height:156},WhiteRegrow:{x:1153,y:1132,width:105,height:97},WhiteRegrowCamo:{x:1283,y:428,width:105,height:97},Yellow:{x:382,y:1100,width:123,height:156},YellowCamo:{x:506,y:1100,width:123,height:156},YellowRegrow:{x:816,y:636,width:168,height:154},YellowRegrowCamo:{x:0,y:945,width:168,height:154},Zebra:{x:1153,y:984,width:116,height:147},ZebraCamo:{x:1283,y:0,width:116,height:147},ZebraRegrow:{x:816,y:791,width:159,height:145},ZebraRegrowCamo:{x:993,y:0,width:159,height:145},Pink:{x:1153,y:328,width:129,height:163},PinkCamo:{x:1153,y:492,width:129,height:163},PinkRegrow:{x:354,y:782,width:176,height:162},PinkRegrowCamo:{x:531,y:782,width:176,height:162},Purple:{x:630,y:1100,width:123,height:156},PurpleCamo:{x:754,y:1100,width:123,height:156},PurpleRegrow:{x:169,y:945,width:168,height:154},PurpleRegrowCamo:{x:338,y:945,width:168,height:154},Rainbow:{x:1153,y:656,width:129,height:163},RainbowCamo:{x:1153,y:820,width:129,height:163},RainbowRegrow:{x:816,y:0,width:176,height:162},RainbowRegrowCamo:{x:816,y:163,width:176,height:162},Red:{x:1283,y:526,width:103,height:131},RedCamo:{x:1283,y:658,width:103,height:131},RedRegrow:{x:993,y:285,width:143,height:130},RedRegrowCamo:{x:993,y:416,width:143,height:130},White:{x:1283,y:986,width:78,height:97},WhiteCamo:{x:1283,y:1084,width:78,height:97},Bad:{x:0,y:238,width:326,height:235},BadFortified:{x:0,y:0,width:326,height:237},Bfb:{x:234,y:474,width:233,height:164},BfbFortified:{x:0,y:474,width:233,height:166},DdtCamo:{x:0,y:641,width:203,height:140},DdtFortifiedCamo:{x:204,y:641,width:203,height:140},Moab:{x:670,y:945,width:162,height:105},MoabFortified:{x:507,y:945,width:162,height:110},Zomg:{x:327,y:0,width:301,height:194},ZomgFortified:{x:327,y:195,width:301,height:194}};class kl{constructor(e,t){this.speed=Cl[e.replace("Camo","").replace("Regrow","").replace("Fortified","")].speed,this.scale=Cl[e.replace("Camo","").replace("Regrow","").replace("Fortified","")].scale,this.x=-hl(1,0,100,wl[e].width,wl[e].height),this.y=100+(100-100*this.scale)/2,this.type=e,this.groupIndex=t,this.width=hl(1,0,100,wl[e].width,wl[e].height)}move(e){this.x+=this.speed*e*6.86*vl*Bl*Il}shouldDelete(){return this.x>=800}render(e){if(Mt.includes(this.groupIndex))return;let t=wl[this.type];e.drawImage(El,t.x,t.y,t.width,t.height,this.x,this.y,this.scale*this.width,100*this.scale)}}class fl{constructor(e,t){this.speed=Cl[e.replace("Camo","").replace("Regrow","").replace("Fortified","")].speed,this.x=-1.62*wl[e].width,this.type=e,this.groupIndex=t}move(e){this.x+=this.speed*e*6.86*vl*Bl*Il}shouldDelete(){return this.x>=800}render(e){if(Mt.includes(this.groupIndex))return;let t=wl[this.type];e.drawImage(El,t.x,t.y,t.width,t.height,this.x,150-1.62*t.height/2,1.62*t.width,1.62*t.height)}}const Tl=[];let Ml,Il=1,Bl=1;const Hl=e=>{const t=performance.now();Tl.forEach(((t,a)=>{t.move(e),t.shouldDelete()&&Tl.splice(a,1)})),null!=Ml&&Ml.bloonGroups.forEach((a=>{if(t>=a.startTime&&a.count>0)if(0==a.activeTime&&(a.spawnBloon(),a.count--),a.activeTime+=e,a.spawnAccumulator+=e,0===a.spawnInterval){for(let e=0;e<a.count;e++)a.spawnBloon();a.count=0,a.spawnAccumulator=0}else for(;a.spawnAccumulator>=a.spawnInterval;){const e=Math.floor(a.spawnAccumulator/a.spawnInterval);for(let t=0;t<e;t++)a.spawnBloon(),a.count--;a.spawnAccumulator-=a.spawnInterval*e}}))},Sl=()=>{ia.clearRect(0,0,sa.width,sa.height),Tl.forEach((e=>e.render(ia)))};function xl(e){if(Bl=Pl(e.roundNumber),Ml=JSON.parse(JSON.stringify(e)),document.getElementById("roundset-reverse-checkbox").checked){let t=Math.max(...e.bloonGroups.map((e=>e.end)));for(let e of Ml.bloonGroups){let a=e.end-e.start;e.start=t-e.end,e.end=e.start+a}}Vn(Math.max(...Ml.bloonGroups.map((e=>e.end)))/vl),Ml.bloonGroups.forEach(((e,t)=>{e.startTime=performance.now()+1e3*e.start/vl,e.activeTime=0,e.spawnAccumulator=0,e.spawnInterval=(e.end-e.start)/(e.count-1)/vl,isFinite(e.spawnInterval)||(e.spawnInterval=0),e.spawnBloon=Al(e,t)}))}function Al(e,t){return function(){let a=e.bloon,n=["Moab","MoabFortified","Bfb","BfbFortified","Zomg","ZomgFortified","DdtCamo","DdtFortifiedCamo","Bad","BadFortified"].includes(a)?new fl(a,t):new kl(a,t),l=Cl[a.replace("Camo","").replace("Regrow","").replace("Fortified","")].layer,d=Tl.findIndex((e=>Cl[e.type.replace("Camo","").replace("Regrow","").replace("Fortified","")].layer>l));-1===d?Tl.push(n):Tl.splice(d,0,n)}}function Pl(e){let t=0;return t=e<=80?1:e<=100?1+.02*(e-80):e<=150?1.6+.02*(e-101):e<=200?3+.02*(e-151):e<=250?4.5+.02*(e-201):6+.02*(e-252),t}